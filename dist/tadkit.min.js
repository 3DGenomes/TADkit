!function(){"use strict";angular.module("TADkit",["ngRoute","mm.foundation"])}(),function(){"use strict";function r(r){r.when("/",{templateUrl:"layout/dashboard.html",controller:"DashboardCtrl",resolve:{loadTADData:function(r){return r.promise}}}).when("/loader",{templateUrl:"layout/loader.html",controller:"LoaderCtrl"})}angular.module("TADkit").config(r)}(),function(){"use strict";function r(){return function(r,a,i){var s={chromatinVisibility:!0,particles:0,particleSegments:5,curveSegments:1,radius:15,radiusSegments:16,endcap:!1,pathClosed:!1};i=i||{},angular.extend(this,angular.copy(s),i);var l=e(r),b=t(l.vertices);0===this.particles&&(this.particles=b.length-1);var c=this.particles*this.particleSegments;this.pathSegments=c;for(var u=o(b,c),h=new THREE.Object3D,d=new THREE.Geometry,p=(g(c),0);c>p;p++){this.endcap=0===p||p===c-1?!1:!0;var f=a[p],y=new THREE.MeshLambertMaterial({color:f,ambient:f,emissive:f,vertexColors:THREE.VertexColors,opacity:1,transparent:!1,wireframe:!1}),m=n(u[p],u[p+1],this);d.merge(m);var w=new THREE.Mesh(m,y);w.name="fragment-"+p,h.add(w)}d.computeBoundingSphere(),h.boundingSphere=d.boundingSphere,h.name="Chromatin Fiber",h.visible=this.chromatinVisibility,this.fiber=h,this.center=d.boundingSphere.center,this.bounds=d.boundingSphere.radius}}function e(r){for(var e,t=0,o=new THREE.Geometry,n=r.length;n>t;)e=new THREE.Vector3,e.x=r[t++],e.y=r[t++],e.z=r[t++],o.vertices.push(e);return o}function t(r){for(var e=r.length,t=[],o=0;e-1>o;o++){var n=r[o],g=r[o+1],a=new THREE.Vector3(0,0,0);a.addVectors(n,g).divideScalar(2);var i=new THREE.Vector3(0,0,0);if(i.copy(a).sub(n),0===o){var s=new THREE.Vector3(0,0,0);s.copy(n).sub(i),t.push(s)}if(t.push(a),o==e-2){var l=new THREE.Vector3(0,0,0);l.copy(g).add(i),t.push(l)}}return t}function o(r,e){var t=new THREE.SplineCurve3(r),o=t.getSpacedPoints(e);return o}function n(r,e,t){var o=(new THREE.Vector3).subVectors(e,r),n=new THREE.Matrix4;n.lookAt(r,e,(new THREE.Object3D).up),n.multiply(new THREE.Matrix4(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1)),n.setPosition(r.add(e).multiplyScalar(.5));var g;g=t.endcap;var a=new THREE.CylinderGeometry(t.radius,t.radius,o.length(),t.radiusSegments,t.curveSegments,g);return a.applyMatrix(n),a}function g(){}angular.module("TADkit").factory("Chromatin",r)}(),function(){"use strict";function r(){return function(r,t){var o={particles:0,particlesVisibility:!1,particleColor:"#ffffff",particleSize:350,particleOpacity:.8};t=t||{},angular.extend(this,angular.copy(o),t);var n=new THREE.PointCloudMaterial({color:this.particleColor,size:this.particleSize,opacity:this.particleOpacity,map:THREE.ImageUtils.loadTexture("assets/img/sphere-glossy.png"),transparent:!0}),g=e(r),a=new THREE.PointCloud(g,n);a.sortParticles=!0,a.name="Particles Cloud",a.visible=this.particlesVisibility,this.cloud=a,this.center=a.center,this.bounds=a.bounds}}function e(r){for(var e,t=0,o=new THREE.Geometry,n=r.length;n>t;)e=new THREE.Vector3,e.x=r[t++],e.y=r[t++],e.z=r[t++],o.vertices.push(e);return o}angular.module("TADkit").factory("Particles",r)}(),function(){"use strict";function r(r,e){r.vertices=e.getVertices()}angular.module("TADkit").controller("SceneCtrl",r)}(),function(){"use strict";function r(r,e){return{restrict:"E",scope:{data:"=",position:"=",particles:"=",chromatin:"=",proteins:"=",colors:"=",segments:"="},link:function(t,o){var n,g,a,i,s,l,b,c,u,h,d,p,f,y=new THREE.Color;t.materialType="lambert",t.init=function(){g=o[0],h=1*g.parentNode.clientWidth,d=.66*h,p=h/2,f=d/2,u=new THREE.WebGLRenderer({antialias:!0}),u.setClearColor(16777215),u.setSize(h,d),g.appendChild(u.domElement),n=new THREE.Scene;a=new THREE.PerspectiveCamera(28,h/d,1,1e6),i=new THREE.Vector3(5e4,5e4,5e4),s=new THREE.Vector3(0,0,0),a.position.x=i.x,a.position.y=i.y,a.position.z=i.z,a.lookAt(s),a.name="Scene Camera",n.add(a);c=new THREE.TrackballControls(a,u.domElement),c.rotateSpeed=1.5,c.zoomSpeed=2,c.panSpeed=.8,c.noZoom=!1,c.noPan=!1,c.staticMoving=!0,c.dynamicDampingFactor=.3,c.keys=[65,83,68],c.addEventListener("change",t.render);var m=m||new THREE.Vector3(0,0,0);c.target.copy(m);var w=(new THREE.AxisHelper(1e5),"#111111");l=new THREE.AmbientLight(w),l.name="Scene Ambient Light",n.add(l);var v="#ffffff",k=.1;b=new THREE.PointLight(v,k),b.position.set(2e4,2e4,2e4),b.name="Scene Light",n.add(b);var C=500,T=(new THREE.PointLightHelper(b,C),"#37375f"),x=(new THREE.MeshLambertMaterial({color:T,ambient:T,emissive:T,opacity:1,transparent:!1,wireframe:!1}),{particlesVisibility:t.particles,particleColor:"#ffffff",particleSize:350,particleOpacity:.8}),R=new r(t.data,x);n.add(R.cloud);var H={chromatinVisibility:t.chromatin,particleSegments:t.segments},A=new e(t.data,t.colors,H);n.add(A.fiber),t.lookAtTAD(A.center,s,3*A.bounds);1*A.bounds,6*A.bounds;window.addEventListener("resize",t.onWindowResize,!1);var E=n.getObjectByName("Particles Cloud");t.$watch("particles",function(r,e){r!==e&&(E.visible=t.particles)});var P=n.getObjectByName("Chromatin Fiber");t.$watch("chromatin",function(r,e){r!==e&&(P.visible=t.chromatin)}),t.$watch("colors",function(r,e){if(r!==e)for(var o=(Math.floor(r),P.children.length),n=0;o>n;n++){var g=new THREE.Color(t.colors[n]);P.children[n].material.color=g,P.children[n].material.ambient=g,P.children[n].material.emissive=g}}),t.$watch("position",function(r,e){if(r!==e){var t=Math.floor(e),o=Math.floor(r),n=P.getObjectByName("fragment-"+t);n.material.color=y,n.material.ambient=y,n.material.emissive=y;var g=P.getObjectByName("fragment-"+o);y=g.material.color;var a=new THREE.Color("rgb(255,0,0)");g.material.color=a,g.material.ambient=a,g.material.emissive=a}})},t.onWindowResize=function(){t.resizeCanvas()},t.resizeCanvas=function(){h=.66*g.parentNode.clientWidth,d=.66*h,p=h/2,f=d/2,a.aspect=h/d,a.updateProjectionMatrix(),u.setSize(h,d)},t.lookAtTAD=function(r,e,t){r=r||new THREE.Vector3(0,0,0),e=e||new THREE.Vector3(0,0,0),t=t||0,a.position.set(r.x,r.y,r.z),a.lookAt(e),a.translateZ(t),a.updateMatrixWorld(),c.target.copy(r)},t.checkRotation=function(){var r=.1,e=new THREE.Vector3(a.position.x,a.position.y,a.position.z),o=new THREE.Vector3(-4720.09000762387,-14279.253850598721,6903.477032057158),n=0,g=e.x,i=e.y,s=o.x,l=o.y;console.log(g),console.log(i),e.x=(g-s)*Math.cos(r)-(l-i)*Math.sin(r)+s,e.y=(l-i)*Math.cos(r)-(g-s)*Math.sin(r)+l,t.lookAtTAD(e,o,n)},t.animate=function(){requestAnimationFrame(t.animate),c.update(),t.render()},t.render=function(){u.render(n,a)},t.init(),t.animate()}}}angular.module("TADkit").directive("tkScene",r)}(),function(){"use strict";function r(){return{restrict:"E",scope:{data:"=",id:"@",position:"=",positions:"=",segments:"=",focusstart:"=",focusend:"="},link:function(r,e){r.$watch("position",function(t,o){if(t!==o){var n=r.data,g=t,a=r.positions,i=r.segments,s=a/i,l=e[0].parentNode.clientWidth,b={top:0,right:40,bottom:0,left:40},c=l-b.left-b.right,u=(20-b.top-b.bottom,10),h=d3.scale.linear().range([0,c]).clamp(!0),d=d3.scale.linear().range([0,1]).clamp(!0),p=(r.focusstart,r.focusend,c/s),f=Math.floor(g*s/a),y=d3.min(n,function(r){return r.dist}),m=d3.max(n,function(r){return r.dist});h.domain([1,s]),d.domain([y,m]),d3.selectAll("#highlight").attr("x",function(){return Math.floor(f-.5*p)}),d3.select("#contacts").selectAll(".clipped").remove();{var w=d3.select("#contacts").selectAll(".chart").append("g").attr("clip-path","url(#clip)").attr("class","clipped");w.selectAll("rect").data(n.filter(function(r){return r.a==f+1})).enter().append("rect").attr("x",function(r){return h(r.b+1)}).attr("y",0).attr("width",function(){return p}).attr("height",u).style("opacity",function(r){return d(r.dist)}).attr("class","particle")}}}),r.$watch("data",function(t,o){if(t!==o){var n=t,g=e[0].parentNode.clientWidth,a=r.id,i=r.position,s=r.positions,l=r.segments,b=s/l,c={top:0,right:40,bottom:0,left:40},u=g-c.left-c.right,h=20-c.top-c.bottom,d=10,p=u/b,f=Math.floor(i*b/s),y=d3.scale.linear().range([0,u]).clamp(!0),m=d3.scale.linear().range([0,1]).clamp(!0),w=r.focusstart,v=r.focusend,k=v-w,C=k/b,T=d3.svg.axis().scale(y).orient("top"),x=(d3.svg.axis().scale(y).orient("bottom"),d3.select("#"+a).append("svg").attr("width",u+c.left+c.right).attr("height",h+c.top+c.bottom));x.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",u).attr("height",h);var R=x.append("g").attr("class","chart"),H=R.append("g").attr("clip-path","url(#clip)").attr("class","clipped"),A=d3.min(n,function(r){return r.dist}),E=d3.max(n,function(r){return r.dist});y.domain([1,b]),m.domain([A,E]),x.select(".chart").append("g").attr("class","u axis").attr("transform","translate(0,0)").call(T);{var P="Contact";x.append("text").attr("x",-4).attr("y",8).attr("text-anchor","end").style("font-size","10px").text(P),H.selectAll("rect").data(n.filter(function(r){return r.a==f+1})).enter().append("rect").attr("x",function(r){return y(r.b+1)}).attr("y",0).attr("width",function(){return p}).attr("height",d).style("opacity",function(r){return m(r.dist)}).attr("class","particle"),x.append("rect").attr("id","highlight").attr("x",function(){return f-.5*C}).attr("y",0).attr("width",p).attr("height",h).attr("class","highlight")}}})}}}angular.module("TADkit").directive("tkContacts",r)}(),function(){"use strict";function r(){return{restrict:"E",scope:{data:"=",id:"@",position:"=",positions:"=",assemblylength:"=",focusstart:"=",focusend:"=",sense:"="},link:function(r,e){r.$watch("position",function(t,o){if(t!==o){var n=r.positions,g=e[0].parentNode.clientWidth,a={top:0,right:40,bottom:40,left:40},i=g-a.left-a.right,s=d3.scale.linear().range([0,i]).clamp(!0),l=r.focusstart,b=r.focusend,c=b-l,u=c/n,h=u*i/c;4>h&&(h=4);var d=l+u*t;s.domain([l,b]),d3.select("#highlight").style("visibility","visible"),d3.select("#highlight").attr("x",function(){return s(d-4*u)})}}),r.$watch("data",function(t,o){function n(){P.select("g.x.axis").call(A),D.selectAll("rect").attr("x",function(r){return Math.floor(p(r.start))}).attr("y",function(e){return r.sense?e.strand<1?d:void 0:0}).attr("width",function(r){return Math.ceil(p(r.end)-p(r.start))+"px"}),P.select("#highlight").style("visibility","hidden")}if(t!==o){var g=r.data,a=r.assemblylength,i=r.id,s=r.position,l=r.positions,b=e[0].parentNode.clientWidth,c={top:0,right:40,bottom:40,left:40},u=b-c.left-c.right,h=60-c.top-c.bottom,d=10,p=(r.assemblylength,d3.scale.linear().range([0,u]).clamp(!0)),f=r.focusstart,y=r.focusend,m=y-f,w=m/l,v=w*u/m;4>v&&(v=4);var k=a/m,C=.05*k;k-=2*C;var T=.5*m,x=.5*a,R=p(x)-p(T),H=p(R)*k;H=-12615;var A=d3.svg.axis().scale(p).orient("bottom"),E=(d3.svg.axis().orient("left"),d3.svg.axis().orient("right"),d3.behavior.zoom().on("zoom",n)),P=d3.select("#"+i).append("svg").attr("width",u+c.left+c.right).attr("height",h+c.top+c.bottom).call(E);P.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",u).attr("height",h);var M=P.append("g").attr("class","focus"),D=M.append("g").attr("clip-path","url(#clip)");p.domain([f,y]),E.x(p),P.select(".focus").append("g").attr("class","x axis").attr("transform","translate(0,"+h+")").call(A);{var G=(P.append("text").attr("x",-12).attr("y",-3).attr("text-anchor","right").style("font-size","10px").text("3'"),P.append("text").attr("x",u+8).attr("y",-3).attr("text-anchor","left").style("font-size","10px").text("5'"),P.append("text").attr("x",-18).attr("y",8).attr("text-anchor","right").style("font-size","10px").text("<<"),P.append("text").attr("x",-18).attr("y",18).attr("text-anchor","right").style("font-size","10px").text(">>"),D.selectAll("rect").data(g).enter().append("rect").attr("x",function(r){return Math.floor(p(r.start))}).attr("y",function(e){return r.sense?e.strand<1?d:void 0:0}).attr("width",function(r){return Math.ceil(p(r.end)-p(r.start))+"px"}).attr("height",d).attr("class",function(r){return r.biotype.toLowerCase()}).append("svg:title").text(function(r){return r.external_name}),f+w*s);P.append("rect").attr("id","highlight").attr("x",function(){return p(G-4*w)}).attr("y",0).attr("width",v).attr("height",h).attr("class","highlight")}n()}})}}}angular.module("TADkit").directive("tkGenes",r)}(),function(){"use strict";function r(){return{restrict:"E",scope:{data:"=",id:"@",color:"@",position:"=",positions:"=",focusstart:"=",focusend:"="},link:function(r,e){function t(r,e){for(var t=[],o=0;o<r.length;o++)if(1==r[o][e]){t.push({fragmentID:r[o].fragmentID,chromosome:r[o].chromosome,start:r[o].start,end:r[o].end})}return t}r.$watch("position",function(t,o){if(t!==o){var n=r.positions,g=e[0].parentNode.clientWidth,a={top:0,right:40,bottom:0,left:40},i=g-a.left-a.right,s=d3.scale.linear().range([0,i]).clamp(!0),l=r.focusstart,b=r.focusend,c=b-l,u=c/n,h=u*i/c;4>h&&(h=4);var d=l+u*t;s.domain([l,b]),d3.selectAll("#highlight").attr("x",function(){return s(d-4*u)})}}),r.$watch("data",function(o){if(o){console.log("Protein tracks initiated");var n=t(r.data,r.id),g=n,a=(r.assemblylength,r.id),i=r.position,s=r.positions,l=e[0].parentNode.clientWidth,b={top:0,right:40,bottom:0,left:40},c=l-b.left-b.right,u=20-b.top-b.bottom,h=10,d=d3.scale.linear().range([0,c]).clamp(!0),p=r.focusstart,f=r.focusend,y=f-p,m=y/s,w=m*c/y;4>w&&(w=4);var v=d3.svg.axis().scale(d).orient("top"),k=(d3.svg.axis().orient("left"),d3.svg.axis().orient("right"),d3.select("#"+a).append("svg").attr("width",c+b.left+b.right).attr("height",u+b.top+b.bottom));k.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",c).attr("height",u);var C=k.append("g").attr("class","chart"),T=C.append("g").attr("clip-path","url(#clip)");d.domain([p,f]),k.select(".chart").append("g").attr("class","x axis").attr("transform","translate(0,0)").call(v);{var x=r.id,R=(k.append("text").attr("x",-6).attr("y",8).attr("text-anchor","end").style("font-size","10px").text(x),T.selectAll("rect").data(g).enter().append("rect").attr("x",function(r){return Math.floor(d(r.start))}).attr("y",0).attr("width",function(r){return Math.ceil(d(r.end)-d(r.start))+"px"}).attr("height",h).attr("class",function(){return r.id}),p+m*i);k.append("rect").attr("id","highlight").attr("x",function(){return d(R-4*m)}).attr("y",0).attr("width",w).attr("height",u).attr("class","highlight")}}})}}}angular.module("TADkit").directive("tkProteins",r)}(),function(){"use strict";function r(){return{restrict:"E",scope:{data:"=",id:"@",position:"=",fragments:"="},link:function(r,e){function t(e){r.safeApply(function(){r.position=e})}r.safeApply=function(r){var e=this.$root.$$phase;"$apply"==e||"$digest"==e?r&&"function"==typeof r&&r():this.$apply(r)},r.$watch("data",function(o,n){function g(){var r=f.extent()[0];d3.event.sourceEvent&&(r=parseInt(u.invert(d3.mouse(this)[0])),f.extent([r,r])),w.attr("cx",u(r)-.5*p),t(r)}if(o!==n){var a=(r.data,r.id),i=e[0].parentNode.clientWidth,s=r.fragments,l={top:0,right:40,bottom:0,left:40},b=i-l.left-l.right,c=20-l.bottom-l.top,u=d3.scale.linear().range([0,b]).clamp(!0),h=0,d=s-1;u.domain([h,d]);var p=Math.max(b/d,4),f=d3.svg.brush().x(u).extent([0,0]).on("brush",g),y=d3.select("#"+a).append("svg").attr("width",b+l.left+l.right).attr("height",c+l.top+l.bottom).append("g");y.append("g").attr("class","x axis").attr("transform","translate(0,"+c/2+")").call(d3.svg.axis().scale(u).orient("bottom").outerTickSize([0])).select(".domain").select(function(){return this.parentNode.appendChild(this.cloneNode(!0))}).attr("class","halo");var m=y.append("g").attr("class","slider").call(f);m.selectAll(".extent,.resize").remove(),m.select(".background").attr("height",c);var w=m.append("circle").attr("class","handle").attr("cy",10).attr("r",1.6*p);m.call(f.extent([r.position,0])).call(f.event)}})}}}angular.module("TADkit").directive("tkSlider",r)}(),function(){"use strict";function r(r,e,t,o,n,g){e(function(){r.particles=t.getParticles(),r.genes=o.getGenes(),r.proteins=n.getProteins(),r.contacts=g.getContacts()},0),console.log("Track now active.")}angular.module("TADkit").controller("TrackCtrl",r)}(),function(){"use strict";function r(r,e,t){e(function(){r.genes=t.getGenes()},0),r.filterGenes=function(e){var t=r.focusStart+parseInt(r.fragmentLength*r.slider.position),o=t+(r.fragmentLength-1),n=!1;return Math.max(t,e.start)<=Math.min(o,e.end)&&(n=!0),n},console.log("Controls now active.")}angular.module("TADkit").controller("ControlsCtrl",r)}(),function(){"use strict";function r(r,e,t,o,n,g,a,i){e.assembly=n.getAssembly();var s=0,l=e.assembly.top_level_region;for(var b in l)if(l.hasOwnProperty(b))for(var c=0,u=l.length;u>c;c++)s+=l[c].length;e.assemblyLength=s,console.log("Assembly: "+parseInt(e.assemblyLength).toLocaleString()+" BP");var h=o.getParticlesCount();e.particlesCount=h;var d=o.getSegments();e.segments=d;var p=g.getGenes(),f=n.getBiotypeColors().gene,y=a.getProteins(),m=i.getContacts(),w=h*d;r.fragments=w;var v=parseInt(.5*w);e.slider={},e.slider.position=v;var k=o.getMetadata(),C=k.start,T=k.resolution/d;e.fragmentLength=T;var x=k.start;e.focusStart=x;var R=k.end;e.focusEnd=R,e.colorsTAD=o.getColors(),e.colorsGenes=g.getColors(p,f,w,C,T),e.colorsContacts=i.getColors(m,e.slider.position,h,d),e.colorsHP1=a.getColors(y,"HP1",w,C,T),e.colorsBRM=a.getColors(y,"BRM",w,C,T),e.colorsMRG15=a.getColors(y,"MRG15",w,C,T),e.colorsPC=a.getColors(y,"PC",w,C,T),e.colorsH1=a.getColors(y,"H1",w,C,T),e.colors=e.colorsTAD;var H=o.getSpecies();r.species={text:H};var A=o.getSlice();r.slice={text:A};var E=k.identifier;r.identifier={text:E};var P=k.article;r.article={text:P};var M=k.assembly;r.assembly={text:M};var D=k.cellType;r.celltype={text:D};var G=k.experimentType;r.experiment={text:G};var S=k.resolution;r.resolution={text:S},e.showParticles=t.getParticles(),e.toggleParticles=function(){e.showParticles=!e.showParticles},e.showChromatin=t.getChromatin(),e.toggleChromatin=function(){e.showChromatin=!e.showChromatin},e.showTAD=t.getTAD(),e.toggleTAD=function(){e.colors=e.colorsTAD,e.showTAD=!0,e.showGenes=!1,e.showContacts=!1,e.showHP1=!1,e.showBRM=!1,e.showMRG15=!1,e.showPC=!1,e.showH1=!1},e.showGenes=t.getGenes(),e.toggleGenes=function(){e.showGenes===!1?(e.colors=e.colorsGenes,e.showTAD=!1,e.showGenes=!0,e.showContacts=!1,e.showHP1=!1,e.showBRM=!1,e.showMRG15=!1,e.showPC=!1,e.showH1=!1):(e.colors=e.colorsTAD,e.showTAD=!0,e.showGenes=!1,e.showContacts=!1,e.showHP1=!1,e.showBRM=!1,e.showMRG15=!1,e.showPC=!1,e.showH1=!1)},e.showContacts=t.getContacts(),e.toggleContacts=function(){e.colors=i.getColors(m,e.slider.position,h,d),e.showContacts===!1?(e.showTAD=!1,e.showGenes=!1,e.showContacts=!0,e.showHP1=!1,e.showBRM=!1,e.showMRG15=!1,e.showPC=!1,e.showH1=!1):(e.colors=e.colorsTAD,e.showTAD=!0,e.showGenes=!1,e.showContacts=!1,e.showHP1=!1,e.showBRM=!1,e.showMRG15=!1,e.showPC=!1,e.showH1=!1)},e.showHP1=t.getHP1(),e.toggleHP1=function(){e.showHP1===!1?(e.colors=e.colorsHP1,e.showTAD=!1,e.showGenes=!1,e.showContacts=!1,e.showHP1=!0,e.showBRM=!1,e.showMRG15=!1,e.showPC=!1,e.showH1=!1):(e.colors=e.colorsTAD,e.showTAD=!0,e.showGenes=!1,e.showContacts=!1,e.showHP1=!1,e.showBRM=!1,e.showMRG15=!1,e.showPC=!1,e.showH1=!1)},e.showBRM=t.getBRM(),e.toggleBRM=function(){e.showBRM===!1?(e.colors=e.colorsBRM,e.showTAD=!1,e.showGenes=!1,e.showContacts=!1,e.showHP1=!1,e.showBRM=!0,e.showMRG15=!1,e.showPC=!1,e.showH1=!1):(e.colors=e.colorsTAD,e.showTAD=!0,e.showGenes=!1,e.showContacts=!1,e.showHP1=!1,e.showBRM=!1,e.showMRG15=!1,e.showPC=!1,e.showH1=!1)},e.showMRG15=t.getMRG15(),e.toggleMRG15=function(){e.showMRG15===!1?(e.colors=e.colorsMRG15,e.showTAD=!1,e.showGenes=!1,e.showContacts=!1,e.showHP1=!1,e.showBRM=!1,e.showMRG15=!0,e.showPC=!1,e.showH1=!1):(e.colors=e.colorsTAD,e.showTAD=!0,e.showGenes=!1,e.showContacts=!1,e.showHP1=!1,e.showBRM=!1,e.showMRG15=!1,e.showPC=!1,e.showH1=!1)},e.showPC=t.getPC(),e.togglePC=function(){e.showPC===!1?(e.colors=e.colorsPC,e.showTAD=!1,e.showGenes=!1,e.showContacts=!1,e.showHP1=!1,e.showBRM=!1,e.showMRG15=!1,e.showPC=!0,e.showH1=!1):(e.colors=e.colorsTAD,e.showTAD=!0,e.showGenes=!1,e.showContacts=!1,e.showHP1=!1,e.showBRM=!1,e.showMRG15=!1,e.showPC=!1,e.showH1=!1)},e.showH1=t.getH1(),e.toggleH1=function(){e.showH1===!1?(e.colors=e.colorsH1,e.showTAD=!1,e.showGenes=!1,e.showContacts=!1,e.showHP1=!1,e.showBRM=!1,e.showMRG15=!1,e.showPC=!1,e.showH1=!0):(e.colors=e.colorsTAD,e.showTAD=!0,e.showGenes=!1,e.showContacts=!1,e.showHP1=!1,e.showBRM=!1,e.showMRG15=!1,e.showPC=!1,e.showH1=!1)},e.showSense=t.getSense(),e.toggleSense=function(){e.showSense=!e.showSense},e.$watch("slider.position",function(r,t){r!==t&&e.showContacts&&(e.colors=i.getColors(m,e.slider.position,h,d))})}angular.module("TADkit").controller("DashboardCtrl",r)}(),function(){"use strict";function r(){}angular.module("TADkit").controller("LoaderCtrl",r)}(),function(){"use strict";function r(){}angular.module("TADkit").controller("TopbarCtrl",r)}(),function(){"use strict";function r(r,e,t){var o="http://rest.ensembl.org/",n={},g={};return{loadInfoAssembly:function(t){var g=r.defer();return e.get(o+"info/assembly/"+t+"?content-type=application/json").success(function(r){n=r,console.log("Assembly Info for "+t+" retreived from Ensembl."),g.resolve(r)}),g.promise},getAssembly:function(){return n},loadInfoBiotypes:function(t){var n=r.defer();return e.get(o+"info/biotypes/"+t+"?content-type=application/json").success(function(r){console.log("Biotypes for "+t+" retreived from Ensembl."),n.resolve(r)}),n.promise},loadBiotypeColors:function(){var o=r.defer();return e.get("assets/json/ensembl-webcode-COLOUR.ini").success(function(r){var e=t.parse(r);g=e,console.log("Ensembl webcode biotype colors retrieved Ensembl."),o.resolve(r)}),o.promise},getBiotypeColors:function(){return g},getRegionBiotypes:function(r){for(var e,t=[],o={},n=0;e==r[n++];){var g=e.biotype;g in o||(o[g]=1,t.push(g))}console.log("TAD Biotypes"),console.log(t);var a=t.length;console.log("Total TAD Biotypes: %s",a)}}}angular.module("TADkit").factory("Assembly",r)}(),function(){"use strict";function r(r){return{parse:function(e){var t={section:/^\s*\[\s*([^\]]*)\s*\]\s*$/,param:/^\s*([\w\.\-\_]+)\s*=\s*([\w\.\-\_]+)/,comment:/^\s*#.*$/},o={},n=e.split(/\r\n|\r|\n/),g=null;return n.forEach(function(e){if(!t.comment.test(e)&&""!==e){var n;if(t.param.test(e))if(n=e.match(t.param),g){var a=r.nameToHex(n[2]);o[g][n[1]]=a}else o[n[1]]=n[2];else t.section.test(e)?(n=e.match(t.section),o[n[1]]={},g=n[1]):0===e.length&&g&&(g=null)}}),o}}}angular.module("TADkit").factory("colorsFromINI",r)}(),function(){"use strict";function r(r,e,t){var o="";return{loadContacts:function(){var t=r.defer();return e.get("assets/json/kartes_example_X_1559-1660.json").success(function(r){o=r,console.log("Contacts retreived from file."),t.resolve(r)}),t.promise},getContacts:function(){return o},getColors:function(r,e,o,n){var g,a=[],i=1/0,s=-1/0;for(g in r){var l=r[g].dist;i>l&&(i=l),l>s&&(s=l)}for(var b=s-i,c=r.length,u=Math.floor(e/n),h="#cccccc",d=[],p=0;c>p;p++){var f=r[p];f.a==u+1&&d.push(f)}for(var y=d.length,m=0;o>m;m++){for(var w=0;y>w;w++)if(m==u&&(h="#ff0000"),d[w].b==m+1){var v=d[w].dist,k=40,C=10+parseInt(v*k/b),T=50,x=90-parseInt(v*T/b),R="hsl(300,"+C+","+x+")";h=new t.hslToHex(R).process()}for(var H=0;n>H;H++)a.push(h);h="#cccccc"}return a}}}angular.module("TADkit").factory("Contacts",r)}(),function(){"use strict";function r(){var r=this;return r.re_={x11rgb:/^\s*rgb:([a-f0-9]{1,4})\/([a-f0-9]{1,4})\/([a-f0-9]{1,4})\s*$/i},r.colorNames={transparent:"rgb(0, 0, 0)",rust:"rgb(243, 137, 92)",stripes:"rgb(255, 54, 54)",dark_blue:"rgb(0, 0, 139)",contigblue1:"rgb(0, 0, 139)",contigblue2:"rgb(173, 216, 230)","border:grey70":"rgb(179, 179, 179)",aliceblue:"rgb(240, 248, 255)",antiquewhite:"rgb(250, 235, 215)",antiquewhite1:"rgb(255, 239, 219)",antiquewhite2:"rgb(238, 223, 204)",antiquewhite3:"rgb(205, 192, 176)",antiquewhite4:"rgb(139, 131, 120)",aquamarine:"rgb(127, 255, 212)",aquamarine1:"rgb(127, 255, 212)",aquamarine2:"rgb(118, 238, 198)",aquamarine3:"rgb(102, 205, 170)",aquamarine4:"rgb(69, 139, 116)",azure:"rgb(240, 255, 255)",azure1:"rgb(240, 255, 255)",azure2:"rgb(224, 238, 238)",azure3:"rgb(193, 205, 205)",azure4:"rgb(131, 139, 139)",beige:"rgb(245, 245, 220)",bisque:"rgb(255, 228, 196)",bisque1:"rgb(255, 228, 196)",bisque2:"rgb(238, 213, 183)",bisque3:"rgb(205, 183, 158)",bisque4:"rgb(139, 125, 107)",black:"rgb(0, 0, 0)",blanchedalmond:"rgb(255, 235, 205)",blue:"rgb(0, 0, 255)",blue1:"rgb(0, 0, 255)",blue2:"rgb(0, 0, 238)",blue3:"rgb(0, 0, 205)",blue4:"rgb(0, 0, 139)",blueviolet:"rgb(138, 43, 226)",brown:"rgb(165, 42, 42)",brown1:"rgb(255, 64, 64)",brown2:"rgb(238, 59, 59)",brown3:"rgb(205, 51, 51)",brown4:"rgb(139, 35, 35)",burlywood:"rgb(222, 184, 135)",burlywood1:"rgb(255, 211, 155)",burlywood2:"rgb(238, 197, 145)",burlywood3:"rgb(205, 170, 125)",burlywood4:"rgb(139, 115, 85)",cadetblue:"rgb(95, 158, 160)",cadetblue1:"rgb(152, 245, 255)",cadetblue2:"rgb(142, 229, 238)",cadetblue3:"rgb(122, 197, 205)",cadetblue4:"rgb(83, 134, 139)",chartreuse:"rgb(127, 255, 0)",chartreuse1:"rgb(127, 255, 0)",chartreuse2:"rgb(118, 238, 0)",chartreuse3:"rgb(102, 205, 0)",chartreuse4:"rgb(69, 139, 0)",chocolate:"rgb(210, 105, 30)",chocolate1:"rgb(255, 127, 36)",chocolate2:"rgb(238, 118, 33)",chocolate3:"rgb(205, 102, 29)",chocolate4:"rgb(139, 69, 19)",coral:"rgb(255, 127, 80)",coral1:"rgb(255, 114, 86)",coral2:"rgb(238, 106, 80)",coral3:"rgb(205, 91, 69)",coral4:"rgb(139, 62, 47)",cornflowerblue:"rgb(100, 149, 237)",cornsilk:"rgb(255, 248, 220)",cornsilk1:"rgb(255, 248, 220)",cornsilk2:"rgb(238, 232, 205)",cornsilk3:"rgb(205, 200, 177)",cornsilk4:"rgb(139, 136, 120)",cyan:"rgb(0, 255, 255)",cyan1:"rgb(0, 255, 255)",cyan2:"rgb(0, 238, 238)",cyan3:"rgb(0, 205, 205)",cyan4:"rgb(0, 139, 139)",darkblue:"rgb(0, 0, 139)",darkcyan:"rgb(0, 139, 139)",darkgoldenrod:"rgb(184, 134, 11)",darkgoldenrod1:"rgb(255, 185, 15)",darkgoldenrod2:"rgb(238, 173, 14)",darkgoldenrod3:"rgb(205, 149, 12)",darkgoldenrod4:"rgb(139, 101, 8)",darkgray:"rgb(169, 169, 169)",darkgreen:"rgb(0, 100, 0)",darkgrey:"rgb(169, 169, 169)",darkkhaki:"rgb(189, 183, 107)",darkmagenta:"rgb(139, 0, 139)",darkolivegreen:"rgb(85, 107, 47)",darkolivegreen1:"rgb(202, 255, 112)",darkolivegreen2:"rgb(188, 238, 104)",darkolivegreen3:"rgb(162, 205, 90)",darkolivegreen4:"rgb(110, 139, 61)",darkorange:"rgb(255, 140, 0)",darkorange1:"rgb(255, 127, 0)",darkorange2:"rgb(238, 118, 0)",darkorange3:"rgb(205, 102, 0)",darkorange4:"rgb(139, 69, 0)",darkorchid:"rgb(153, 50, 204)",darkorchid1:"rgb(191, 62, 255)",darkorchid2:"rgb(178, 58, 238)",darkorchid3:"rgb(154, 50, 205)",darkorchid4:"rgb(104, 34, 139)",darkred:"rgb(139, 0, 0)",darksalmon:"rgb(233, 150, 122)",darkseagreen:"rgb(143, 188, 143)",darkseagreen1:"rgb(193, 255, 193)",darkseagreen2:"rgb(180, 238, 180)",darkseagreen3:"rgb(155, 205, 155)",darkseagreen4:"rgb(105, 139, 105)",darkslateblue:"rgb(72, 61, 139)",darkslategray:"rgb(47, 79, 79)",darkslategray1:"rgb(151, 255, 255)",darkslategray2:"rgb(141, 238, 238)",darkslategray3:"rgb(121, 205, 205)",darkslategray4:"rgb(82, 139, 139)",darkslategrey:"rgb(47, 79, 79)",darkturquoise:"rgb(0, 206, 209)",darkviolet:"rgb(148, 0, 211)",debianred:"rgb(215, 7, 81)",deeppink:"rgb(255, 20, 147)",deeppink1:"rgb(255, 20, 147)",deeppink2:"rgb(238, 18, 137)",deeppink3:"rgb(205, 16, 118)",deeppink4:"rgb(139, 10, 80)",deepskyblue:"rgb(0, 191, 255)",deepskyblue1:"rgb(0, 191, 255)",deepskyblue2:"rgb(0, 178, 238)",deepskyblue3:"rgb(0, 154, 205)",deepskyblue4:"rgb(0, 104, 139)",dimgray:"rgb(105, 105, 105)",dimgrey:"rgb(105, 105, 105)",dodgerblue:"rgb(30, 144, 255)",dodgerblue1:"rgb(30, 144, 255)",dodgerblue2:"rgb(28, 134, 238)",dodgerblue3:"rgb(24, 116, 205)",dodgerblue4:"rgb(16, 78, 139)",firebrick:"rgb(178, 34, 34)",firebrick1:"rgb(255, 48, 48)",firebrick2:"rgb(238, 44, 44)",firebrick3:"rgb(205, 38, 38)",firebrick4:"rgb(139, 26, 26)",floralwhite:"rgb(255, 250, 240)",forestgreen:"rgb(34, 139, 34)",gainsboro:"rgb(220, 220, 220)",ghostwhite:"rgb(248, 248, 255)",gold:"rgb(255, 215, 0)",gold1:"rgb(255, 215, 0)",gold2:"rgb(238, 201, 0)",gold3:"rgb(205, 173, 0)",gold4:"rgb(139, 117, 0)",goldenrod:"rgb(218, 165, 32)",goldenrod1:"rgb(255, 193, 37)",goldenrod2:"rgb(238, 180, 34)",goldenrod3:"rgb(205, 155, 29)",goldenrod4:"rgb(139, 105, 20)",gray:"rgb(190, 190, 190)",gray0:"rgb(0, 0, 0)",gray1:"rgb(3, 3, 3)",gray10:"rgb(26, 26, 26)",gray100:"rgb(255, 255, 255)",gray11:"rgb(28, 28, 28)",gray12:"rgb(31, 31, 31)",gray13:"rgb(33, 33, 33)",gray14:"rgb(36, 36, 36)",gray15:"rgb(38, 38, 38)",gray16:"rgb(41, 41, 41)",gray17:"rgb(43, 43, 43)",gray18:"rgb(46, 46, 46)",gray19:"rgb(48, 48, 48)",gray2:"rgb(5, 5, 5)",gray20:"rgb(51, 51, 51)",gray21:"rgb(54, 54, 54)",gray22:"rgb(56, 56, 56)",gray23:"rgb(59, 59, 59)",gray24:"rgb(61, 61, 61)",gray25:"rgb(64, 64, 64)",gray26:"rgb(66, 66, 66)",gray27:"rgb(69, 69, 69)",gray28:"rgb(71, 71, 71)",gray29:"rgb(74, 74, 74)",gray3:"rgb(8, 8, 8)",gray30:"rgb(77, 77, 77)",gray31:"rgb(79, 79, 79)",gray32:"rgb(82, 82, 82)",gray33:"rgb(84, 84, 84)",gray34:"rgb(87, 87, 87)",gray35:"rgb(89, 89, 89)",gray36:"rgb(92, 92, 92)",gray37:"rgb(94, 94, 94)",gray38:"rgb(97, 97, 97)",gray39:"rgb(99, 99, 99)",gray4:"rgb(10, 10, 10)",gray40:"rgb(102, 102, 102)",gray41:"rgb(105, 105, 105)",gray42:"rgb(107, 107, 107)",gray43:"rgb(110, 110, 110)",gray44:"rgb(112, 112, 112)",gray45:"rgb(115, 115, 115)",gray46:"rgb(117, 117, 117)",gray47:"rgb(120, 120, 120)",gray48:"rgb(122, 122, 122)",gray49:"rgb(125, 125, 125)",gray5:"rgb(13, 13, 13)",gray50:"rgb(127, 127, 127)",gray51:"rgb(130, 130, 130)",gray52:"rgb(133, 133, 133)",gray53:"rgb(135, 135, 135)",gray54:"rgb(138, 138, 138)",gray55:"rgb(140, 140, 140)",gray56:"rgb(143, 143, 143)",gray57:"rgb(145, 145, 145)",gray58:"rgb(148, 148, 148)",gray59:"rgb(150, 150, 150)",gray6:"rgb(15, 15, 15)",gray60:"rgb(153, 153, 153)",gray61:"rgb(156, 156, 156)",gray62:"rgb(158, 158, 158)",gray63:"rgb(161, 161, 161)",gray64:"rgb(163, 163, 163)",gray65:"rgb(166, 166, 166)",gray66:"rgb(168, 168, 168)",gray67:"rgb(171, 171, 171)",gray68:"rgb(173, 173, 173)",gray69:"rgb(176, 176, 176)",gray7:"rgb(18, 18, 18)",gray70:"rgb(179, 179, 179)",gray71:"rgb(181, 181, 181)",gray72:"rgb(184, 184, 184)",gray73:"rgb(186, 186, 186)",gray74:"rgb(189, 189, 189)",gray75:"rgb(191, 191, 191)",gray76:"rgb(194, 194, 194)",gray77:"rgb(196, 196, 196)",gray78:"rgb(199, 199, 199)",gray79:"rgb(201, 201, 201)",gray8:"rgb(20, 20, 20)",gray80:"rgb(204, 204, 204)",gray81:"rgb(207, 207, 207)",gray82:"rgb(209, 209, 209)",gray83:"rgb(212, 212, 212)",gray84:"rgb(214, 214, 214)",gray85:"rgb(217, 217, 217)",gray86:"rgb(219, 219, 219)",gray87:"rgb(222, 222, 222)",gray88:"rgb(224, 224, 224)",gray89:"rgb(227, 227, 227)",gray9:"rgb(23, 23, 23)",gray90:"rgb(229, 229, 229)",gray91:"rgb(232, 232, 232)",gray92:"rgb(235, 235, 235)",gray93:"rgb(237, 237, 237)",gray94:"rgb(240, 240, 240)",gray95:"rgb(242, 242, 242)",gray96:"rgb(245, 245, 245)",gray97:"rgb(247, 247, 247)",gray98:"rgb(250, 250, 250)",gray99:"rgb(252, 252, 252)",green:"rgb(0, 255, 0)",green1:"rgb(0, 255, 0)",green2:"rgb(0, 238, 0)",green3:"rgb(0, 205, 0)",green4:"rgb(0, 139, 0)",greenyellow:"rgb(173, 255, 47)",grey:"rgb(190, 190, 190)",grey0:"rgb(0, 0, 0)",grey1:"rgb(3, 3, 3)",grey10:"rgb(26, 26, 26)",grey100:"rgb(255, 255, 255)",grey11:"rgb(28, 28, 28)",grey12:"rgb(31, 31, 31)",grey13:"rgb(33, 33, 33)",grey14:"rgb(36, 36, 36)",grey15:"rgb(38, 38, 38)",grey16:"rgb(41, 41, 41)",grey17:"rgb(43, 43, 43)",grey18:"rgb(46, 46, 46)",grey19:"rgb(48, 48, 48)",grey2:"rgb(5, 5, 5)",grey20:"rgb(51, 51, 51)",grey21:"rgb(54, 54, 54)",grey22:"rgb(56, 56, 56)",grey23:"rgb(59, 59, 59)",grey24:"rgb(61, 61, 61)",grey25:"rgb(64, 64, 64)",grey26:"rgb(66, 66, 66)",grey27:"rgb(69, 69, 69)",grey28:"rgb(71, 71, 71)",grey29:"rgb(74, 74, 74)",grey3:"rgb(8, 8, 8)",grey30:"rgb(77, 77, 77)",grey31:"rgb(79, 79, 79)",grey32:"rgb(82, 82, 82)",grey33:"rgb(84, 84, 84)",grey34:"rgb(87, 87, 87)",grey35:"rgb(89, 89, 89)",grey36:"rgb(92, 92, 92)",grey37:"rgb(94, 94, 94)",grey38:"rgb(97, 97, 97)",grey39:"rgb(99, 99, 99)",grey4:"rgb(10, 10, 10)",grey40:"rgb(102, 102, 102)",grey41:"rgb(105, 105, 105)",grey42:"rgb(107, 107, 107)",grey43:"rgb(110, 110, 110)",grey44:"rgb(112, 112, 112)",grey45:"rgb(115, 115, 115)",grey46:"rgb(117, 117, 117)",grey47:"rgb(120, 120, 120)",grey48:"rgb(122, 122, 122)",grey49:"rgb(125, 125, 125)",grey5:"rgb(13, 13, 13)",grey50:"rgb(127, 127, 127)",grey51:"rgb(130, 130, 130)",grey52:"rgb(133, 133, 133)",grey53:"rgb(135, 135, 135)",grey54:"rgb(138, 138, 138)",grey55:"rgb(140, 140, 140)",grey56:"rgb(143, 143, 143)",grey57:"rgb(145, 145, 145)",grey58:"rgb(148, 148, 148)",grey59:"rgb(150, 150, 150)",grey6:"rgb(15, 15, 15)",grey60:"rgb(153, 153, 153)",grey61:"rgb(156, 156, 156)",grey62:"rgb(158, 158, 158)",grey63:"rgb(161, 161, 161)",grey64:"rgb(163, 163, 163)",grey65:"rgb(166, 166, 166)",grey66:"rgb(168, 168, 168)",grey67:"rgb(171, 171, 171)",grey68:"rgb(173, 173, 173)",grey69:"rgb(176, 176, 176)",grey7:"rgb(18, 18, 18)",grey70:"rgb(179, 179, 179)",grey71:"rgb(181, 181, 181)",grey72:"rgb(184, 184, 184)",grey73:"rgb(186, 186, 186)",grey74:"rgb(189, 189, 189)",grey75:"rgb(191, 191, 191)",grey76:"rgb(194, 194, 194)",grey77:"rgb(196, 196, 196)",grey78:"rgb(199, 199, 199)",grey79:"rgb(201, 201, 201)",grey8:"rgb(20, 20, 20)",grey80:"rgb(204, 204, 204)",grey81:"rgb(207, 207, 207)",grey82:"rgb(209, 209, 209)",grey83:"rgb(212, 212, 212)",grey84:"rgb(214, 214, 214)",grey85:"rgb(217, 217, 217)",grey86:"rgb(219, 219, 219)",grey87:"rgb(222, 222, 222)",grey88:"rgb(224, 224, 224)",grey89:"rgb(227, 227, 227)",grey9:"rgb(23, 23, 23)",grey90:"rgb(229, 229, 229)",grey91:"rgb(232, 232, 232)",grey92:"rgb(235, 235, 235)",grey93:"rgb(237, 237, 237)",grey94:"rgb(240, 240, 240)",grey95:"rgb(242, 242, 242)",grey96:"rgb(245, 245, 245)",grey97:"rgb(247, 247, 247)",grey98:"rgb(250, 250, 250)",grey99:"rgb(252, 252, 252)",honeydew:"rgb(240, 255, 240)",honeydew1:"rgb(240, 255, 240)",honeydew2:"rgb(224, 238, 224)",honeydew3:"rgb(193, 205, 193)",honeydew4:"rgb(131, 139, 131)",hotpink:"rgb(255, 105, 180)",hotpink1:"rgb(255, 110, 180)",hotpink2:"rgb(238, 106, 167)",hotpink3:"rgb(205, 96, 144)",hotpink4:"rgb(139, 58, 98)",indianred:"rgb(205, 92, 92)",indianred1:"rgb(255, 106, 106)",indianred2:"rgb(238, 99, 99)",indianred3:"rgb(205, 85, 85)",indianred4:"rgb(139, 58, 58)",ivory:"rgb(255, 255, 240)",ivory1:"rgb(255, 255, 240)",ivory2:"rgb(238, 238, 224)",ivory3:"rgb(205, 205, 193)",ivory4:"rgb(139, 139, 131)",khaki:"rgb(240, 230, 140)",khaki1:"rgb(255, 246, 143)",khaki2:"rgb(238, 230, 133)",khaki3:"rgb(205, 198, 115)",khaki4:"rgb(139, 134, 78)",lavender:"rgb(230, 230, 250)",lavenderblush:"rgb(255, 240, 245)",lavenderblush1:"rgb(255, 240, 245)",lavenderblush2:"rgb(238, 224, 229)",lavenderblush3:"rgb(205, 193, 197)",lavenderblush4:"rgb(139, 131, 134)",lawngreen:"rgb(124, 252, 0)",lemonchiffon:"rgb(255, 250, 205)",lemonchiffon1:"rgb(255, 250, 205)",lemonchiffon2:"rgb(238, 233, 191)",lemonchiffon3:"rgb(205, 201, 165)",lemonchiffon4:"rgb(139, 137, 112)",lightblue:"rgb(173, 216, 230)",lightblue1:"rgb(191, 239, 255)",lightblue2:"rgb(178, 223, 238)",lightblue3:"rgb(154, 192, 205)",lightblue4:"rgb(104, 131, 139)",lightcoral:"rgb(240, 128, 128)",lightcyan:"rgb(224, 255, 255)",lightcyan1:"rgb(224, 255, 255)",lightcyan2:"rgb(209, 238, 238)",lightcyan3:"rgb(180, 205, 205)",lightcyan4:"rgb(122, 139, 139)",lightgoldenrod:"rgb(238, 221, 130)",lightgoldenrod1:"rgb(255, 236, 139)",lightgoldenrod2:"rgb(238, 220, 130)",lightgoldenrod3:"rgb(205, 190, 112)",lightgoldenrod4:"rgb(139, 129, 76)",lightgoldenrodyellow:"rgb(250, 250, 210)",lightgray:"rgb(211, 211, 211)",lightgreen:"rgb(144, 238, 144)",lightgrey:"rgb(211, 211, 211)",lightpink:"rgb(255, 182, 193)",lightpink1:"rgb(255, 174, 185)",lightpink2:"rgb(238, 162, 173)",lightpink3:"rgb(205, 140, 149)",lightpink4:"rgb(139, 95, 101)",lightsalmon:"rgb(255, 160, 122)",lightsalmon1:"rgb(255, 160, 122)",lightsalmon2:"rgb(238, 149, 114)",lightsalmon3:"rgb(205, 129, 98)",lightsalmon4:"rgb(139, 87, 66)",lightseagreen:"rgb(32, 178, 170)",lightskyblue:"rgb(135, 206, 250)",lightskyblue1:"rgb(176, 226, 255)",lightskyblue2:"rgb(164, 211, 238)",lightskyblue3:"rgb(141, 182, 205)",lightskyblue4:"rgb(96, 123, 139)",lightslateblue:"rgb(132, 112, 255)",lightslategray:"rgb(119, 136, 153)",lightslategrey:"rgb(119, 136, 153)",lightsteelblue:"rgb(176, 196, 222)",lightsteelblue1:"rgb(202, 225, 255)",lightsteelblue2:"rgb(188, 210, 238)",lightsteelblue3:"rgb(162, 181, 205)",lightsteelblue4:"rgb(110, 123, 139)",lightyellow:"rgb(255, 255, 224)",lightyellow1:"rgb(255, 255, 224)",lightyellow2:"rgb(238, 238, 209)",lightyellow3:"rgb(205, 205, 180)",lightyellow4:"rgb(139, 139, 122)",limegreen:"rgb(50, 205, 50)",linen:"rgb(250, 240, 230)",magenta:"rgb(255, 0, 255)",magenta1:"rgb(255, 0, 255)",magenta2:"rgb(238, 0, 238)",magenta3:"rgb(205, 0, 205)",magenta4:"rgb(139, 0, 139)",maroon:"rgb(176, 48, 96)",maroon1:"rgb(255, 52, 179)",maroon2:"rgb(238, 48, 167)",maroon3:"rgb(205, 41, 144)",maroon4:"rgb(139, 28, 98)",mediumaquamarine:"rgb(102, 205, 170)",mediumblue:"rgb(0, 0, 205)",mediumorchid:"rgb(186, 85, 211)",mediumorchid1:"rgb(224, 102, 255)",mediumorchid2:"rgb(209, 95, 238)",mediumorchid3:"rgb(180, 82, 205)",mediumorchid4:"rgb(122, 55, 139)",mediumpurple:"rgb(147, 112, 219)",mediumpurple1:"rgb(171, 130, 255)",mediumpurple2:"rgb(159, 121, 238)",mediumpurple3:"rgb(137, 104, 205)",mediumpurple4:"rgb(93, 71, 139)",mediumseagreen:"rgb(60, 179, 113)",mediumslateblue:"rgb(123, 104, 238)",mediumspringgreen:"rgb(0, 250, 154)",mediumturquoise:"rgb(72, 209, 204)",mediumvioletred:"rgb(199, 21, 133)",midnightblue:"rgb(25, 25, 112)",mintcream:"rgb(245, 255, 250)",mistyrose:"rgb(255, 228, 225)",mistyrose1:"rgb(255, 228, 225)",mistyrose2:"rgb(238, 213, 210)",mistyrose3:"rgb(205, 183, 181)",mistyrose4:"rgb(139, 125, 123)",moccasin:"rgb(255, 228, 181)",navajowhite:"rgb(255, 222, 173)",navajowhite1:"rgb(255, 222, 173)",navajowhite2:"rgb(238, 207, 161)",navajowhite3:"rgb(205, 179, 139)",navajowhite4:"rgb(139, 121, 94)",navy:"rgb(0, 0, 128)",navyblue:"rgb(0, 0, 128)",oldlace:"rgb(253, 245, 230)",olivedrab:"rgb(107, 142, 35)",olivedrab1:"rgb(192, 255, 62)",olivedrab2:"rgb(179, 238, 58)",olivedrab3:"rgb(154, 205, 50)",olivedrab4:"rgb(105, 139, 34)",orange:"rgb(255, 165, 0)",orange1:"rgb(255, 165, 0)",orange2:"rgb(238, 154, 0)",orange3:"rgb(205, 133, 0)",orange4:"rgb(139, 90, 0)",orangered:"rgb(255, 69, 0)",orangered1:"rgb(255, 69, 0)",orangered2:"rgb(238, 64, 0)",orangered3:"rgb(205, 55, 0)",orangered4:"rgb(139, 37, 0)",orchid:"rgb(218, 112, 214)",orchid1:"rgb(255, 131, 250)",orchid2:"rgb(238, 122, 233)",orchid3:"rgb(205, 105, 201)",orchid4:"rgb(139, 71, 137)",palegoldenrod:"rgb(238, 232, 170)",palegreen:"rgb(152, 251, 152)",palegreen1:"rgb(154, 255, 154)",palegreen2:"rgb(144, 238, 144)",palegreen3:"rgb(124, 205, 124)",palegreen4:"rgb(84, 139, 84)",paleturquoise:"rgb(175, 238, 238)",paleturquoise1:"rgb(187, 255, 255)",paleturquoise2:"rgb(174, 238, 238)",paleturquoise3:"rgb(150, 205, 205)",paleturquoise4:"rgb(102, 139, 139)",palevioletred:"rgb(219, 112, 147)",palevioletred1:"rgb(255, 130, 171)",palevioletred2:"rgb(238, 121, 159)",palevioletred3:"rgb(205, 104, 137)",palevioletred4:"rgb(139, 71, 93)",papayawhip:"rgb(255, 239, 213)",peachpuff:"rgb(255, 218, 185)",peachpuff1:"rgb(255, 218, 185)",peachpuff2:"rgb(238, 203, 173)",peachpuff3:"rgb(205, 175, 149)",peachpuff4:"rgb(139, 119, 101)",peru:"rgb(205, 133, 63)",pink:"rgb(255, 192, 203)",pink1:"rgb(255, 181, 197)",pink2:"rgb(238, 169, 184)",pink3:"rgb(205, 145, 158)",pink4:"rgb(139, 99, 108)",plum:"rgb(221, 160, 221)",plum1:"rgb(255, 187, 255)",plum2:"rgb(238, 174, 238)",plum3:"rgb(205, 150, 205)",plum4:"rgb(139, 102, 139)",powderblue:"rgb(176, 224, 230)",purple:"rgb(160, 32, 240)",purple1:"rgb(155, 48, 255)",purple2:"rgb(145, 44, 238)",purple3:"rgb(125, 38, 205)",purple4:"rgb(85, 26, 139)",red:"rgb(255, 0, 0)",red1:"rgb(255, 0, 0)",red2:"rgb(238, 0, 0)",red3:"rgb(205, 0, 0)",red4:"rgb(139, 0, 0)",rosybrown:"rgb(188, 143, 143)",rosybrown1:"rgb(255, 193, 193)",rosybrown2:"rgb(238, 180, 180)",rosybrown3:"rgb(205, 155, 155)",rosybrown4:"rgb(139, 105, 105)",royalblue:"rgb(65, 105, 225)",royalblue1:"rgb(72, 118, 255)",royalblue2:"rgb(67, 110, 238)",royalblue3:"rgb(58, 95, 205)",royalblue4:"rgb(39, 64, 139)",saddlebrown:"rgb(139, 69, 19)",salmon:"rgb(250, 128, 114)",salmon1:"rgb(255, 140, 105)",salmon2:"rgb(238, 130, 98)",salmon3:"rgb(205, 112, 84)",salmon4:"rgb(139, 76, 57)",sandybrown:"rgb(244, 164, 96)",seagreen:"rgb(46, 139, 87)",seagreen1:"rgb(84, 255, 159)",seagreen2:"rgb(78, 238, 148)",seagreen3:"rgb(67, 205, 128)",seagreen4:"rgb(46, 139, 87)",seashell:"rgb(255, 245, 238)",seashell1:"rgb(255, 245, 238)",seashell2:"rgb(238, 229, 222)",seashell3:"rgb(205, 197, 191)",seashell4:"rgb(139, 134, 130)",sienna:"rgb(160, 82, 45)",sienna1:"rgb(255, 130, 71)",sienna2:"rgb(238, 121, 66)",sienna3:"rgb(205, 104, 57)",sienna4:"rgb(139, 71, 38)",skyblue:"rgb(135, 206, 235)",skyblue1:"rgb(135, 206, 255)",skyblue2:"rgb(126, 192, 238)",skyblue3:"rgb(108, 166, 205)",skyblue4:"rgb(74, 112, 139)",slateblue:"rgb(106, 90, 205)",slateblue1:"rgb(131, 111, 255)",slateblue2:"rgb(122, 103, 238)",slateblue3:"rgb(105, 89, 205)",slateblue4:"rgb(71, 60, 139)",slategray:"rgb(112, 128, 144)",slategray1:"rgb(198, 226, 255)",slategray2:"rgb(185, 211, 238)",slategray3:"rgb(159, 182, 205)",slategray4:"rgb(108, 123, 139)",slategrey:"rgb(112, 128, 144)",snow:"rgb(255, 250, 250)",snow1:"rgb(255, 250, 250)",snow2:"rgb(238, 233, 233)",snow3:"rgb(205, 201, 201)",snow4:"rgb(139, 137, 137)",springgreen:"rgb(0, 255, 127)",springgreen1:"rgb(0, 255, 127)",springgreen2:"rgb(0, 238, 118)",springgreen3:"rgb(0, 205, 102)",springgreen4:"rgb(0, 139, 69)",steelblue:"rgb(70, 130, 180)",steelblue1:"rgb(99, 184, 255)",steelblue2:"rgb(92, 172, 238)",steelblue3:"rgb(79, 148, 205)",steelblue4:"rgb(54, 100, 139)",tan:"rgb(210, 180, 140)",tan1:"rgb(255, 165, 79)",tan2:"rgb(238, 154, 73)",tan3:"rgb(205, 133, 63)",tan4:"rgb(139, 90, 43)",thistle:"rgb(216, 191, 216)",thistle1:"rgb(255, 225, 255)",thistle2:"rgb(238, 210, 238)",thistle3:"rgb(205, 181, 205)",thistle4:"rgb(139, 123, 139)",tomato:"rgb(255, 99, 71)",tomato1:"rgb(255, 99, 71)",tomato2:"rgb(238, 92, 66)",tomato3:"rgb(205, 79, 57)",tomato4:"rgb(139, 54, 38)",turquoise:"rgb(64, 224, 208)",turquoise1:"rgb(0, 245, 255)",turquoise2:"rgb(0, 229, 238)",turquoise3:"rgb(0, 197, 205)",turquoise4:"rgb(0, 134, 139)",violet:"rgb(238, 130, 238)",violetred:"rgb(208, 32, 144)",violetred1:"rgb(255, 62, 150)",violetred2:"rgb(238, 58, 140)",violetred3:"rgb(205, 50, 120)",violetred4:"rgb(139, 34, 82)",wheat:"rgb(245, 222, 179)",wheat1:"rgb(255, 231, 186)",wheat2:"rgb(238, 216, 174)",wheat3:"rgb(205, 186, 150)",wheat4:"rgb(139, 126, 102)",white:"rgb(255, 255, 255)",whitesmoke:"rgb(245, 245, 245)",yellow:"rgb(255, 255, 0)",yellow1:"rgb(255, 255, 0)",yellow2:"rgb(238, 238, 0)",yellow3:"rgb(205, 205, 0)",yellow4:"rgb(139, 139, 0)",yellowgreen:"rgb(154, 205, 50)"},{nameToRGB:function(e){return e in r.colorNames?r.colorNames[e]:(e=e.toLowerCase(),e in r.colorNames?r.colorNames[e]:(e=e.replace(/\s+/g,""),e in r.colorNames?r.colorNames[e]:null))
},testIfHex:function(r){var e=/(^[0-9A-F]{6}$)|(^[0-9A-F]{3}$)/i.test(r);return e},rgbToHex:function(r){var e=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(r),t=parseInt(e[2]),o=parseInt(e[3]),n=parseInt(e[4]);return"#"+((1<<24)+(t<<16)+(o<<8)+n).toString(16).slice(1)},hslToHex:function(r){var e=function(r,e,o){var n,g,a;if(r%=360,0>r&&(r+=360),r=~~r/360,0>e?e=0:e>100&&(e=100),e=~~e/100,0>o?o=0:o>100&&(o=100),o=~~o/100,0===e)n=g=a=o;else{var i=.5>o?o*(1+e):o+e-o*e,s=2*o-i;n=t(s,i,r+1/3),g=t(s,i,r),a=t(s,i,r-1/3)}return[~~(255*n),~~(255*g),~~(255*a)]},t=function(r,e,t){return 0>t&&(t+=1),t>1&&(t-=1),1/6>t?r+6*(e-r)*t:.5>t?e:2/3>t?r+(e-r)*(2/3-t)*6:r};return{process:function(){return r.replace(/hsl\((-?\d+),(-?\d+)%?,(-?\d+)%?\)/g,function(r,t,o,n){var g=e(t,o,n),a=g[0].toString(16),i=g[1].toString(16),s=g[2].toString(16);return"#"+((1==a.length?"0":"")+a)+((1==i.length?"0":"")+i)+((1==s.length?"0":"")+s)})}}},nameToHex:function(e){e=e.replace("/#","/");var t,o=this.testIfHex(e);return o?"#"+e:e in r.colorNames?t=this.rgbToHex(r.colorNames[e]):(e=e.toLowerCase(),e in r.colorNames?t=this.rgbToHex(r.colorNames[e]):(e=e.replace(/\s+/g,""),e in r.colorNames?t=this.rgbToHex(r.colorNames[e]):null))},x11ToCSS:function(e){function t(r){return 1==r.length?parseInt(r+r,16):2==r.length?parseInt(r,16):(3==r.length&&(r+=r.substr(2)),Math.round(parseInt(r,16)/257))}var o=e.match(r.re_.x11rgb);return o?(o.splice(0,1),r.arrayToRGBA(o.map(t))):this.nameToRGB(e)}}}angular.module("TADkit").service("convertColors",r)}(),function(){"use strict";function r(r,e){var t="http://rest.ensembl.org/",o="";return{loadRegionGenes:function(n,g){var a=r.defer();return e.get(t+"overlap/region/"+n+"/"+g+"?feature=gene;content-type=application/json").success(function(r){o=r,console.log(r.length+" genes for region "+g+" of "+n+" retreived from Ensembl."),a.resolve(r)}),a.promise},getGenes:function(){return o},getGenesCount:function(){return o.length},getGenesPresent:function(r,e,t,o,n){for(var g=[],a=o+n*e,i=a+n,s=0;s<r.length;s++){var l=r[s].start,b=r[s].end;Math.max(a,l)<=Math.min(i,b)&&g.push(r[s])}return g},getColors:function(r,e,t,o,n){for(var g=[],a=0;t>a;a++){for(var i=[],s=o+n*a,l=s+n,b=this.getGenesCount(),c="#cccccc",u=0;b>u;u++){var h=r[u].start,d=r[u].end,p=[];Math.max(s,h)<=Math.min(l,d)&&(p.push(a),i.length>0?"protein_coding"==i[0]?i[0]=r[u].biotype:i.push(y):i.push(r[u].biotype)),r[u].inFragments=p}for(var f=0;f<i.length;f++){var y=i[0].toLowerCase();c=y in e?e[y]:"#110100"}g.push(c)}return g},getRandomColors:function(r){var e=[];console.log(r);for(var t=0;r>t;t++){var o="#"+Math.floor(16777215*Math.random()).toString(16);e.push(o)}return e}}}angular.module("TADkit").factory("Genes",r)}(),function(){"use strict";function r(r,e,t,o,n,g){var a="",i="X:0-4999999",s=e.loadTAD().then(function(){return a=e.getSpeciesUrl(),t.loadInfoAssembly(a)}).then(function(){return i=e.getSlice(),o.loadRegionGenes(a,i)}).then(function(){return t.loadBiotypeColors()}).then(function(){return n.loadProteins(a,i)}).then(function(){return g.loadContacts()});return{promise:s,newTAD:function(){return null}}}angular.module("TADkit").service("loadTAD",r)}(),function(){"use strict";function r(r,e){var t="";return{loadProteins:function(o,n){var g=r.defer();return e.get("assets/json/GSE22069_norm_aggregated_discretized_tiling_arrays.json").success(function(r){t=r,console.log("Proteins for region "+n+" of "+o+" retreived from file."),g.resolve(r)}),g.promise},getProteins:function(){return t},getSampleCount:function(){return t.length},getProteinsList:function(){for(var r=[],e=4;e<t[0].length;e++)for(var o in t[0])r.push(o);return r},getProteinCount:function(){var r=t[0].length-4;return r},getProteinArray:function(r,e){for(var t=[],o=0;o<r.length;o++)1==r[o][e]&&t.push({fragmentID:r[o].fragmentID,chromosome:r[o].chromosome,start:r[o].start,end:r[o].end});return t},getColors:function(r,e,t,o,n){var g=[],a=this.getProteinArray(r,e),i="#999999";"HP1"==e&&(i="#227c4f"),"BRM"==e&&(i="#8ece0d"),"MRG15"==e&&(i="#e71818"),"PC"==e&&(i="#6666ff"),"H1"==e&&(i="#424242");for(var s=0;t>s;s++){for(var l=o+n*s,b=l+n,c=a.length,u="#cccccc",h=0;c>h;h++){var d=a[h].start,p=a[h].end;Math.max(l,d)<=Math.min(b,p)&&(u=i)}g.push(u)}return g}}}angular.module("TADkit").factory("Proteins",r)}(),function(){"use strict";function r(){var r=!1,e=!0,t=!0,o=!1,n=!1,g=!1,a=!1,i=!1,s=!1,l=!1,b=!0;return{toggle:function(r){return r=!r},toggleParticles:function(){return r=this.toggle(r)},getParticles:function(){return r},toggleChromatin:function(){return e=this.toggle(e)},getChromatin:function(){return e},toggleTAD:function(){return t=this.toggle(t)},getTAD:function(){return t},toggleGenes:function(){return o=this.toggle(o)},getGenes:function(){return o},toggleContacts:function(){return n=this.toggle(n)},getContacts:function(){return n},toggleHP1:function(){return g=this.toggle(g)},getHP1:function(){return g},toggleBRM:function(){return a=this.toggle(a)},getBRM:function(){return a},toggleMRG15:function(){return i=this.toggle(i)},getMRG15:function(){return i},togglePC:function(){return s=this.toggle(s)},getPC:function(){return s},toggleH1:function(){return l=this.toggle(l)},getH1:function(){return l},switchColors:function(){},toggleSense:function(){return b=this.toggle(b),console.log(b),b},getSense:function(){return b}}}angular.module("TADkit").factory("Settings",r)}(),function(){"use strict";function r(r,e){var t=null,o=20;return{loadTAD:function(){var n=r.defer();return e.get("assets/json/tad-homo_sapiens.json").success(function(r){t=r,t.metadata.lengthBP=t.metadata.end-t.metadata.start,t.metadata.segments=o,console.log("TAD data retreived from file."),n.resolve(r)}),n.promise},setTAD:function(r){t=r},getTAD:function(){return t},getMetadata:function(){return t.metadata},getLengthBP:function(){return t.metadata.lengthBP},getSpecies:function(){var r=t.metadata.species;return r},getSpeciesUrl:function(){var r=t.metadata.species;return r=r.replace(/[^a-z0-9]/gi,"_").toLowerCase()},getVertices:function(){return t.vertices},getParticles:function(){for(var r,e=this.getVertices(),t=[],o=0,n=e.length;n>o;)r={},r.x=e[o++],r.y=e[o++],r.z=e[o++],t.push(r);return t},getParticlesCount:function(){var r=t.vertices.length/3;return r},getSegments:function(){var r=t.metadata.segments;return r},getSlice:function(){var r=t.metadata,e=r.chromosome+":"+r.start+"-"+r.end;return e},getColors:function(){for(var r=[],e=this.getParticlesCount(),o=this.getSegments(),n=0;e>n;n++)for(var g=0;o>g;g++)r.push(t.colors[n]?t.colors[n]:"#cccccc");return r}}}angular.module("TADkit").factory("TAD",r)}();