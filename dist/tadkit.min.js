!function(){"use strict";angular.module("TADkit",["ui.router","angularFileUpload","ngMaterial","flow","uuid4","d3"])}(),function(){"use strict";function e(e,t){t.theme("default").primaryPalette("green").accentPalette("grey").warnPalette("red").backgroundPalette("grey")}angular.module("TADkit").config(e)}(),function(){"use strict";function e(e){e.$on("$stateChangeError",function(e,t,r,n,o,a){console.log("Resolve Error: ",a)})}angular.module("TADkit").run(e)}(),function(){"use strict";function e(e,t){t.otherwise("/home"),e.state("home",{controller:"HomeController",url:"/home",views:{"":{templateUrl:"assets/templates/home.html",controller:"HomeController"},"topbar@home":{templateUrl:"assets/templates/topbar.html",controller:"TopbarController"},"sidebaruser@home":{templateUrl:"assets/templates/sidebar.user.html",controller:"SidebarUserController"}}}).state("main",{controller:"MainController","abstract":!0,url:"",templateUrl:"assets/templates/main.html",resolve:{initialData:function(e){return e()}}}).state("project",{parent:"main",url:"/project",views:{"topbar@main":{templateUrl:"assets/templates/topbar.html",controller:"TopbarController"},"sidebar-left@main":{templateUrl:"assets/templates/sidebar.project.html",controller:"SidebarProjectController"},"content@main":{templateUrl:"assets/templates/project-content.html",controller:"ProjectContentController"},"sidebar-right@main":{templateUrl:"assets/templates/sidebar.user.html",controller:"SidebarUserController"}}}).state("loader",{parent:"project",url:"/loader",views:{"topbar@main":{templateUrl:"assets/templates/topbar.html",controller:"TopbarController"},"content@main":{templateUrl:"assets/templates/project-loader.html",controller:"ProjectController"},"sidebar-right@main":{templateUrl:"assets/templates/sidebar.user.html",controller:"SidebarUserController"}}}).state("upload",{parent:"project",url:"/upload",views:{"topbar@main":{templateUrl:"assets/templates/topbar.html",controller:"TopbarController"},"content@main":{templateUrl:"assets/templates/project-upload.html",controller:"ProjectUploadController"},"sidebar-right@main":{templateUrl:"assets/templates/sidebar.user.html",controller:"SidebarUserController"}}}).state("dataset",{parent:"project",controller:"ProjectDatasetController",url:"/dataset",views:{"content@main":{templateUrl:"assets/templates/project-dataset.html",controller:"ProjectDatasetController"}}}).state("overlay",{parent:"project",controller:"ProjectOverlayController",url:"/overlay",views:{"content@main":{templateUrl:"assets/templates/project-overlay.html",controller:"ProjectOverlayController"}}}).state("storyboard",{parent:"project",controller:"ProjectStoryboardController",url:"/storyboard",views:{"content@main":{templateUrl:"assets/templates/project-storyboard.html",controller:"ProjectStoryboardController"}}}).state("browser",{parent:"project",url:"/browser",views:{"sidebar-left@main":{templateUrl:"assets/templates/sidebar.browser.html",controller:"SidebarBrowserController"},"content@main":{templateUrl:"assets/templates/storyboard.html",controller:"StoryboardController"}}}).state("overlay-acquire",{parent:"browser",url:"/overlay/acquire",views:{"modal@main":{templateUrl:"assets/templates/overlay-acquire.html",controller:"OverlayController"}}}).state("overlay-filter",{parent:"browser",url:"/overlay/filter",views:{"modal@main":{templateUrl:"assets/templates/overlay-filter.html",controller:"OverlayController"}}}).state("overlay-represent",{parent:"browser",url:"/overlay/represent",views:{"modal@main":{templateUrl:"assets/templates/overlay-represent.html",controller:"OverlayController"}}}).state("404",{url:"/404",templateUrl:"assets/templates/404.tpl.html",controller:"AppController"})}angular.module("TADkit").config(e)}(),function(){"use strict";function e(){}angular.module("TADkit").controller("ComponentController",e)}(),function(){"use strict";function e(e){return{restrict:"EA",link:function(t,r){var n="<data-tk-component-"+t.component.object.type+' id="{{component.object.id}}-'+t.$index+'" type="component.object.type" state="component.object.state" object="component.object" view="component.view" metadata="component.metadata" data="component.data" overlay="component.overlay" overlayindex="currentOverlays.current.index" contacts="component.contacts" settings="settings" style="margin: {{component.object.state.margin}}" class="component '+t.component.object.type+'"></data-tk-component-'+t.component.object.type+">";r.replaceWith(e(n)(t))}}}angular.module("TADkit").directive("tkComponent",e)}(),function(){"use strict";function e(e,t,r){e.includes("browser")&&(t.infobox=r.getDataset(),t.infobox.object.region=r.getRegion())}angular.module("TADkit").controller("PanelInfoboxController",e)}(),function(){"use strict";function e(){return{restrict:"C",templateUrl:"assets/templates/panel-infobox.html",link:function(){}}}angular.module("TADkit").directive("tkComponentPanelInfobox",e)}(),function(){"use strict";function e(e){e.optionsState=!1,e.toggleOptions=function(){e.optionsState=!e.optionsState},e.toggle=function(e){e=!e},e.width=parseInt(e.state.width),e.height=parseInt(e.state.height),e.atPosition=function(t){return e.$parent.settings.segmentUpper>=t.start&&e.$parent.settings.segmentLower<=t.end?!0:!1}}angular.module("TADkit").controller("PanelInspectorController",e)}(),function(){"use strict";function e(){return{restrict:"EA",scope:{id:"@",state:"=",view:"=",data:"=",settings:"="},templateUrl:"assets/templates/panel-inspector.html",link:function(){}}}angular.module("TADkit").directive("tkComponentPanelInspector",e)}(),function(){"use strict";function e(){return function(e,a,i){var s={visible:!0,genomeLength:816394,particles:0,particleSegments:5,curveSegments:1,radius:15,radiusSegments:16,endcap:!1,pathClosed:!1};i=i||{},angular.extend(this,angular.copy(s),i);for(var l=t(e),g=l.vertices.length-1;g>=0;g--){var c=new THREE.Color(a[20*g]);l.colors.unshift(c)}for(var d=r(l.vertices,this.pathClosed),u=new THREE.Geometry,g=0;g<d.vertices.length;g++){u.vertices.push(new THREE.Vector3(d.vertices[g].x,d.vertices[g].y,d.vertices[g].z||0));var c=d.colors[g];u.colors.push(c)}u.name="controlsGeom",0===this.particles&&(this.particles=l.vertices.length);var b=this.particles*this.particleSegments;this.pathSegments=b;var p=n(d.vertices,b,this.pathClosed);console.log(p);for(var m=p.createPointsGeometry(820),g=m.vertices.length-1;g>=0;g--){var c=new THREE.Color(a[g]);m.colors.unshift(c)}m.name="cubicGeom";var v=p.getLength(),f=15,h=11*this.genomeLength/1080;this.radius=v*f/h;for(var y=new THREE.Object3D,w=new THREE.Geometry,g=0;b>g;g++){this.endcap=0===g||g===b-1?!1:!0;var E=a[g],C=new THREE.MeshLambertMaterial({color:E,ambient:E,emissive:E,vertexColors:THREE.VertexColors,opacity:1,transparent:!1,wireframe:!1}),T=o(m.vertices[g],m.vertices[g+1],this);w.merge(T);var k=new THREE.Mesh(T,C);k.name="segment-"+g,y.add(k)}{var x=new THREE.LineBasicMaterial({color:"#ff0000",opacity:.5}),j=(new THREE.Line(u,x),new THREE.LineBasicMaterial({color:"#0000ff"})),R=(new THREE.Line(m,j),new THREE.PointCloudMaterial({vertexColors:THREE.VertexColors,size:10,opacity:1}));new THREE.PointCloud(u,R)}return w.computeBoundingSphere(),y.boundingSphere=w.boundingSphere,y.name="Chromatin Fiber",y}}function t(e){for(var t,r=0,n=new THREE.Geometry,o=e.length;o>r;)t=new THREE.Vector3,t.x=e[r++],t.y=e[r++],t.z=e[r++],n.vertices.push(t);return n.name="Chromatin Geometry",n}function r(e,t){t=t||!1;var r=1,n=e.length,o={};o.vertices=[],o.colors=[];for(var a=new THREE.Vector3(0,0,0),i=0;n>i;i++){var s=e[i],l=new THREE.Vector3(0,0,0);i==n-1?t?l=e[0]:l.copy(s).addVectors(s,e[i-1]):l=e[i+1];var g=new THREE.Vector3(0,0,0);g.addVectors(s,l).divideScalar(2);var c=new THREE.Vector3(0,0,0);if(c.copy(g).sub(s),0===i)if(t){var d=new THREE.Vector3(0,0,0);d.addVectors(e[n-1],e[0]).divideScalar(2),a.copy(d).sub(e[n-1])}else a.copy(c);var u=new THREE.Vector3(0,0,0);u.copy(s).sub(c);var b=new THREE.Vector3(0,0,0);b.copy(s).add(a);var p=new THREE.Vector3(0,0,0);p.subVectors(b,u).divideScalar(r),u.copy(s).sub(p),b.copy(s).add(p),o.vertices.push(u),o.colors.push(new THREE.Color(13421772)),o.vertices.push(s),o.colors.push(new THREE.Color(0)),o.vertices.push(b),o.colors.push(new THREE.Color(13421772)),a=c}var m=new THREE.Vector3(0,0,0),v=new THREE.Vector3(0,0,0),f=new THREE.Vector3(0,0,0),h=new THREE.Vector3(0,0,0),y=o.vertices.length,w=o.vertices[y-2],E=o.vertices[y-1],C=o.vertices[0],T=o.vertices[1];if(t){var k=new THREE.CubicBezierCurve3(w,E,C,T),x=k.getPointAt(.5),j=k.getTangent(.5).multiplyScalar(1);m.copy(x).sub(j),v.copy(x),f.copy(x).add(j),h.copy(x)}else m.copy(C),v.copy(C),f.copy(E),h.copy(E);return o.vertices.unshift(m),o.colors.unshift(new THREE.Color(16776960)),o.vertices.unshift(v),o.colors.unshift(new THREE.Color(16711680)),o.vertices.push(f),o.colors.push(new THREE.Color(65535)),o.vertices.push(h),o.colors.push(new THREE.Color(255)),o}function n(e,t,r){r=r||!1;for(var n=new THREE.CurvePath,o=e.length,a=0;o-1>a;a+=3){var i=e[a],s=e[a+1],l=e[a+2],g=e[a+3],c=new THREE.CubicBezierCurve3(i,s,l,g);n.add(c)}return n}function o(e,t,r){var n,o=(new THREE.Vector3).subVectors(t,e),a=new THREE.Matrix4;a.lookAt(e,t,(new THREE.Object3D).up);var i=new THREE.Matrix4;return i.set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),a.multiply(i),a.setPosition(e.add(t).multiplyScalar(.5)),n=new THREE.CylinderGeometry(r.radius,r.radius,o.length(),r.radiusSegments,r.curveSegments,r.endcap),n.applyMatrix(a),n}angular.module("TADkit").factory("Chromatin",e)}(),function(){"use strict";function e(e,t){return{restrict:"EA",scope:{id:"@",state:"=",view:"=",cluster:"=",overlay:"="},templateUrl:"assets/templates/scene-cluster-icon.html",link:function(r,n){{var o,a,i,s,l,g,c,d,u,b,p,m,v;new THREE.Color,new THREE.Color,new THREE.Color("#ffffff")}r.init=function(){i=n[0].children[0].children[0],m=parseInt(r.state.width),v=parseInt(r.state.height),o=window.WebGLRenderingContext?new THREE.WebGLRenderer({alpha:!0,antialias:!0}):new THREE.CanvasRenderer({alpha:!0}),o.setClearColor(16777215),o.setSize(m,v),o.setSize(m,v),i.appendChild(o.domElement),a=new THREE.Scene,s=new THREE.PerspectiveCamera(r.view.viewpoint.fov,m/v,r.view.viewpoint.near,r.view.viewpoint.far),s.position.fromArray(r.view.viewpoint.camera),s.name="Scene Camera",d=new THREE.OrbitControls(s,o.domElement),d.autoRotate=r.view.controls.autoRotate,d.autoRotateSpeed=r.view.controls.autoRotateSpeed,d.noZoom=!0,d.noRotate=!0,d.noPan=!0,d.noKeys=!0,u=new THREE.TrackballControls(s,o.domElement),u.noZoom=!0,u.noRotate=!0,u.noPan=!0,b=new e(r.cluster.data[r.cluster.centroidIndex],r.view.settings.particles),b.visible=r.view.settings.particles.visible,a.add(b),p=new t(r.cluster.data,r.cluster.centroidIndex,r.overlay,r.view.settings.cluster),p.visible=r.view.settings.cluster.visible,p.name=p.name+" "+r.id.match(/\d+/)[0],a.add(p),l=new THREE.Vector3,g=new THREE.Vector3(0,0,0),c=p.boundingSphere.radius*r.view.viewpoint.scale,r.lookAtTarget(l,g,c);c*r.view.viewpoint.fogNear,c*r.view.viewpoint.fogFar},r.lookAtTarget=function(e,t,r){e=e||new THREE.Vector3(5e4,5e4,5e4);var n=new THREE.Vector3(0,0,0);t=t||n,r=r||500,s.position.set(e.x,e.y,e.z),s.lookAt(n),s.translateZ(r),s.lookAt(t),s.updateMatrixWorld(),u.target.copy(e)},r.animate=function(){requestAnimationFrame(r.animate),d.update(),u.update(),r.render()},r.render=function(){o.render(a,s)},r.init(),r.animate()}}}angular.module("TADkit").directive("tkComponentSceneCluster",e)}(),function(){"use strict";function e(e){return function(r,n,o,a){var i={visible:!0};a=a||{},angular.extend(this,angular.copy(i),a);for(var s=new THREE.BufferGeometry,l=e.colorsFromHex(o),g=new THREE.Object3D,c=0;c<r.length;c++){var d=r[c];s.addAttribute("position",new THREE.BufferAttribute(d,3));var u=t(d);u.colors=l;var b=(o[c],new THREE.LineBasicMaterial({color:new THREE.Color(this.color),opacity:this.modelOpacity,transparent:this.transparent,linewidth:this.linewidth,fog:this.fog})),p=new THREE.LineBasicMaterial({opacity:this.centroidOpacity,transparent:this.transparent,linewidth:this.linewidth,vertexColors:THREE.VertexColors,fog:this.fog});c==n&&(b=p);var m=new THREE.Line(u,b);m.name="model-"+c,g.add(m)}return s.computeBoundingSphere(),g.boundingSphere=s.boundingSphere,g.BufferGeometryometry=s,g.name="Cluster Ensemble",g}}function t(e){for(var t,r=0,n=new THREE.Geometry,o=e.length;o>r;)t=new THREE.Vector3,t.x=e[r++],t.y=e[r++],t.z=e[r++],n.vertices.push(t);return n}angular.module("TADkit").factory("Cluster",e)}(),function(){"use strict";function e(){return function(e,t,r){var n={transparent:!0,visible:!1};r=r||{},angular.extend(this,angular.copy(n),r);var o,a=new THREE.BufferGeometry;a.addAttribute("position",new THREE.BufferAttribute(e,3)),a.addAttribute("color",new THREE.BufferAttribute(t,3)),a.computeBoundingSphere();var i=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,blending:THREE.AdditiveBlending,transparent:this.transparent});return o=new THREE.Line(a,i,THREE.LinePieces),o.name="Contacts",o}}angular.module("TADkit").factory("Contacts",e)}(),function(){"use strict";function e(){return{restrict:"EA",link:function(e,t){function r(){a=t[0],i=a.clientWidth,l=new THREE.Scene,s=new THREE.PerspectiveCamera(50,1,150,650),s.position.z=500,l.add(s),c=new THREE.TorusKnotGeometry(100,30,100,16),d=new THREE.MeshDepthMaterial({color:6710886,wireframe:!0,wireframeLinewidth:1}),u=new THREE.Mesh(c,d),u.name="Floating TAD",l.add(u),g=window.WebGLRenderingContext?new THREE.WebGLRenderer({alpha:!0}):new THREE.CanvasRenderer({alpha:!0}),g.setSize(i,i),a.appendChild(g.domElement),b=new THREE.TrackballControls(s,g.domElement),b.minDistance=450,b.maxDistance=550}function n(){requestAnimationFrame(n),b.update(),o()}function o(){u.rotation.x+=.006,u.rotation.y+=.006,g.render(l,s)}var a,i,s,l,g,c,d,u,b;r(),n()}}}angular.module("TADkit").directive("tkComponentSceneFloatingtad",e)}(),function(){"use strict";function e(){return function(e,r){var n={particles:0,visible:!0,color:"#ff0000",size:200,opacity:.8,map:"assets/img/sphere-glossy.png",depthtest:!0,alphatest:.5,transparent:!0};r=r||{},angular.extend(this,angular.copy(n),r);var o=t(e);o.computeBoundingSphere();for(var a=[],i=0;i<o.vertices.length;i++)a[i]=new THREE.Color("rgb(255,255,255)");o.colors=a;var s=null;this.map&&(s=THREE.ImageUtils.loadTexture(this.map));var l=new THREE.PointCloudMaterial({color:this.color,vertexColors:THREE.VertexColors,size:this.size,opacity:this.opacity,map:s,depthTest:this.depthtest,alphaTest:this.alphatest,transparent:this.transparent}),g=new THREE.PointCloud(o,l);return g.name="Particles Cloud",g}}function t(e){for(var t,r=0,n=new THREE.Geometry,o=e.length;o>r;)t=new THREE.Vector3,t.x=e[r++],t.y=e[r++],t.z=e[r++],n.vertices.push(t);return n.name="Particles Geometry",n}angular.module("TADkit").factory("Particles",e)}(),function(){"use strict";function e(){return{restrict:"EA",scope:{id:"@",type:"=",data:"=",view:"=",overlay:"=",state:"="},link:function(e,t){function r(){a=t[0],s=new THREE.Scene,i=new THREE.PerspectiveCamera(50,window.innerWidth/window.innerHeight,1,1e4),i.position.z=500,s.add(i);var r=200;g=new THREE.BoxGeometry(r,r,r);var n="#"+e.overlay;c=new THREE.MeshLambertMaterial({color:n,ambient:n,emissive:n,opacity:1,transparent:!1,wireframe:!1}),d=new THREE.Mesh(g,c),d.name="testmesh",s.add(d),l=window.WebGLRenderingContext?new THREE.WebGLRenderer({alpha:!0}):new THREE.CanvasRenderer({alpha:!0}),l.setSize(window.innerWidth,window.innerHeight),a.appendChild(l.domElement);var o=s.getObjectByName("testmesh");e.$watch("overlay",function(t,r){if(t!==r){var n=new THREE.Color("#"+e.overlay);o.material.color=n,o.material.ambient=n,o.material.emissive=n}})}function n(){requestAnimationFrame(n),o()}function o(){d.rotation.x+=.01,d.rotation.y+=.02,l.render(s,i)}var a,i,s,l,g,c,d;r(),n()}}}angular.module("TADkit").directive("tkComponentSceneThreetest",e)}(),function(){"use strict";function e(e){e.optionsState=!1,e.toggleOptions=function(){e.optionsState=!e.optionsState},e.toggle=function(e){e=!e}}angular.module("TADkit").controller("SceneController",e)}(),function(){"use strict";function e(e,t,r,n){return{restrict:"EA",scope:{id:"@",state:"=",view:"=",data:"=",overlay:"=",overlayindex:"=",contacts:"=",settings:"="},templateUrl:"assets/templates/scene.html",link:function(o,a){var i,s,l,g,c,d,u,b,p,m,v,f,h,y,w,E,C,T,k,x=new THREE.Color,j=new THREE.Color,R=new THREE.Color("rgb(0,0,0)");o.init=function(){s=a[0].children[0].children[3],y=parseInt(o.state.width),w=parseInt(o.state.height),m=window.WebGLRenderingContext?new THREE.WebGLRenderer({alpha:!0,antialias:!0}):new THREE.CanvasRenderer({alpha:!0}),m.setClearColor(16777215),m.setSize(y,w),m.autoClear=!1,s.appendChild(m.domElement),i=new THREE.Scene,l=new THREE.PerspectiveCamera(o.view.viewpoint.fov,y/w,o.view.viewpoint.near,o.view.viewpoint.far),l.position.fromArray(o.view.viewpoint.camera),l.name="Scene Camera",i.add(l),p=new THREE.TrackballControls(l,m.domElement),p.autoRotate=o.view.controls.autoRotate,p.autoRotateSpeed=o.view.controls.autoRotateSpeed;var E=new THREE.AxisHelper(o.view.settings.axis.size);E.visible=o.view.settings.axis.visible,E.name="Axis",i.add(E);var C=o.view.settings.lighting.ambient;u=new THREE.AmbientLight(C),u.name="Scene Ambient Light",v=new e(o.data,o.view.settings.particles),v.visible=o.view.settings.particles.visible,i.add(v),o.view.settings.particles.count=v.geometry.vertices.length,o.view.settings.chromatin.segments=o.view.settings.particles.count*o.view.settings.chromatin.particleSegments,o.view.settings.genomeLength=o.settings.currentEndCoord,f=new t(o.data,o.overlay.colors,o.view.settings.chromatin),f.visible=o.view.settings.chromatin.visible,i.add(f),h=new n(o.contacts.positions,o.contacts.distances,o.view.settings.contacts),h.visible=o.view.settings.contacts.visible,i.add(h),g=f.boundingSphere.center,c=f.boundingSphere.center,d=f.boundingSphere.radius*o.view.viewpoint.scale,o.lookAtTAD(g,c,d);var T=o.view.settings.lighting.color,k=o.view.settings.lighting.intensity;b=new THREE.PointLight(T,k),b.name="Scene Light",l.add(b);var H=.5*d;b.position.set(H,H,-1*H);var S=100,A=(new THREE.PointLightHelper(b,S),o.view.viewpoint.fogColor),D=d*o.view.viewpoint.fogNear,I=d*o.view.viewpoint.fogFar;o.view.viewpoint.fog&&(i.fog=new THREE.Fog(A,D,I)),o.$watch("view.controls.autoRotate",function(e,t){e!==t&&(p.autoRotate=!p.autoRotate)}),o.$watch("view.settings.axis.visible",function(e,t){e!==t&&(E.visible=!E.visible)}),o.$watch("view.settings.particles.visible",function(e,t){e!==t&&(v.visible=!v.visible)}),o.$watch("view.settings.chromatin.visible",function(e,t){e!==t&&(f.visible=!f.visible)}),o.$watch("view.settings.contacts.visible",function(e,t){e!==t&&(h.visible=!h.visible)});var O=i.getObjectByName("Particles Cloud"),P=i.getObjectByName("Chromatin Fiber");o.$watch("overlayindex",function(e,t){if(e!==t)for(var n=P.children.length,o=r.getOverlay(e),a=0;n>a;a++){var i=new THREE.Color(o.colors[a]);P.children[a].material.color=i,P.children[a].material.ambient=i,P.children[a].material.emissive=i}}),o.$watch("settings.position",function(e,t){if(e!==t){var r=t-o.view.viewpoint.startCoord,n=e-o.view.viewpoint.startCoord,a=o.view.viewpoint.endCoord-o.view.viewpoint.startCoord,i=Math.floor(r*(o.view.settings.particles.count-1)/a),s=Math.floor(n*(o.view.settings.particles.count-1)/a);x&&(O.geometry.colors[i]=x),x=O.geometry.colors[s],O.geometry.colors[s]=R,O.geometry.colorsNeedUpdate=!0;var l=Math.floor(r*(o.view.settings.chromatin.segments-1)/a),g=Math.floor(n*(o.view.settings.chromatin.segments-1)/a),c=P.getObjectByName("segment-"+l);j&&(c.material.color=j,c.material.ambient=j,c.material.emissive=j);var d=P.getObjectByName("segment-"+g);j=d.material.color,d.material.color=R,d.material.ambient=R,d.material.emissive=R}})},o.onWindowResize=function(){o.resizeCanvas()},o.resizeCanvas=function(){E=.66*s.parentNode.clientWidth,C=.66*E,T=E/2,k=C/2,l.aspect=E/C,l.updateProjectionMatrix(),m.setSize(E,C)},o.lookAtTAD=function(e,t,r){e=e||new THREE.Vector3(5e4,5e4,5e4);var n=new THREE.Vector3(0,0,0);t=t||n,r=r||500,l.position.set(e.x,e.y,e.z),l.lookAt(n),l.translateZ(r),l.lookAt(t),l.updateMatrixWorld(),p.target.copy(e)},o.animate=function(){requestAnimationFrame(o.animate),p.update(),o.render()},o.render=function(){m.render(i,l)},o.init(),o.animate()}}}angular.module("TADkit").directive("tkComponentScene",e)}(),function(){"use strict";function e(e){return{restrict:"EA",scope:{id:"@",object:"=",view:"=",data:"=",overlay:"=",settings:"="},templateUrl:"assets/templates/track.html",link:function(t){e.d3().then(function(){t.data;t.update=function(){}})}}}angular.module("TADkit").directive("tkComponentTrackContacts",e)}(),function(){"use strict";function e(e){return{restrict:"EA",scope:{id:"@",object:"=",view:"=",data:"=",overlay:"=",settings:"="},templateUrl:"assets/templates/track.html",link:function(t,r){e.d3().then(function(e){{var n=(t.data,32e8);t.id}t.settings.position||(t.settings.position=n/2);var o=t.view.viewpoint.startCoord,a=t.view.viewpoint.endCoord,i=a-o,s=1e3,l=n/i,g=.05*l;l-=2*g;var c,d,u,b,p,m,v=.5*i,f=.5*n,h=parseInt(t.object.state.margin),y={top:parseInt(t.object.state.padding.top),right:parseInt(t.object.state.padding.right),bottom:parseInt(t.object.state.padding.bottom),left:parseInt(t.object.state.padding.left)},w=parseInt(t.object.state.heightInner),E=10,C=r[0].parentNode,T=r[0].children[0].children[3],k=e.select(T).append("svg");t.$watch(function(){var e=C.clientWidth,t=C.clientHeight;return e+t},function(){t.render(t.data)}),t.$watch("data",function(e){t.render(e)},!0),t.$watch("settings.position",function(){t.update()},!0);e.behavior.zoom().on("zoom",function(){t.update()});t.render=function(r){if(k.selectAll("*").remove(),r){var n=C.clientWidth-2*h-y.left-y.right,i=w-y.top-y.bottom;m=e.scale.linear().range([0,n]).clamp(!0),m.domain([o,a]),u=e.svg.axis().scale(m).orient("top").ticks(0).outerTickSize(0);{var l=2;m(f)-m(v)}c=k.attr("width",n+y.left+y.right).attr("height",i+y.top+y.bottom).append("g").attr("transform","translate("+y.left+","+y.top+")"),d=c.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",n).attr("height",i).attr("fill","white"),b=c.append("g").attr("class","focus");{b.append("g").attr("class","zoom").append("rect").attr("width",n).attr("height",i).attr("fill","white")}p=b.append("g").attr("class","container").attr("clip-path","url(#clip)"),c.select(".focus").append("g").attr("class","x axis").attr("transform","translate(0,"+E+")").call(u);var g=c.append("g").attr("class","labels");g.append("text").attr("x",-18).attr("y",8).attr("text-anchor","right").style("font-size","10px").text("<<"),g.append("text").attr("x",-18).attr("y",18).attr("text-anchor","right").style("font-size","10px").text(">>");{p.selectAll("rect").data(r).enter().append("rect").attr("x",function(e){return Math.floor(m(e.start))}).attr("y",function(e){return t.view.settings.sense&&e.strand<1?E:0}).attr("width",function(e){return Math.ceil(m(e.end)-m(e.start))}).attr("height",function(){return t.view.settings.sense?E:2*E}).attr("class",function(e){var t=e.biotypeStyle;return t+=e.strand<1?" forward-strand":" reverse-strand"}).append("svg:title").text(function(e){return e.external_name}),c.append("rect").attr("id","highlight").attr("x",function(){return m(t.settings.position-.5*s)}).attr("y",0).attr("width",l).attr("height",w).attr("class","highlight-follow")}}},t.update=function(){k.select("g.x.axis").call(u),p.selectAll("rect").attr("x",function(e){return Math.floor(m(e.start))}).attr("y",function(e){return t.view.settings.sense&&e.strand<1?E:0}).attr("width",function(e){return Math.ceil(m(e.end)-m(e.start))}).attr("height",function(){return t.view.settings.sense?E:2*E}),k.select("#highlight").attr("x",function(){return m(t.settings.position-.5*s)})}})}}}angular.module("TADkit").directive("tkComponentTrackGenes",e)}(),function(){"use strict";function e(e){return{restrict:"EA",scope:{id:"@",object:"=",view:"=",settings:"="},templateUrl:"assets/templates/track.html",link:function(t,r){e.d3().then(function(e){t.safeApply=function(e){var t=this.$root.$$phase;"$apply"==t||"$digest"==t?e&&"function"==typeof e&&e():this.$apply(e)};var n,o,a,i,s,l,g,c,d,u=(t.data,t.view.viewpoint.startCoord),b=t.view.viewpoint.endCoord,p=t.view.settings.segments,m=parseInt(t.object.state.margin),v={top:parseInt(t.object.state.padding.top),right:parseInt(t.object.state.padding.right),bottom:parseInt(t.object.state.padding.bottom),left:parseInt(t.object.state.padding.left)},f=parseInt(t.object.state.heightInner),h=r[0],y=r[0].children[0].children[3],w=e.select(y).append("svg");t.$watch(function(){var e=h.clientWidth,t=h.clientHeight;return e+t},function(){t.render()}),t.render=function(){w.selectAll("*").remove();var r=h.clientWidth-2*m-v.left-v.right,y=f-v.bottom-v.top;o=e.scale.linear().range([0,r]).clamp(!0),o.domain([u,b]),g=e.svg.axis().scale(o).orient("bottom").ticks(4),a=e.svg.axis().orient("left"),i=e.svg.axis().orient("right");var E=p-1;s=Math.max(r/E,4),l=f,c=e.svg.brush().x(o).extent([0,0]).on("brush",t.brushed),n=w.attr("width",r+v.left+v.right).attr("height",y+v.top+v.bottom).append("g").attr("transform","translate("+v.left+", 0)");var C=n.append("g").attr("class","labels");C.append("text").attr("x",-16).attr("y",26).attr("text-anchor","right").style("font-size","10px").text("3'"),C.append("text").attr("x",r+8).attr("y",26).attr("text-anchor","left").style("font-size","10px").text("5'");n.append("g").attr("class","x axis").attr("transform","translate(0,"+y+")").call(g).select(".domain").select(function(){return this.parentNode.appendChild(this.cloneNode(!0))}).attr("class","halo");n.append("g").attr("class","slider").call(c),n.select(".background").attr("y",y/2).attr("height",y),d=n.append("circle").attr("class","handle").attr("cx",o(t.settings.position)-.5*s).attr("cy",y).attr("r",1.6*s),n.call(c.extent([t.settings.position,0])).call(c.event)},t.brushed=function(){var r=this;t.safeApply(function(){var n=c.extent()[0];e.event.sourceEvent&&(n=parseInt(o.invert(e.mouse(r)[0])),c.extent([n,n])),d.attr("cx",o(n)-.5*s),t.settings.position=n,t.settings.segmentLower=t.settings.position-5*t.settings.segment,t.settings.segmentUpper=t.settings.position+5*t.settings.segment})}})}}}angular.module("TADkit").directive("tkComponentTrackSlider",e)}(),function(){"use strict";function e(e){return{restrict:"EA",scope:{id:"@",object:"=",view:"=",data:"=",overlay:"=",settings:"="},templateUrl:"assets/templates/track.html",link:function(t,r){e.d3().then(function(e){var n,o,a,i,s,l,g,c=(t.data,t.id,t.view.settings.step),d=t.view.viewpoint.startCoord,u=t.view.viewpoint.endCoord,b=u-d,p=parseInt(t.object.state.margin),m={top:parseInt(t.object.state.padding.top),right:parseInt(t.object.state.padding.right),bottom:parseInt(t.object.state.padding.bottom),left:parseInt(t.object.state.padding.left)},v=parseInt(t.object.state.heightInner),f=.5*v,h=.5*(v-f),y=t.view.settings.color,w=r[0].parentNode,E=r[0].children[0].children[3],C=e.select(E).append("svg");t.$watch(function(){var e=w.clientWidth,t=w.clientHeight;return e+t},function(){t.render(t.data)}),t.$watch("data",function(e){t.render(e)},!0),t.$watch("settings.position",function(){t.update()},!0);e.behavior.zoom().on("zoom",function(){t.update()});t.render=function(r){if(C.selectAll("*").remove(),r){var E=w.clientWidth-2*p-m.left-m.right,T=v-m.top-m.bottom;n=c*E/b,g=e.scale.linear().range([0,E]).clamp(!0),g.domain([d,u]),i=e.svg.axis().scale(g).orient("top").ticks(0).outerTickSize(0);var k=2;o=C.attr("width",E+m.left+m.right).attr("height",T+m.top+m.bottom).append("g").attr("transform","translate("+m.left+","+m.top+")"),a=o.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",E).attr("height",T).attr("fill","white"),s=o.append("g").attr("class","focus");{s.append("g").attr("class","zoom").append("rect").attr("width",E).attr("height",T).attr("fill","white")}l=s.append("g").attr("class","container").attr("clip-path","url(#clip)");{o.append("g").attr("class","labels"),l.selectAll("rect").data(r).enter().append("rect").attr("x",function(e,t){return(t+1)*n}).attr("y",h).attr("width",n).attr("height",f).style("fill",y).style("fill-opacity",function(e){return e}).style("stroke",y).style("stroke-width",0).append("svg:title").text(function(e,t){return t+":"+e}),o.append("rect").attr("id","highlight").attr("x",function(){return g(t.settings.position-.5*c)}).attr("y",0).attr("width",k).attr("height",v).attr("class","highlight-follow")}}},t.update=function(){C.select("#highlight").attr("x",function(){return g(t.settings.position-.5*c)})}})}}}angular.module("TADkit").directive("tkComponentWiggle0",e)}(),function(){"use strict";function e(e,t){e.overlay&&(e.overlaid=e.overlay.object.state.overlaid,e.overlayOrig=t.getOverlay(),e.toggleOverlay=function(r){e.overlaid=t.getOverlay(r).object.state.overlaid,e.overlaid?(t.setOverlaid(e.overlayOrig.object.state.index),t.set(e.overlayOrig.object.state.index)):(t.setOverlaid(r),t.set(r)),e.overlaid=!e.overlaid}),e.optionsState=!1,e.toggleOptions=function(){e.optionsState=!e.optionsState}}angular.module("TADkit").controller("TrackController",e)}(),function(){"use strict";function e(e,t){console.log(t)}angular.module("TADkit").controller("BrowserController",e)}(),function(){"use strict";function e(){}angular.module("TADkit").controller("HomeController",e)}(),function(){"use strict";function e(e,t,r,n,o,a,i,s,l){t.settings||(t.settings=r.settings,t.settings.featureColors=r.featureColors,t.settings.components=r.components),t.settings.isProject=e.is("project"),t.$on("$stateChangeSuccess",function(){t.settings.isProject=e.is("project")}),t.users||(t.users=n.get(),"undefined"!=typeof t.users.loaded[0].projects&&0===t.users.loaded[0].projects.length&&(t.users.loaded[0].projects=o.get(),"undefined"!=typeof t.users.loaded[0].projects.loaded[0].datasets&&0===t.users.loaded[0].projects.loaded[0].datasets.length&&(t.users.loaded[0].projects.loaded[0].datasets=a.get()),"undefined"!=typeof t.users.loaded[0].projects.loaded[0].overlays&&0===t.users.loaded[0].projects.loaded[0].overlays.length&&(t.users.loaded[0].projects.loaded[0].overlays=i.get()),"undefined"!=typeof t.users.loaded[0].projects.loaded[0].storyboards&&0===t.users.loaded[0].projects.loaded[0].storyboards.length&&(t.users.loaded[0].projects.loaded[0].storyboards=s.get()))),t.projects=t.users.loaded[t.users.current.index].projects,t.datasets=t.projects.loaded[t.projects.current.index].datasets,t.overlays=t.projects.loaded[t.projects.current.index].overlays,t.storyboards=t.projects.loaded[t.projects.current.index].storyboards,t.currentUser=t.users.loaded[t.users.current.index],t.currentProject=t.projects.loaded[t.projects.current.index],t.currentDataset=t.datasets.loaded[t.datasets.current.index],t.currentCluster=t.currentDataset.clusters[t.datasets.current.cluster-1],t.currentCentroid=t.currentDataset.centroids[t.datasets.current.cluster-1],t.currentModel=t.currentDataset.models[t.currentDataset.centroids[t.datasets.current.cluster-1]-1],t.currentOverlay=t.overlays.loaded[t.overlays.current.index],t.currentStoryboard=t.storyboards.loaded[t.storyboards.current.index],t.settings.currentStartCoord=t.currentDataset.object.startCoord,t.settings.currentEndCoord=t.currentDataset.object.endCoord,t.settings.currentScale=1,s.setViewpoint(t.settings.currentStartCoord,t.settings.currentEndCoord,t.settings.currentScale),l.setViewpoint(t.settings.currentStartCoord,t.settings.currentEndCoord,t.settings.currentScale),t.addDataset=function(r){console.log("adding..."),a.addDataset(r),t.currentDataset=t.datasets.loaded[t.datasets.current.index],e.go("dataset")}}angular.module("TADkit").controller("MainController",e)}(),function(){"use strict";function e(){return{restrict:"A",scope:{tkOverlayImport:"&"},link:function(e,t){t.on("change",function(t){var r=new FileReader;r.onload=function(t){e.$apply(function(){e.tkOverlayImport({$fileContent:t.target.result})})},r.readAsText((t.srcElement||t.target).files[0])})}}}angular.module("TADkit").directive("tkOverlayImport",e)
}(),function(){"use strict";function e(t,r,n,o,a,i,s,l,g){r.$on("$viewContentLoaded",function(){function c(){console.log("showing dialog")}var d=angular.element(document.body),u="assets/templates/"+t.current.name+".html";n.show({parent:d,templateUrl:u,controller:e,locals:{overlays:r.$parent.overlays},onComplete:c}).then(function(e){var r=i.get(),n=[],c=[],d=r.loaded.length-1;angular.forEach(e,function(e){for(var t=s.getComponentByType(e.object.type),o=!1,i=angular.copy(t),l=r.loaded.length-1;l>=0;l--);if(!o){d++,e.object.state.index=d,e.object.state.overlaid=!1,n.push(e);var u=a.get();i.object.uuid=g.generate(),i.object.id=e.object.id,i.object.title=e.object.id,i.object.dataset=e.object.id,i.view.settings.step=e.object.step,i.view.settings.color=e.object.color,i.view.settings.segments=u.segmentsCount,i.view.viewpoint.startCoord=u.currentStartCoord,i.view.viewpoint.endCoord=u.currentEndCoord,i.view.viewpoint.scale=u.currentScale,i.view.viewtype=e.object.type+"-"+e.object.stepType,i.data=e.data,i.overlay=e,c.push(i)}}),r.loaded=r.loaded.concat(n);var u=a.get().startCoord,b=a.get().segmentsCount,p=a.get().segmentLength,m=a.get().featureTypes;i.segmentOverlays(u,b,p,m);for(var v=c.length-1;v>=0;v--)l.addComponent("default",c[v]);o.show(o.simple().content("Overlays ("+n.length+"/"+e.length+") added")),t.go("browser")},function(){o.show(o.simple().content("cancelled")),t.go("browser")})}),r.importOverlay=function(e){r.dataParsed=Papa.parse(e,{delimiter:" ",dynamicTyping:!0,fastMode:!0}),r.overlaysAcquired=i.aquire(r.dataParsed.data),console.log("Overlays acquired!")},r.hide=function(){n.hide(r.overlaysAcquired)},r.cancel=function(){n.cancel()}}angular.module("TADkit").controller("OverlayController",e)}(),function(){"use strict";function e(){}angular.module("TADkit").controller("ProjectContentController",e)}(),function(){"use strict";function e(e,t,r,n,o){t.clusterComponent=o.getComponentById("datasets-scene-icon");var a=n.getOverlayById("gradient"),i=t.currentModel.data.length/t.currentDataset.object.components,s=n.segmentGradientHCL(a.data,i);t.clusterComponent.overlay=s;for(var l=new THREE.BufferGeometry,g=t.currentDataset.models.length-1;g>=0;g--)l.addAttribute("position",new THREE.BufferAttribute(t.currentDataset.models[u],3));l.computeBoundingSphere(),t.clusterComponent.view.viewpoint.translate=l.boundingSphere.radius,t.clusters=[];for(var c=t.currentDataset.clusters,d=t.currentDataset.models,u=c.length-1;u>=0;u--){var b={};b.number=u+1,b.list=c[u],b.centroidIndex=b.list.indexOf(r.getCentroid(b.number)),b.data=[];for(var p=b.list.length-1;p>=0;p--){for(var m,v=d.length-1;v>=0;v--){var f=d[v];parseInt(f.ref)==b.list[p]&&(m=f.data)}m?b.data.unshift(m):console.log("Listed model not found!")}t.clusters.unshift(b)}t.selectCluster=function(n){t.clusterArray=r.setCluster(n+1),t.centroidRef=r.getCentroid(),console.log("Current Cluster: "+(n+1)+"(Centroid Model: "+t.centroidRef+")"),e.go("browser")}}angular.module("TADkit").controller("ProjectDatasetController",e)}(),function(){"use strict";function e(e){return{restrict:"A",scope:!1,link:function(t,r,n){var o=e(n.tkProjectLoader);r.on("change",function(e){var r=new FileReader;r.onload=function(e){console.log("Data Loaded"),t.$apply(function(){o(t,{$fileContent:e.target.result})})},r.readAsText((e.srcElement||e.target).files[0])})}}}angular.module("TADkit").directive("tkProjectLoader",e)}(),function(){"use strict";function e(){}angular.module("TADkit").controller("ProjectOverlayController",e)}(),function(){"use strict";function e(){}angular.module("TADkit").controller("ProjectStoryboardController",e)}(),function(){"use strict";function e(e,t){e.uploader=new t}angular.module("TADkit").controller("ProjectUploadController",e)}(),function(){"use strict";function e(e,t){e.addDataset=function(e){t.add(e)}}angular.module("TADkit").controller("ProjectController",e)}(),function(){"use strict";function e(e,t){e.toggleSetting=function(r){e.settings=t.toggle(r)}}angular.module("TADkit").controller("SidebarBrowserController",e)}(),function(){"use strict";function e(e,t,r,n){e.setCurrentDataset=function(e){t.set(e)},e.setCurrentOverlay=function(e){r.set(e)},e.setCurrentStoryboard=function(e){n.set(e)}}angular.module("TADkit").controller("SidebarProjectController",e)}(),function(){"use strict";function e(){}angular.module("TADkit").controller("SidebarUserController",e)}(),function(){"use strict";function e(e,t,r,n,o,a){angular.element(e).on("resize",function(){t.$apply()});var i=0,s=t.currentModel.length/t.currentDataset.object.components,l=t.currentStoryboard.components[i].view.settings.chromatin.particleSegments,g=t.currentDataset.object.startCoord,c=t.currentDataset.object.endCoord,d=t.currentStoryboard.components[i].view.settings.chromatin.segmentLength=t.currentDataset.object.resolution/l;t.settings.position=g+parseInt(.5*(c-g)),t.settings.segment=Math.floor((t.settings.position-g)/d),t.settings.segmentLower=t.settings.position-.5*t.settings.segment,t.settings.segmentUpper=t.settings.position+.5*t.settings.segment,t.currentModel=n.getModel(),t.currentOverlays=o.get(),t.proximityMatrix=a.getProximityMatrix(t.currentModel.data),angular.forEach(t.currentStoryboard.components,function(e){var r;"scene"==e.object.type?(e.data=t.currentModel.data,e.overlay=t.currentOverlays.loaded[t.currentOverlays.current.index],e.contacts=t.proximityMatrix,e.overlay.state={},e.overlay.object.state.index=t.currentOverlays.current.index):"track-slider"==e.object.type?e.view.viewpoint.segments=s*l:"track-genes"==e.object.type||"panel-inspector"==e.object.type?(r=o.getOverlayById("genes"),e.data=r.data,e.overlay=r):"track-contacts"==e.object.type?(e.data=t.proximityMatrix.positions,e.overlay=t.proximityMatrix.distances):"track-wiggle"==e.object.type&&(r=o.getOverlayById(e.object.dataset),e.data=r.data,e.overlay=r)})}angular.module("TADkit").controller("StoryboardController",e)}(),function(){"use strict";function e(){return{restrict:"EA",templateUrl:"assets/templates/storyboard-components.html",link:function(){}}}angular.module("TADkit").directive("tkStoryboard",e)}(),function(){"use strict";function e(e,t,r){t.$state=e,e.includes("main.project")&&(t.projectTitle=t.users[0].projects[0].object.title),t.toggleLeft=function(){r("left").toggle()},t.toggleRight=function(){r("right").toggle()}}angular.module("TADkit").controller("TopbarController",e)}(),function(){"use strict";function e(){var e=this;return e.re_={x11rgb:/^\s*rgb:([a-f0-9]{1,4})\/([a-f0-9]{1,4})\/([a-f0-9]{1,4})\s*$/i},e.colorNames={transparent:"rgb(0, 0, 0)",rust:"rgb(243, 137, 92)",stripes:"rgb(255, 54, 54)",dark_blue:"rgb(0, 0, 139)",contigblue1:"rgb(0, 0, 139)",contigblue2:"rgb(173, 216, 230)","border:grey70":"rgb(179, 179, 179)",aliceblue:"rgb(240, 248, 255)",antiquewhite:"rgb(250, 235, 215)",antiquewhite1:"rgb(255, 239, 219)",antiquewhite2:"rgb(238, 223, 204)",antiquewhite3:"rgb(205, 192, 176)",antiquewhite4:"rgb(139, 131, 120)",aquamarine:"rgb(127, 255, 212)",aquamarine1:"rgb(127, 255, 212)",aquamarine2:"rgb(118, 238, 198)",aquamarine3:"rgb(102, 205, 170)",aquamarine4:"rgb(69, 139, 116)",azure:"rgb(240, 255, 255)",azure1:"rgb(240, 255, 255)",azure2:"rgb(224, 238, 238)",azure3:"rgb(193, 205, 205)",azure4:"rgb(131, 139, 139)",beige:"rgb(245, 245, 220)",bisque:"rgb(255, 228, 196)",bisque1:"rgb(255, 228, 196)",bisque2:"rgb(238, 213, 183)",bisque3:"rgb(205, 183, 158)",bisque4:"rgb(139, 125, 107)",black:"rgb(0, 0, 0)",blanchedalmond:"rgb(255, 235, 205)",blue:"rgb(0, 0, 255)",blue1:"rgb(0, 0, 255)",blue2:"rgb(0, 0, 238)",blue3:"rgb(0, 0, 205)",blue4:"rgb(0, 0, 139)",blueviolet:"rgb(138, 43, 226)",brown:"rgb(165, 42, 42)",brown1:"rgb(255, 64, 64)",brown2:"rgb(238, 59, 59)",brown3:"rgb(205, 51, 51)",brown4:"rgb(139, 35, 35)",burlywood:"rgb(222, 184, 135)",burlywood1:"rgb(255, 211, 155)",burlywood2:"rgb(238, 197, 145)",burlywood3:"rgb(205, 170, 125)",burlywood4:"rgb(139, 115, 85)",cadetblue:"rgb(95, 158, 160)",cadetblue1:"rgb(152, 245, 255)",cadetblue2:"rgb(142, 229, 238)",cadetblue3:"rgb(122, 197, 205)",cadetblue4:"rgb(83, 134, 139)",chartreuse:"rgb(127, 255, 0)",chartreuse1:"rgb(127, 255, 0)",chartreuse2:"rgb(118, 238, 0)",chartreuse3:"rgb(102, 205, 0)",chartreuse4:"rgb(69, 139, 0)",chocolate:"rgb(210, 105, 30)",chocolate1:"rgb(255, 127, 36)",chocolate2:"rgb(238, 118, 33)",chocolate3:"rgb(205, 102, 29)",chocolate4:"rgb(139, 69, 19)",coral:"rgb(255, 127, 80)",coral1:"rgb(255, 114, 86)",coral2:"rgb(238, 106, 80)",coral3:"rgb(205, 91, 69)",coral4:"rgb(139, 62, 47)",cornflowerblue:"rgb(100, 149, 237)",cornsilk:"rgb(255, 248, 220)",cornsilk1:"rgb(255, 248, 220)",cornsilk2:"rgb(238, 232, 205)",cornsilk3:"rgb(205, 200, 177)",cornsilk4:"rgb(139, 136, 120)",cyan:"rgb(0, 255, 255)",cyan1:"rgb(0, 255, 255)",cyan2:"rgb(0, 238, 238)",cyan3:"rgb(0, 205, 205)",cyan4:"rgb(0, 139, 139)",darkblue:"rgb(0, 0, 139)",darkcyan:"rgb(0, 139, 139)",darkgoldenrod:"rgb(184, 134, 11)",darkgoldenrod1:"rgb(255, 185, 15)",darkgoldenrod2:"rgb(238, 173, 14)",darkgoldenrod3:"rgb(205, 149, 12)",darkgoldenrod4:"rgb(139, 101, 8)",darkgray:"rgb(169, 169, 169)",darkgreen:"rgb(0, 100, 0)",darkgrey:"rgb(169, 169, 169)",darkkhaki:"rgb(189, 183, 107)",darkmagenta:"rgb(139, 0, 139)",darkolivegreen:"rgb(85, 107, 47)",darkolivegreen1:"rgb(202, 255, 112)",darkolivegreen2:"rgb(188, 238, 104)",darkolivegreen3:"rgb(162, 205, 90)",darkolivegreen4:"rgb(110, 139, 61)",darkorange:"rgb(255, 140, 0)",darkorange1:"rgb(255, 127, 0)",darkorange2:"rgb(238, 118, 0)",darkorange3:"rgb(205, 102, 0)",darkorange4:"rgb(139, 69, 0)",darkorchid:"rgb(153, 50, 204)",darkorchid1:"rgb(191, 62, 255)",darkorchid2:"rgb(178, 58, 238)",darkorchid3:"rgb(154, 50, 205)",darkorchid4:"rgb(104, 34, 139)",darkred:"rgb(139, 0, 0)",darksalmon:"rgb(233, 150, 122)",darkseagreen:"rgb(143, 188, 143)",darkseagreen1:"rgb(193, 255, 193)",darkseagreen2:"rgb(180, 238, 180)",darkseagreen3:"rgb(155, 205, 155)",darkseagreen4:"rgb(105, 139, 105)",darkslateblue:"rgb(72, 61, 139)",darkslategray:"rgb(47, 79, 79)",darkslategray1:"rgb(151, 255, 255)",darkslategray2:"rgb(141, 238, 238)",darkslategray3:"rgb(121, 205, 205)",darkslategray4:"rgb(82, 139, 139)",darkslategrey:"rgb(47, 79, 79)",darkturquoise:"rgb(0, 206, 209)",darkviolet:"rgb(148, 0, 211)",debianred:"rgb(215, 7, 81)",deeppink:"rgb(255, 20, 147)",deeppink1:"rgb(255, 20, 147)",deeppink2:"rgb(238, 18, 137)",deeppink3:"rgb(205, 16, 118)",deeppink4:"rgb(139, 10, 80)",deepskyblue:"rgb(0, 191, 255)",deepskyblue1:"rgb(0, 191, 255)",deepskyblue2:"rgb(0, 178, 238)",deepskyblue3:"rgb(0, 154, 205)",deepskyblue4:"rgb(0, 104, 139)",dimgray:"rgb(105, 105, 105)",dimgrey:"rgb(105, 105, 105)",dodgerblue:"rgb(30, 144, 255)",dodgerblue1:"rgb(30, 144, 255)",dodgerblue2:"rgb(28, 134, 238)",dodgerblue3:"rgb(24, 116, 205)",dodgerblue4:"rgb(16, 78, 139)",firebrick:"rgb(178, 34, 34)",firebrick1:"rgb(255, 48, 48)",firebrick2:"rgb(238, 44, 44)",firebrick3:"rgb(205, 38, 38)",firebrick4:"rgb(139, 26, 26)",floralwhite:"rgb(255, 250, 240)",forestgreen:"rgb(34, 139, 34)",gainsboro:"rgb(220, 220, 220)",ghostwhite:"rgb(248, 248, 255)",gold:"rgb(255, 215, 0)",gold1:"rgb(255, 215, 0)",gold2:"rgb(238, 201, 0)",gold3:"rgb(205, 173, 0)",gold4:"rgb(139, 117, 0)",goldenrod:"rgb(218, 165, 32)",goldenrod1:"rgb(255, 193, 37)",goldenrod2:"rgb(238, 180, 34)",goldenrod3:"rgb(205, 155, 29)",goldenrod4:"rgb(139, 105, 20)",gray:"rgb(190, 190, 190)",gray0:"rgb(0, 0, 0)",gray1:"rgb(3, 3, 3)",gray10:"rgb(26, 26, 26)",gray100:"rgb(255, 255, 255)",gray11:"rgb(28, 28, 28)",gray12:"rgb(31, 31, 31)",gray13:"rgb(33, 33, 33)",gray14:"rgb(36, 36, 36)",gray15:"rgb(38, 38, 38)",gray16:"rgb(41, 41, 41)",gray17:"rgb(43, 43, 43)",gray18:"rgb(46, 46, 46)",gray19:"rgb(48, 48, 48)",gray2:"rgb(5, 5, 5)",gray20:"rgb(51, 51, 51)",gray21:"rgb(54, 54, 54)",gray22:"rgb(56, 56, 56)",gray23:"rgb(59, 59, 59)",gray24:"rgb(61, 61, 61)",gray25:"rgb(64, 64, 64)",gray26:"rgb(66, 66, 66)",gray27:"rgb(69, 69, 69)",gray28:"rgb(71, 71, 71)",gray29:"rgb(74, 74, 74)",gray3:"rgb(8, 8, 8)",gray30:"rgb(77, 77, 77)",gray31:"rgb(79, 79, 79)",gray32:"rgb(82, 82, 82)",gray33:"rgb(84, 84, 84)",gray34:"rgb(87, 87, 87)",gray35:"rgb(89, 89, 89)",gray36:"rgb(92, 92, 92)",gray37:"rgb(94, 94, 94)",gray38:"rgb(97, 97, 97)",gray39:"rgb(99, 99, 99)",gray4:"rgb(10, 10, 10)",gray40:"rgb(102, 102, 102)",gray41:"rgb(105, 105, 105)",gray42:"rgb(107, 107, 107)",gray43:"rgb(110, 110, 110)",gray44:"rgb(112, 112, 112)",gray45:"rgb(115, 115, 115)",gray46:"rgb(117, 117, 117)",gray47:"rgb(120, 120, 120)",gray48:"rgb(122, 122, 122)",gray49:"rgb(125, 125, 125)",gray5:"rgb(13, 13, 13)",gray50:"rgb(127, 127, 127)",gray51:"rgb(130, 130, 130)",gray52:"rgb(133, 133, 133)",gray53:"rgb(135, 135, 135)",gray54:"rgb(138, 138, 138)",gray55:"rgb(140, 140, 140)",gray56:"rgb(143, 143, 143)",gray57:"rgb(145, 145, 145)",gray58:"rgb(148, 148, 148)",gray59:"rgb(150, 150, 150)",gray6:"rgb(15, 15, 15)",gray60:"rgb(153, 153, 153)",gray61:"rgb(156, 156, 156)",gray62:"rgb(158, 158, 158)",gray63:"rgb(161, 161, 161)",gray64:"rgb(163, 163, 163)",gray65:"rgb(166, 166, 166)",gray66:"rgb(168, 168, 168)",gray67:"rgb(171, 171, 171)",gray68:"rgb(173, 173, 173)",gray69:"rgb(176, 176, 176)",gray7:"rgb(18, 18, 18)",gray70:"rgb(179, 179, 179)",gray71:"rgb(181, 181, 181)",gray72:"rgb(184, 184, 184)",gray73:"rgb(186, 186, 186)",gray74:"rgb(189, 189, 189)",gray75:"rgb(191, 191, 191)",gray76:"rgb(194, 194, 194)",gray77:"rgb(196, 196, 196)",gray78:"rgb(199, 199, 199)",gray79:"rgb(201, 201, 201)",gray8:"rgb(20, 20, 20)",gray80:"rgb(204, 204, 204)",gray81:"rgb(207, 207, 207)",gray82:"rgb(209, 209, 209)",gray83:"rgb(212, 212, 212)",gray84:"rgb(214, 214, 214)",gray85:"rgb(217, 217, 217)",gray86:"rgb(219, 219, 219)",gray87:"rgb(222, 222, 222)",gray88:"rgb(224, 224, 224)",gray89:"rgb(227, 227, 227)",gray9:"rgb(23, 23, 23)",gray90:"rgb(229, 229, 229)",gray91:"rgb(232, 232, 232)",gray92:"rgb(235, 235, 235)",gray93:"rgb(237, 237, 237)",gray94:"rgb(240, 240, 240)",gray95:"rgb(242, 242, 242)",gray96:"rgb(245, 245, 245)",gray97:"rgb(247, 247, 247)",gray98:"rgb(250, 250, 250)",gray99:"rgb(252, 252, 252)",green:"rgb(0, 255, 0)",green1:"rgb(0, 255, 0)",green2:"rgb(0, 238, 0)",green3:"rgb(0, 205, 0)",green4:"rgb(0, 139, 0)",greenyellow:"rgb(173, 255, 47)",grey:"rgb(190, 190, 190)",grey0:"rgb(0, 0, 0)",grey1:"rgb(3, 3, 3)",grey10:"rgb(26, 26, 26)",grey100:"rgb(255, 255, 255)",grey11:"rgb(28, 28, 28)",grey12:"rgb(31, 31, 31)",grey13:"rgb(33, 33, 33)",grey14:"rgb(36, 36, 36)",grey15:"rgb(38, 38, 38)",grey16:"rgb(41, 41, 41)",grey17:"rgb(43, 43, 43)",grey18:"rgb(46, 46, 46)",grey19:"rgb(48, 48, 48)",grey2:"rgb(5, 5, 5)",grey20:"rgb(51, 51, 51)",grey21:"rgb(54, 54, 54)",grey22:"rgb(56, 56, 56)",grey23:"rgb(59, 59, 59)",grey24:"rgb(61, 61, 61)",grey25:"rgb(64, 64, 64)",grey26:"rgb(66, 66, 66)",grey27:"rgb(69, 69, 69)",grey28:"rgb(71, 71, 71)",grey29:"rgb(74, 74, 74)",grey3:"rgb(8, 8, 8)",grey30:"rgb(77, 77, 77)",grey31:"rgb(79, 79, 79)",grey32:"rgb(82, 82, 82)",grey33:"rgb(84, 84, 84)",grey34:"rgb(87, 87, 87)",grey35:"rgb(89, 89, 89)",grey36:"rgb(92, 92, 92)",grey37:"rgb(94, 94, 94)",grey38:"rgb(97, 97, 97)",grey39:"rgb(99, 99, 99)",grey4:"rgb(10, 10, 10)",grey40:"rgb(102, 102, 102)",grey41:"rgb(105, 105, 105)",grey42:"rgb(107, 107, 107)",grey43:"rgb(110, 110, 110)",grey44:"rgb(112, 112, 112)",grey45:"rgb(115, 115, 115)",grey46:"rgb(117, 117, 117)",grey47:"rgb(120, 120, 120)",grey48:"rgb(122, 122, 122)",grey49:"rgb(125, 125, 125)",grey5:"rgb(13, 13, 13)",grey50:"rgb(127, 127, 127)",grey51:"rgb(130, 130, 130)",grey52:"rgb(133, 133, 133)",grey53:"rgb(135, 135, 135)",grey54:"rgb(138, 138, 138)",grey55:"rgb(140, 140, 140)",grey56:"rgb(143, 143, 143)",grey57:"rgb(145, 145, 145)",grey58:"rgb(148, 148, 148)",grey59:"rgb(150, 150, 150)",grey6:"rgb(15, 15, 15)",grey60:"rgb(153, 153, 153)",grey61:"rgb(156, 156, 156)",grey62:"rgb(158, 158, 158)",grey63:"rgb(161, 161, 161)",grey64:"rgb(163, 163, 163)",grey65:"rgb(166, 166, 166)",grey66:"rgb(168, 168, 168)",grey67:"rgb(171, 171, 171)",grey68:"rgb(173, 173, 173)",grey69:"rgb(176, 176, 176)",grey7:"rgb(18, 18, 18)",grey70:"rgb(179, 179, 179)",grey71:"rgb(181, 181, 181)",grey72:"rgb(184, 184, 184)",grey73:"rgb(186, 186, 186)",grey74:"rgb(189, 189, 189)",grey75:"rgb(191, 191, 191)",grey76:"rgb(194, 194, 194)",grey77:"rgb(196, 196, 196)",grey78:"rgb(199, 199, 199)",grey79:"rgb(201, 201, 201)",grey8:"rgb(20, 20, 20)",grey80:"rgb(204, 204, 204)",grey81:"rgb(207, 207, 207)",grey82:"rgb(209, 209, 209)",grey83:"rgb(212, 212, 212)",grey84:"rgb(214, 214, 214)",grey85:"rgb(217, 217, 217)",grey86:"rgb(219, 219, 219)",grey87:"rgb(222, 222, 222)",grey88:"rgb(224, 224, 224)",grey89:"rgb(227, 227, 227)",grey9:"rgb(23, 23, 23)",grey90:"rgb(229, 229, 229)",grey91:"rgb(232, 232, 232)",grey92:"rgb(235, 235, 235)",grey93:"rgb(237, 237, 237)",grey94:"rgb(240, 240, 240)",grey95:"rgb(242, 242, 242)",grey96:"rgb(245, 245, 245)",grey97:"rgb(247, 247, 247)",grey98:"rgb(250, 250, 250)",grey99:"rgb(252, 252, 252)",honeydew:"rgb(240, 255, 240)",honeydew1:"rgb(240, 255, 240)",honeydew2:"rgb(224, 238, 224)",honeydew3:"rgb(193, 205, 193)",honeydew4:"rgb(131, 139, 131)",hotpink:"rgb(255, 105, 180)",hotpink1:"rgb(255, 110, 180)",hotpink2:"rgb(238, 106, 167)",hotpink3:"rgb(205, 96, 144)",hotpink4:"rgb(139, 58, 98)",indianred:"rgb(205, 92, 92)",indianred1:"rgb(255, 106, 106)",indianred2:"rgb(238, 99, 99)",indianred3:"rgb(205, 85, 85)",indianred4:"rgb(139, 58, 58)",ivory:"rgb(255, 255, 240)",ivory1:"rgb(255, 255, 240)",ivory2:"rgb(238, 238, 224)",ivory3:"rgb(205, 205, 193)",ivory4:"rgb(139, 139, 131)",khaki:"rgb(240, 230, 140)",khaki1:"rgb(255, 246, 143)",khaki2:"rgb(238, 230, 133)",khaki3:"rgb(205, 198, 115)",khaki4:"rgb(139, 134, 78)",lavender:"rgb(230, 230, 250)",lavenderblush:"rgb(255, 240, 245)",lavenderblush1:"rgb(255, 240, 245)",lavenderblush2:"rgb(238, 224, 229)",lavenderblush3:"rgb(205, 193, 197)",lavenderblush4:"rgb(139, 131, 134)",lawngreen:"rgb(124, 252, 0)",lemonchiffon:"rgb(255, 250, 205)",lemonchiffon1:"rgb(255, 250, 205)",lemonchiffon2:"rgb(238, 233, 191)",lemonchiffon3:"rgb(205, 201, 165)",lemonchiffon4:"rgb(139, 137, 112)",lightblue:"rgb(173, 216, 230)",lightblue1:"rgb(191, 239, 255)",lightblue2:"rgb(178, 223, 238)",lightblue3:"rgb(154, 192, 205)",lightblue4:"rgb(104, 131, 139)",lightcoral:"rgb(240, 128, 128)",lightcyan:"rgb(224, 255, 255)",lightcyan1:"rgb(224, 255, 255)",lightcyan2:"rgb(209, 238, 238)",lightcyan3:"rgb(180, 205, 205)",lightcyan4:"rgb(122, 139, 139)",lightgoldenrod:"rgb(238, 221, 130)",lightgoldenrod1:"rgb(255, 236, 139)",lightgoldenrod2:"rgb(238, 220, 130)",lightgoldenrod3:"rgb(205, 190, 112)",lightgoldenrod4:"rgb(139, 129, 76)",lightgoldenrodyellow:"rgb(250, 250, 210)",lightgray:"rgb(211, 211, 211)",lightgreen:"rgb(144, 238, 144)",lightgrey:"rgb(211, 211, 211)",lightpink:"rgb(255, 182, 193)",lightpink1:"rgb(255, 174, 185)",lightpink2:"rgb(238, 162, 173)",lightpink3:"rgb(205, 140, 149)",lightpink4:"rgb(139, 95, 101)",lightsalmon:"rgb(255, 160, 122)",lightsalmon1:"rgb(255, 160, 122)",lightsalmon2:"rgb(238, 149, 114)",lightsalmon3:"rgb(205, 129, 98)",lightsalmon4:"rgb(139, 87, 66)",lightseagreen:"rgb(32, 178, 170)",lightskyblue:"rgb(135, 206, 250)",lightskyblue1:"rgb(176, 226, 255)",lightskyblue2:"rgb(164, 211, 238)",lightskyblue3:"rgb(141, 182, 205)",lightskyblue4:"rgb(96, 123, 139)",lightslateblue:"rgb(132, 112, 255)",lightslategray:"rgb(119, 136, 153)",lightslategrey:"rgb(119, 136, 153)",lightsteelblue:"rgb(176, 196, 222)",lightsteelblue1:"rgb(202, 225, 255)",lightsteelblue2:"rgb(188, 210, 238)",lightsteelblue3:"rgb(162, 181, 205)",lightsteelblue4:"rgb(110, 123, 139)",lightyellow:"rgb(255, 255, 224)",lightyellow1:"rgb(255, 255, 224)",lightyellow2:"rgb(238, 238, 209)",lightyellow3:"rgb(205, 205, 180)",lightyellow4:"rgb(139, 139, 122)",limegreen:"rgb(50, 205, 50)",linen:"rgb(250, 240, 230)",magenta:"rgb(255, 0, 255)",magenta1:"rgb(255, 0, 255)",magenta2:"rgb(238, 0, 238)",magenta3:"rgb(205, 0, 205)",magenta4:"rgb(139, 0, 139)",maroon:"rgb(176, 48, 96)",maroon1:"rgb(255, 52, 179)",maroon2:"rgb(238, 48, 167)",maroon3:"rgb(205, 41, 144)",maroon4:"rgb(139, 28, 98)",mediumaquamarine:"rgb(102, 205, 170)",mediumblue:"rgb(0, 0, 205)",mediumorchid:"rgb(186, 85, 211)",mediumorchid1:"rgb(224, 102, 255)",mediumorchid2:"rgb(209, 95, 238)",mediumorchid3:"rgb(180, 82, 205)",mediumorchid4:"rgb(122, 55, 139)",mediumpurple:"rgb(147, 112, 219)",mediumpurple1:"rgb(171, 130, 255)",mediumpurple2:"rgb(159, 121, 238)",mediumpurple3:"rgb(137, 104, 205)",mediumpurple4:"rgb(93, 71, 139)",mediumseagreen:"rgb(60, 179, 113)",mediumslateblue:"rgb(123, 104, 238)",mediumspringgreen:"rgb(0, 250, 154)",mediumturquoise:"rgb(72, 209, 204)",mediumvioletred:"rgb(199, 21, 133)",midnightblue:"rgb(25, 25, 112)",mintcream:"rgb(245, 255, 250)",mistyrose:"rgb(255, 228, 225)",mistyrose1:"rgb(255, 228, 225)",mistyrose2:"rgb(238, 213, 210)",mistyrose3:"rgb(205, 183, 181)",mistyrose4:"rgb(139, 125, 123)",moccasin:"rgb(255, 228, 181)",navajowhite:"rgb(255, 222, 173)",navajowhite1:"rgb(255, 222, 173)",navajowhite2:"rgb(238, 207, 161)",navajowhite3:"rgb(205, 179, 139)",navajowhite4:"rgb(139, 121, 94)",navy:"rgb(0, 0, 128)",navyblue:"rgb(0, 0, 128)",oldlace:"rgb(253, 245, 230)",olivedrab:"rgb(107, 142, 35)",olivedrab1:"rgb(192, 255, 62)",olivedrab2:"rgb(179, 238, 58)",olivedrab3:"rgb(154, 205, 50)",olivedrab4:"rgb(105, 139, 34)",orange:"rgb(255, 165, 0)",orange1:"rgb(255, 165, 0)",orange2:"rgb(238, 154, 0)",orange3:"rgb(205, 133, 0)",orange4:"rgb(139, 90, 0)",orangered:"rgb(255, 69, 0)",orangered1:"rgb(255, 69, 0)",orangered2:"rgb(238, 64, 0)",orangered3:"rgb(205, 55, 0)",orangered4:"rgb(139, 37, 0)",orchid:"rgb(218, 112, 214)",orchid1:"rgb(255, 131, 250)",orchid2:"rgb(238, 122, 233)",orchid3:"rgb(205, 105, 201)",orchid4:"rgb(139, 71, 137)",palegoldenrod:"rgb(238, 232, 170)",palegreen:"rgb(152, 251, 152)",palegreen1:"rgb(154, 255, 154)",palegreen2:"rgb(144, 238, 144)",palegreen3:"rgb(124, 205, 124)",palegreen4:"rgb(84, 139, 84)",paleturquoise:"rgb(175, 238, 238)",paleturquoise1:"rgb(187, 255, 255)",paleturquoise2:"rgb(174, 238, 238)",paleturquoise3:"rgb(150, 205, 205)",paleturquoise4:"rgb(102, 139, 139)",palevioletred:"rgb(219, 112, 147)",palevioletred1:"rgb(255, 130, 171)",palevioletred2:"rgb(238, 121, 159)",palevioletred3:"rgb(205, 104, 137)",palevioletred4:"rgb(139, 71, 93)",papayawhip:"rgb(255, 239, 213)",peachpuff:"rgb(255, 218, 185)",peachpuff1:"rgb(255, 218, 185)",peachpuff2:"rgb(238, 203, 173)",peachpuff3:"rgb(205, 175, 149)",peachpuff4:"rgb(139, 119, 101)",peru:"rgb(205, 133, 63)",pink:"rgb(255, 192, 203)",pink1:"rgb(255, 181, 197)",pink2:"rgb(238, 169, 184)",pink3:"rgb(205, 145, 158)",pink4:"rgb(139, 99, 108)",plum:"rgb(221, 160, 221)",plum1:"rgb(255, 187, 255)",plum2:"rgb(238, 174, 238)",plum3:"rgb(205, 150, 205)",plum4:"rgb(139, 102, 139)",powderblue:"rgb(176, 224, 230)",purple:"rgb(160, 32, 240)",purple1:"rgb(155, 48, 255)",purple2:"rgb(145, 44, 238)",purple3:"rgb(125, 38, 205)",purple4:"rgb(85, 26, 139)",red:"rgb(255, 0, 0)",red1:"rgb(255, 0, 0)",red2:"rgb(238, 0, 0)",red3:"rgb(205, 0, 0)",red4:"rgb(139, 0, 0)",rosybrown:"rgb(188, 143, 143)",rosybrown1:"rgb(255, 193, 193)",rosybrown2:"rgb(238, 180, 180)",rosybrown3:"rgb(205, 155, 155)",rosybrown4:"rgb(139, 105, 105)",royalblue:"rgb(65, 105, 225)",royalblue1:"rgb(72, 118, 255)",royalblue2:"rgb(67, 110, 238)",royalblue3:"rgb(58, 95, 205)",royalblue4:"rgb(39, 64, 139)",saddlebrown:"rgb(139, 69, 19)",salmon:"rgb(250, 128, 114)",salmon1:"rgb(255, 140, 105)",salmon2:"rgb(238, 130, 98)",salmon3:"rgb(205, 112, 84)",salmon4:"rgb(139, 76, 57)",sandybrown:"rgb(244, 164, 96)",seagreen:"rgb(46, 139, 87)",seagreen1:"rgb(84, 255, 159)",seagreen2:"rgb(78, 238, 148)",seagreen3:"rgb(67, 205, 128)",seagreen4:"rgb(46, 139, 87)",seashell:"rgb(255, 245, 238)",seashell1:"rgb(255, 245, 238)",seashell2:"rgb(238, 229, 222)",seashell3:"rgb(205, 197, 191)",seashell4:"rgb(139, 134, 130)",sienna:"rgb(160, 82, 45)",sienna1:"rgb(255, 130, 71)",sienna2:"rgb(238, 121, 66)",sienna3:"rgb(205, 104, 57)",sienna4:"rgb(139, 71, 38)",skyblue:"rgb(135, 206, 235)",skyblue1:"rgb(135, 206, 255)",skyblue2:"rgb(126, 192, 238)",skyblue3:"rgb(108, 166, 205)",skyblue4:"rgb(74, 112, 139)",slateblue:"rgb(106, 90, 205)",slateblue1:"rgb(131, 111, 255)",slateblue2:"rgb(122, 103, 238)",slateblue3:"rgb(105, 89, 205)",slateblue4:"rgb(71, 60, 139)",slategray:"rgb(112, 128, 144)",slategray1:"rgb(198, 226, 255)",slategray2:"rgb(185, 211, 238)",slategray3:"rgb(159, 182, 205)",slategray4:"rgb(108, 123, 139)",slategrey:"rgb(112, 128, 144)",snow:"rgb(255, 250, 250)",snow1:"rgb(255, 250, 250)",snow2:"rgb(238, 233, 233)",snow3:"rgb(205, 201, 201)",snow4:"rgb(139, 137, 137)",springgreen:"rgb(0, 255, 127)",springgreen1:"rgb(0, 255, 127)",springgreen2:"rgb(0, 238, 118)",springgreen3:"rgb(0, 205, 102)",springgreen4:"rgb(0, 139, 69)",steelblue:"rgb(70, 130, 180)",steelblue1:"rgb(99, 184, 255)",steelblue2:"rgb(92, 172, 238)",steelblue3:"rgb(79, 148, 205)",steelblue4:"rgb(54, 100, 139)",tan:"rgb(210, 180, 140)",tan1:"rgb(255, 165, 79)",tan2:"rgb(238, 154, 73)",tan3:"rgb(205, 133, 63)",tan4:"rgb(139, 90, 43)",thistle:"rgb(216, 191, 216)",thistle1:"rgb(255, 225, 255)",thistle2:"rgb(238, 210, 238)",thistle3:"rgb(205, 181, 205)",thistle4:"rgb(139, 123, 139)",tomato:"rgb(255, 99, 71)",tomato1:"rgb(255, 99, 71)",tomato2:"rgb(238, 92, 66)",tomato3:"rgb(205, 79, 57)",tomato4:"rgb(139, 54, 38)",turquoise:"rgb(64, 224, 208)",turquoise1:"rgb(0, 245, 255)",turquoise2:"rgb(0, 229, 238)",turquoise3:"rgb(0, 197, 205)",turquoise4:"rgb(0, 134, 139)",violet:"rgb(238, 130, 238)",violetred:"rgb(208, 32, 144)",violetred1:"rgb(255, 62, 150)",violetred2:"rgb(238, 58, 140)",violetred3:"rgb(205, 50, 120)",violetred4:"rgb(139, 34, 82)",wheat:"rgb(245, 222, 179)",wheat1:"rgb(255, 231, 186)",wheat2:"rgb(238, 216, 174)",wheat3:"rgb(205, 186, 150)",wheat4:"rgb(139, 126, 102)",white:"rgb(255, 255, 255)",whitesmoke:"rgb(245, 245, 245)",yellow:"rgb(255, 255, 0)",yellow1:"rgb(255, 255, 0)",yellow2:"rgb(238, 238, 0)",yellow3:"rgb(205, 205, 0)",yellow4:"rgb(139, 139, 0)",yellowgreen:"rgb(154, 205, 50)"},{nameToRGB:function(t){return t in e.colorNames?e.colorNames[t]:(t=t.toLowerCase(),t in e.colorNames?e.colorNames[t]:(t=t.replace(/\s+/g,""),t in e.colorNames?e.colorNames[t]:null))},testIfHex:function(e){var t=/(^[0-9A-F]{6}$)|(^[0-9A-F]{3}$)/i.test(e);return t},rgbToHex:function(e){var t=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(e),r=parseInt(t[2]),n=parseInt(t[3]),o=parseInt(t[4]);return"#"+((1<<24)+(r<<16)+(n<<8)+o).toString(16).slice(1)},hslToHex:function(e){var t=function(e,t,n){var o,a,i;if(e%=360,0>e&&(e+=360),e=~~e/360,0>t?t=0:t>100&&(t=100),t=~~t/100,0>n?n=0:n>100&&(n=100),n=~~n/100,0===t)o=a=i=n;else{var s=.5>n?n*(1+t):n+t-n*t,l=2*n-s;o=r(l,s,e+1/3),a=r(l,s,e),i=r(l,s,e-1/3)}return[~~(255*o),~~(255*a),~~(255*i)]},r=function(e,t,r){return 0>r&&(r+=1),r>1&&(r-=1),1/6>r?e+6*(t-e)*r:.5>r?t:2/3>r?e+(t-e)*(2/3-r)*6:e};return{process:function(){return e.replace(/hsl\((-?\d+),(-?\d+)%?,(-?\d+)%?\)/g,function(e,r,n,o){var a=t(r,n,o),i=a[0].toString(16),s=a[1].toString(16),l=a[2].toString(16);return"#"+((1==i.length?"0":"")+i)+((1==s.length?"0":"")+s)+((1==l.length?"0":"")+l)})}}},nameToHex:function(t){var r,n=this.testIfHex(t);return n?"#"+t:t in e.colorNames?r=this.rgbToHex(e.colorNames[t]):(t=t.toLowerCase(),t in e.colorNames?r=this.rgbToHex(e.colorNames[t]):(t=t.replace(/\s+/g,""),t in e.colorNames?r=this.rgbToHex(e.colorNames[t]):null))},x11ToCSS:function(t){function r(e){return 1==e.length?parseInt(e+e,16):2==e.length?parseInt(e,16):(3==e.length&&(e+=e.substr(2)),Math.round(parseInt(e,16)/257))}var n=t.match(e.re_.x11rgb);return n?(n.splice(0,1),e.arrayToRGBA(n.map(r))):this.nameToRGB(t)}}}angular.module("TADkit").service("colorConvert",e)}(),function(){"use strict";function e(e){return{colorsFromIni:function(t){var r={section:/^\s*\[\s*([^\]]*)\s*\]\s*$/,param:/^\s*([\w\.\-\_]+)\s*=\s*([\w\.\-\_]+)/,comment:/^\s*#.*$/},n={},o=t.split(/\r\n|\r|\n/),a=null;return o.forEach(function(t){if(!r.comment.test(t)&&""!==t){var o;if(r.param.test(t))if(o=t.match(r.param),a){var i=e.nameToHex(o[2]);n[a][o[1]]=i}else n[o[1]]=o[2];else r.section.test(t)?(o=t.match(r.section),n[o[1]]={},a=o[1]):0===t.length&&a&&(a=null)}}),n},colorsFromTriplets:function(e){for(var t,r,n=0,o=[],a=e.length;a>n;)t=e[n],r=new THREE.Color(t[0],t[1],t[2]),o.push(r),n++;return o},colorsFromArray:function(e){for(var t=[],r=e.length-1;r>=0;r-=1){var n=e[r]/255;r-=1;var o=e[r]/255;r-=1;var a=e[r]/255,i=new THREE.Color(a,o,n);t.unshift(i)}return t},colorsFromHex:function(e){for(var t=[],r=e.length-1;r>=0;r--){var n=new THREE.Color(e[r]);t.unshift(n)}return t},getRandomColors:function(e){for(var t=[],r=0;e>r;r++){var n="#"+Math.floor(16777215*Math.random()).toString(16);t.push(n)}return t},getGradientColor:function(e,t,r){e=e.replace(/^\s*#|\s*$/g,""),t=t.replace(/^\s*#|\s*$/g,""),3==e.length&&(e=e.replace(/(.)/g,"$1$1")),3==t.length&&(t=t.replace(/(.)/g,"$1$1"));var n=parseInt(e.substr(0,2),16),o=parseInt(e.substr(2,2),16),a=parseInt(e.substr(4,2),16),i=parseInt(t.substr(0,2),16),s=parseInt(t.substr(2,2),16),l=parseInt(t.substr(4,2),16),g=i-n,c=s-o,d=l-a;return g=(g*r+n).toString(16).split(".")[0],c=(c*r+o).toString(16).split(".")[0],d=(d*r+a).toString(16).split(".")[0],1==g.length&&(g="0"+g),1==c.length&&(c="0"+c),1==d.length&&(d="0"+d),"#"+g+c+d}}}angular.module("TADkit").factory("Color",e)}(),function(){"use strict";function e(e){return{parse:function(t){var r={section:/^\s*\[\s*([^\]]*)\s*\]\s*$/,param:/^\s*([\w\.\-\_]+)\s*=\s*([\w\.\-\_]+)/,comment:/^\s*#.*$/},n={},o=t.split(/\r\n|\r|\n/),a=null;return o.forEach(function(t){if(!r.comment.test(t)&&""!==t){var o;if(r.param.test(t))if(o=t.match(r.param),a){var i=e.nameToHex(o[2]);n[a][o[1]]=i}else n[o[1]]=o[2];else r.section.test(t)?(o=t.match(r.section),n[o[1]]={},a=o[1]):0===t.length&&a&&(a=null)}}),n}}}angular.module("TADkit").factory("colorsFromINI",e)}(),function(){"use strict";function e(e,t,r){var n={loaded:[],current:{index:0}};return{load:function(){var r=e.defer(),o="assets/json/tk-defaults-components.json";return n.loaded.length>0?r.resolve(n):t.get(o).success(function(e){n.loaded=e,console.log("Components ("+e.length+") loaded from "+o),r.resolve(n)}),r.promise},add:function(e){e=e||["","","","","","","",[]];var t={metadata:{version:1,type:"component",generator:"TADkit"},object:{uuid:r.generate(),id:e[0],title:e[1],type:e[2],state:{width:e[3],height:e[4],margin:e[5],padding:e[6],position:e[7]}},view:e[8]};return n.loaded.push(t),n.current=n.loaded.length-1,n},remove:function(e){e=e||n.current.index;var t=n.loaded.indexOf(e);return n.loaded.splice(t,1),n},set:function(e){(void 0!==e||e!==!1)&&(n.current.index=e);var t=n.loaded[n.current.index];return t},setViewpoint:function(e,t,r){e=e||0,t=t||4999999;var o=n.loaded;return angular.forEach(o,function(n){var o=r||1;if(n.view.viewpoint.startCoord=e,n.view.viewpoint.endCoord=t,"scene"===n.object.type||"scene-icon"===n.object.type){var a=n.view.viewpoint.fov/2,i=.6;o=Math.tan(a).toFixed(2)*i}n.view.viewpoint.scale=o}),n},get:function(){return n},getComponent:function(e){(void 0===e||e===!1)&&(e=n.current.index);var t=n.loaded[e];return t},getComponentById:function(e){var t,r;if(void 0!==e||e!==!1)for(var o=n.loaded.length-1;o>=0;o--)n.loaded[o].object.id===e&&(t=n.loaded[o],r=o);return r||(t=n.loaded[n.current.index],console.log("Component '"+e+"' not found: returning current.")),t},getComponentByType:function(e){var t,r,o;if(void 0!==e||e!==!1)for(var a=n.loaded.length-1;a>=0;a--)n.loaded[a].object.type===e&&(t=n.loaded[a],o=a),"default"===n.loaded[a].object.type&&(r=n.loaded[a]);return o||(t=r,console.log("Component type '"+e+"' not found: returning default.")),t}}}angular.module("TADkit").factory("Components",e)}(),function(){"use strict";function e(e,t,r){function n(){r.$apply(function(){a.resolve(window.d3)})}var o=!1,a=t.defer(),i=e[0].createElement("script");i.type="text/javascript",i.async=!0,i.src=o?"http://d3js.org/d3.v3.min.js":"assets/libs/d3.min.js",i.onreadystatechange=function(){"complete"==this.readyState&&n()},i.onload=n;
var s=e[0].getElementsByTagName("body")[0];return s.appendChild(i),{d3:function(){return a.promise}}}angular.module("d3",[]).factory("d3Service",e)}(),function(){"use strict";function e(e,t){var r={loaded:[],current:{index:0,cluster:1,centroid:1}};return{load:function(){var n=e.defer(),o="assets/json/mycoplasma_pneumoniae-tadbit.json",a=this;return r.loaded.length>0?n.resolve(r):t.get(o).success(function(e){r.loaded=e;var t=r.current.index;r.loaded[t].object.speciesUrl=a.setSpeciesUrl(t),console.log("Datasets ("+e.length+") loaded from "+o),n.resolve(r)}),n.promise},add:function(e){var t=JSON.parse(e);return r.loaded.push(t[0]),r.current.index=r.loaded.length-1,console.log('Dataset "'+r.loaded[r.current.index].object.title+'" loaded from file.'),console.log(r.loaded[r.current.index]),r},remove:function(e){(void 0===e||e===!1)&&(e=r.current.index);var t=r.loaded.indexOf(e);return r.loaded.splice(t,1),r},setSpeciesUrl:function(e){(void 0===e||e===!1)&&(e=r.current.index);var t=r.loaded[e].object.species;return t=t.replace(/[^a-z0-9]/gi,"_").toLowerCase()},set:function(e){(void 0!==e||e!==!1)&&(r.current.index=e),this.setCluster(r.current.cluster);var t=r.loaded[r.current.index];return t},setCluster:function(e){e=e||1,r.current.cluster=e;var t=this.getCentroid(r.current.cluster);this.setCentroid(t);var n=this.getCluster();return n},setCentroid:function(e){e=e||this.getCentroid(),r.current.centroid=e;var t=this.setModel(r.current.centroid);return t},setModel:function(e){e=e||this.getCentroid();var t=this.getModel(e-1);return r.loaded[r.current.index].data=t,t},get:function(){return r},getDataset:function(e){(void 0===e||e===!1)&&(e=r.current.index);var t=r.loaded[e];return t},getCluster:function(e){e=e||r.current.cluster;var t=r.loaded[r.current.index].clusters[e-1];return t},getCentroid:function(e){e=e||r.current.cluster;var t=r.loaded[r.current.index].centroids[e-1];return t},getModel:function(e){e=e||this.getCentroid();for(var t,n=r.loaded[r.current.index].models,o=n.length-1;o>=0;o--)n[o].ref==e&&(t=n[o]);return t},getSpeciesUrl:function(e){(void 0===e||e===!1)&&(e=r.current.index);var t=r.loaded[e].object.speciesUrl;return t},getRegion:function(e){(void 0===e||e===!1)&&(e=r.current.index);var t=r.loaded[e].object.chromosome+":"+r.loaded[e].object.startCoord+"-"+r.loaded[e].object.endCoord;return t},getComponents:function(e){(void 0===e||e===!1)&&(e=r.current.index);var t=r[e].components;return t}}}angular.module("TADkit").factory("Datasets",e)}(),function(){"use strict";function e(e,t){var r={ping:0};return{ping:function(){console.log("Pinging Ensembl RESTful genomic data server...");var n=e.defer(),o="http://rest.ensembl.org/info/ping?content-type=application/json";return t.get(o).success(function(e){r.ping=e.ping,console.log("Ensembl RESTful is contactable.")}),n.promise},load:function(r,n,o){var a,i=e.defer(),s=r.species,l=r.speciesUrl,g=r.chromosome,c=r.startCoord,d=r.endCoord,u=this;return a=o?n.object.url[0]+l+n.object.url[2]+g+n.object.url[4]+c+n.object.url[6]+d+n.object.url[8]:"assets/json/"+l+"-genes.json",t.get(a).success(function(e){var t=u.setBiotypeStyle(e);n.data=t;var r="("+g+":"+c+"-"+d+")",a=o?"Ensembl":"local storage";console.log("Genes for "+s+" "+r+" retreived from "+a+"."),i.resolve(n)}),i.promise},setBiotypeStyle:function(e){return angular.forEach(e,function(e){var t=e.biotype.toLowerCase();e.biotypeStyle=t}),e}}}angular.module("TADkit").factory("Ensembl",e)}(),function(){"use strict";function e(e,t){return function(){var e=t.getDataset();console.log(e)}}angular.module("TADkit").service("initBrowser",e)}(),function(){"use strict";function e(e,t,r,n,o,a,i,s,l,g){return function(){var c=t.load(),d=r.load(),u=n.load(),b=o.load(),p=a.load(),m=i.load(),v=s.load(),f=l.loadBiotypeColors();return e.all([c,d,u,b,p,m,v,f]).then(function(t){var r=[],n=l.loadInfoAssembly(o.getSpeciesUrl());r.push(n);var i=o.getDataset(),s=a.get();return angular.forEach(s.loaded,function(e){var t;"ensembl"==e.object.type&&"json"==e.object.format&&(t=g.load(i.object,e),r.push(t))}),e.all(r).then(function(e){var r=t[0];return r.infoAssembly=e,t})}).then(function(r){var n=t.get(),i=o.getDataset(),l=s.getStoryboard(),g=i.models[0].data.length/i.object.components,c=l.components[0].view.settings.chromatin.particleSegments,d=g*c,u=i.object.resolution/c;return e.all([n,i,l,c,g,d,u]).then(function(){var e=i.object.startCoord,t=r[7],o=t;return n.startCoord=e,n.particlesCount=g,n.particleSegments=c,n.segmentsCount=d,n.segmentLength=u,a.segmentOverlays(e,d,u,o),r})}).then(function(e){return{settings:e[0],users:e[1],projects:e[2],datasets:e[3],overlays:e[4],components:e[5],storyboards:e[6],featureColors:e[7]}})}}angular.module("TADkit").service("initMain",e)}(),function(){"use strict";function e(e,t,r){var n={loaded:[],current:{index:0}};return{load:function(){var r=e.defer(),o="assets/json/tk-defaults-overlays.json";return n.loaded.length>0?r.resolve(n):t.get(o).success(function(e){n.loaded=e,console.log("Overlays ("+e.length+") loaded from "+o),r.resolve(n)}),r.promise},"import":function(e){var t=JSON.parse(e),r=t;return this.add(r),console.log('New overlay "'+n.loaded[datasets.current.index].object.title+'" created from imported data.'),console.log(n.loaded[n.current.index]),n},aquire:function(e){for(var t=d3.scale.category20(),n=[],o=e[1][1]-e[1][0]+1,a=e[0].length-1;a>=2;a--){n.unshift({metadata:{version:1,type:"overlay",generator:"TADkit"},object:{uuid:r.generate(),id:e[0][a],title:e[0][a],source:"Research output",url:"local",description:"center_label",type:"wiggle_0",format:"bigwig",components:2,name:e[0][a],visibility:"full",color:t(a),altColor:"#0000ff",priority:"100",stepType:"fixed",chrom:"",start:e[1][0],step:o,state:{index:0,overlaid:!1}},data:[]});for(var i=e.length-1;i>=1;i--)n[0].data.unshift(e[i][a])}return n},add:function(e){e=e||["default","overlay","name","www","describe","json","0",[1]];var t={metadata:{version:1,type:"overlay",generator:"TADkit"},object:{uuid:r.generate(),id:e[0],title:e[1],source:e[2],url:e[3],description:e[4],format:e[5],components:e[6]},data:e[7]};return n.loaded.push(t),n.current.index=n.loaded.length-1,console.log('Overlay "'+n.loaded[datasets.current.index].object.title+'" loaded from file.'),n},remove:function(e){(void 0===e||e===!1)&&(e=n.current.index);var t=n.loaded.indexOf(e);return n.loaded.splice(t,1),n},set:function(e){(void 0!==e||e!==!1)&&(n.current.index=e);var t=n.loaded[n.current.index];return t},setOverlaid:function(e){return e=e||"",angular.forEach(n.loaded,function(t){t.object.state.overlaid=t.object.state.index===e?!0:!1}),e},segmentOverlays:function(e,t,r,o){o=o||[];var a=this;return angular.forEach(n.loaded,function(n){if(n.colors&&0!==n.colors.length)console.log("Overlay '"+n.object.title+"' already segmented as color array matching current dataset length");else{var i=n.object.type,s=n.object.format,l=[];if("gradient"==i&&"hex"==s)l=a.segmentGradientHCL(n.data,t);else if("wiggle_0"==i&&"bigwig"==s){var g=n.object.color;l=a.segmentLinear(n.data,e,t,r,g)}else"linear"==i&&"seq"==s?l=a.segmentLinear(n.data,e,t,r):"ensembl"==i&&"json"==s&&(o=o.gene,l=a.segmentFeatures(n.data,e,t,r,o));n.colors=l}}),n},segmentGradientHCL:function(e,t){for(var r=[],n=e[0],o=e[1],a=t-1;a>=0;a--){var i=a/t,s=d3.interpolateHcl(n,o)(i);r.push(s)}return r},segmentGradientLinear:function(e,t){var r,n,o,a,i,s,l,g,c,d,u=[],b="0x"+e[0].substring(1),p="0x"+e[1].substring(1);r=b>>16,n=b>>8&255,o=255&b,a=p>>16,i=p>>8&255,s=255&p;for(var m=t-1;m>=0;m--)l=m/t,g=+(l*r+(1-l)*a).toFixed(2),c=+(l*n+(1-l)*i).toFixed(2),d=+(l*o+(1-l)*s).toFixed(2),u.push(g,c,d);return u},segmentLinear:function(e,t,r,n,o){for(var a="#cccccc",i=[],s=0;r>s;s++){var l;l=1===e[s]?o:a,i.push(l)}return i},segmentFeatures:function(e,t,r,n,o){for(var a=[],i=0;r>i;i++){for(var s=[],l=t+n*i,g=l+n,c=e.length,d="cccccc",u="#"+d,b=0;c>b;b++){var p=e[b].start,m=e[b].end,v=[];if(Math.max(l,p)<=Math.min(g,m)){v.push(i);var f="biotype",h="protein_coding";s.length>0&&s[0]==h?s[0]=e[b][f].toLowerCase():s.push(e[b][f].toLowerCase())}e[b].inSegments=v}for(var y=0;y<s.length;y++){var w=s[0];w in o?(d=o[w].match(/[a-f0-9]{6}/gi),u="#"+d):(d="110100",u="#"+d)}a.push(u)}return a},get:function(){return n},getOverlay:function(e){(void 0===e||e===!1)&&(e=n.current.index);var t=n.loaded[e];return t},getOverlayById:function(e){var t,r;if(void 0!==e||e!==!1)for(var o=n.loaded.length-1;o>=0;o--)n.loaded[o].object.id===e&&(t=n.loaded[o],t.object.state.index=o,r=!0);return r||(t=n.loaded[n.current.index],t.object.state.index=n.current.index,console.log('Overlay "'+e+'" not found: returning current.')),t},getCurrentIndex:function(){return n.current.index},getComponents:function(e){(void 0===e||e===!1)&&(e=n.current.index);var t=n.loaded[e].object.components;return t}}}angular.module("TADkit").factory("Overlays",e)}(),function(){"use strict";function e(e,t,r){var n={loaded:[],current:{index:0}};return{load:function(){var r=e.defer(),o="assets/json/tk-defaults-projects.json";return n.loaded.length>0?r.resolve(n):t.get(o).success(function(e){n.loaded=e,console.log("Projects ("+e.length+") loaded from "+o),r.resolve(n)}),r.promise},add:function(e){var t={metadata:{version:1,type:"project",generator:"TADkit"},object:{uuid:r.generate(),id:e[0],title:e[1],description:e[2],group:e[3],state:e[4]},datasets:e[5],overlays:e[6],storyboards:e[7]};return n.loaded.push(t),n.current=n.loaded.length-1,n},remove:function(e){(void 0===e||e===!1)&&(e=users.current.index);var t=n.loaded.indexOf(e);return n.loaded.splice(t,1),n},set:function(e){(void 0!==e||e!==!1)&&(n.current.index=e);var t=n.loaded[n.current.index];return t},get:function(){return n},getProject:function(e){(void 0===e||e===!1)&&(e=n.current.index);var t=n.loaded[e];return t},getState:function(e){(void 0===e||e===!1)&&(e=n.current.index);var t=n.loaded[e].object.state;return t}}}angular.module("TADkit").factory("Projects",e)}(),function(){"use strict";function e(e,t,r){var n={},o="http://rest.ensembl.org/";return n.assembly={},n.featureColors={},{setLengthBP:function(e){var t=0,r=e;for(var n in r)if(r.hasOwnProperty(n))for(var o=0,a=r.length;a>o;o++)t+=r[o].length;return t},loadInfoAssembly:function(r,a){var i,s=e.defer(),l=this;return i=a?o+"info/assembly/"+r+"?content-type=application/json":"assets/json/"+r+"-assembly.json",t.get(i).success(function(e){var t=a?"Ensembl":"local storage";console.log("Assembly Info for "+r+" retreived from "+t+"."),e.lengthBP=l.setLengthBP(e.top_level_region),console.log("Assembly length for "+r+" = "+e.lengthBP),n.assembly=e,s.resolve(e)}),s.promise},loadBiotypeColors:function(){var o,a=e.defer(),i=!1;return o=i?"https://cdn.rawgit.com/Ensembl/ensembl-webcode/release/75/conf/ini-files/COLOUR.ini":"assets/json/ensembl-webcode-COLOUR.ini",t.get(o).success(function(e){var t=r.colorsFromIni(e);n.featureColors=t,n.biotypes=t.gene,console.log("Ensembl webcode biotype colors retrieved Ensembl."),a.resolve(t)}),a.promise},loadInfoBiotypes:function(r){var n,a=e.defer();return n=online?o+"info/biotypes/"+r+"?content-type=application/json":"assets/json/"+r+"-biotypes.json",t.get(n).success(function(e){console.log("Biotypes for "+r+" retreived from Ensembl."),a.resolve(e)}),a.promise},get:function(){return n},getRegionBiotypes:function(e){for(var t,r=[],n={},o=0;t==e[o++];){var a=t.biotype;a in n||(n[a]=1,r.push(a))}console.log("Biotypes"),console.log(r);var i=r.length;console.log("Total Biotypes: %s",i)},getProximityMatrix:function(e,t){var r={minDistance:150,limitConnections:!0,maxConnections:200};t=t||{},angular.extend(this,angular.copy(r),t);for(var n={},o=0,a=0,i=e.length/3,s=i*i,l=new Float32Array(3*s),g=new Float32Array(3*s),c=i-1;c>=0;c--)for(var d=i-1;d>=0;d--){var u=e[3*c]-e[3*d],b=e[3*c+1]-e[3*d+1],p=e[3*c+2]-e[3*d+2],m=Math.sqrt(u*u+b*b+p*p),v=(1-m/this.minDistance).toFixed(2);l[o++]=e[3*c],l[o++]=e[3*c+1],l[o++]=e[3*c+2],l[o++]=e[3*d],l[o++]=e[3*d+1],l[o++]=e[3*d+2],g[a++]=v,g[a++]=v,g[a++]=v,g[a++]=v,g[a++]=v,g[a++]=v}return n.positions=l,n.distances=g,n}}}angular.module("TADkit").factory("Resources",e)}(),function(){"use strict";function e(e,t){var r={};return{load:function(){var n=e.defer(),o="assets/json/tk-defaults-settings.json";return Object.getOwnPropertyNames(r).length>0?n.resolve(r):t.get(o).success(function(e){r=e,console.log("Settings loaded from "+o),n.resolve(r)}),n.promise},add:function(){return r},remove:function(){return r},getState:function(){var e=r[settingID].state;return e},get:function(){return r},toggle:function(e){return angular.forEach(r,function(t){e==t.id&&(t.state=!t.state)}),r}}}angular.module("TADkit").factory("Settings",e)}(),function(){"use strict";function e(e,t,r){var n={loaded:[],current:{index:0}};return{load:function(){var r=e.defer(),o="assets/json/tk-defaults-storyboards.json";return n.loaded.length>0?r.resolve(n):t.get(o).success(function(e){n.loaded=e,console.log("Storyboards ("+e.length+") loaded from "+o),r.resolve(n)}),r.promise},add:function(e){e=e||[""];var t={metadata:{version:1,type:"storyboard",generator:"TADkit"},object:{uuid:r.generate(),id:e[0],title:e[1],email:e[2],group:e[3],permissions:e[4]},data:e[5]};return n.loaded.push(t),n.current=n.loaded.length-1,n},addComponent:function(e,t,r){e=e||"default",r=r||[""];var n=this.getStoryboardById(e);return n.components.push(t),n},remove:function(e){(void 0===e||e===!1)&&(e=n.current.index);var t=n.loaded.indexOf(e);return n.loaded.splice(t,1),n},set:function(e){(void 0!==e||e!==!1)&&(n.current.index=e);var t=n.loaded[n.current.index];return t},setViewpoint:function(e,t,r){e=e||0,t=t||4999999;var o=n.loaded[n.current.index].components;return angular.forEach(o,function(n){var o=r||1;if(n.view.viewpoint.startCoord=e,n.view.viewpoint.endCoord=t,"scene"===n.object.type||"scene-icon"===n.object.type){var a=n.view.viewpoint.fov/2,i=.6;o=Math.tan(a).toFixed(2)*i}n.view.viewpoint.scale=o}),n},get:function(){return n},getStoryboard:function(e){(void 0===e||e===!1)&&(e=n.current.index);var t=n.loaded[e];return t},getStoryboardById:function(e){var t,r;if(void 0!==e||e!==!1)for(var o=n.loaded.length-1;o>=0;o--)n.loaded[o].object.id===e&&(t=n.loaded[o],t.index=o,r=!0);return r||(t=n.loaded[n.current.index],t.index=n.current.index,console.log("Storyboard '"+e+"' not found: returning current.")),t}}}angular.module("TADkit").factory("Storyboards",e)}(),function(){"use strict";function e(e,t){var r="";return{loadTables:function(n,o){var a=e.defer();return t.get("assets/json/GSE22069_norm_aggregated_discretized_tiling_arrays.json").success(function(e){r=e,console.log("Tables for region "+o+" of "+n+" retreived from file."),a.resolve(e)}),a.promise},getTables:function(){return r},getSampleCount:function(){return r.length},getTablesList:function(){for(var e=[],t=4;t<r[0].length;t++)for(var n in r[0])e.push(n);return e},getTableCount:function(){var e=r[0].length-4;return e},getTableArray:function(e,t){for(var r=[],n=0;n<e.length;n++)1==e[n][t]&&r.push({fragmentID:e[n].fragmentID,chromosome:e[n].chromosome,start:e[n].start,end:e[n].end});return r},getColors:function(e,t,r,n,o){var a=[],i=this.getTableArray(e,t),s="#999999";"HP1"==t&&(s="#227c4f"),"BRM"==t&&(s="#8ece0d"),"MRG15"==t&&(s="#e71818"),"PC"==t&&(s="#6666ff"),"H1"==t&&(s="#424242");for(var l=0;r>l;l++){for(var g=n+o*l,c=g+o,d=i.length,u="#cccccc",b=0;d>b;b++){var p=i[b].start,m=i[b].end;Math.max(g,p)<=Math.min(c,m)&&(u=s)}a.push(u)}return a}}}angular.module("TADkit").factory("Tables",e)}(),function(){"use strict";function e(e,t,r){function n(){r.$apply(function(){o.resolve(window.three)})}var o=t.defer(),a=e[0].createElement("script");a.type="text/javascript",a.async=!0,a.src="../bower_components/threejs/build/three.js",a.onreadystatechange=function(){"complete"==this.readyState&&n()},a.onload=n;var i=e[0].getElementsByTagName("body")[0];return i.appendChild(a),{three:function(){return o.promise}}}angular.module("three",[]).factory("threeService",e)}(),function(){"use strict";function e(e,t,r){var n={loaded:[],current:{index:0}};return{load:function(){var r=e.defer(),o="assets/json/tk-defaults-users.json";return n.loaded.length>0?r.resolve(n):t.get(o).success(function(e){n.loaded=e,console.log("Users ("+e.length+") loaded from "+o),r.resolve(n)}),r.promise},add:function(e){e=e||["id","Name Surname","email@company.com","Group","edit",["default"]];var t={metadata:{version:1,type:"user",generator:"TADkit"},object:{uuid:r.generate(),id:e[0],title:e[1],email:e[2],group:e[3],permissions:e[4]},projects:e[5]};return n.loaded.push(t),n.current=n.loaded.length-1,n},remove:function(e){(void 0===e||e===!1)&&(e=n.current.index);var t=n.loaded.indexOf(e);return n.loaded.splice(t,1),n},set:function(e){(void 0!==e||e!==!1)&&(n.current.index=e);var t=n.loaded[n.current.index];return t},get:function(){return n},getUser:function(e){(void 0===e||e===!1)&&(e=n.current.index);var t=n.loaded[e];return t},getPermissions:function(e){(void 0===e||e===!1)&&(e=n.current.index);var t=n.loaded[e].permissions;return t}}}angular.module("TADkit").factory("Users",e)}();