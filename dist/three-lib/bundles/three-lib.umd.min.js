!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("three-full"),require("@angular/common")):"function"==typeof define&&define.amd?define("three-lib",["exports","@angular/core","three-full","@angular/common"],t):t(e["three-lib"]={},e.ng.core,null,e.ng.common)}(this,function(e,n,r,t){"use strict";var o=function(){function e(){}return e.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=n.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function s(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function a(t,s,a,c){return new(a||(a=Promise))(function(e,n){function r(e){try{i(c.next(e))}catch(t){n(t)}}function o(e){try{i(c["throw"](e))}catch(t){n(t)}}function i(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(r,o)}i((c=c.apply(t,s||[])).next())})}function c(r,o){var i,s,a,e,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),"throw":t(1),"return":t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function n(e){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,s&&(a=s[2&e[0]?"return":e[0]?"throw":"next"])&&!(a=a.call(s,e[1])).done)return a;switch(s=0,a&&(e=[0,a.value]),e[0]){case 0:case 1:a=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,s=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!(a=0<(a=c.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){c=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){c.label=e[1];break}if(6===e[0]&&c.label<a[1]){c.label=a[1],a=e;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(e);break}a[2]&&c.ops.pop(),c.trys.pop();continue}e=o.call(r,c)}catch(t){e=[6,t],s=0}finally{i=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([t,e])}}}var l=function(){function e(){}return e.prototype.rerender=function(){},e.prototype.ngOnChanges=function(t){if(this.object){var e=!1;["rotateX","rotateY","rotateZ"].some(function(e){return e in t})&&(this.applyRotation(),e=!0),["translateX","translateY","translateZ"].some(function(e){return e in t})&&(this.applyTranslation(),e=!0),e&&this.rerender()}},e.prototype.ngAfterViewInit=function(){var t=this;console.log("AbstractObject3D.ngAfterViewInit"),this.object=this.newObject3DInstance(),this.applyTranslation(),this.applyRotation(),this.childNodes!==undefined&&1<this.childNodes.length&&this.childNodes.filter(function(e){return e!==t&&e.getObject()!==undefined}).forEach(function(e){t.addChild(e.getObject())}),this.afterInit()},e.prototype.applyRotation=function(){this.object.rotation.set(this.rotateX||0,this.rotateY||0,this.rotateZ||0,"XYZ")},e.prototype.applyTranslation=function(){this.object.position.set(this.translateX||0,this.translateY||0,this.translateZ||0)},e.prototype.addChild=function(e){this.object.add(e)},e.prototype.removeChild=function(e){this.object.remove(e)},e.prototype.getObject=function(){return this.object},e.propDecorators={childNodes:[{type:n.ContentChildren,args:[e,{descendants:!1}]}],rotateX:[{type:n.Input}],rotateY:[{type:n.Input}],rotateZ:[{type:n.Input}],translateX:[{type:n.Input}],translateY:[{type:n.Input}],translateZ:[{type:n.Input}]},e}(),p=function(e){function t(){return console.log("SceneDirective.constructor"),e.call(this)||this}return s(t,e),t.prototype.afterInit=function(){console.log("SceneDirective.afterInit")},t.prototype.newObject3DInstance=function(){return console.log("SceneDirective.newObject3DInstance"),new r.Scene},t.decorators=[{type:n.Directive,args:[{selector:"three-scene",providers:[{provide:l,useExisting:n.forwardRef(function(){return t})}]}]}],t.ctorParameters=function(){return[]},t}(l),u=function(){function e(){console.log("AbstractCamera.constructor")}return e.prototype.ngAfterViewInit=function(){console.log("AbstractCamera.ngAfterViewInit"),this.afterInit()},e}(),d=function(){function e(){this.viewInitialized=!1,console.log("RendererComponent.constructor"),this.render=this.render.bind(this)}return e.prototype.ngAfterViewInit=function(){console.log("RendererComponent.ngAfterViewInit"),this.viewInitialized=!0,this.startRendering()},Object.defineProperty(e.prototype,"renderPane",{get:function(){return this.canvasRef},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvas",{get:function(){return this.canvasRef.nativeElement},enumerable:!0,configurable:!0}),e.prototype.startRendering=function(){console.log("RendererComponent.startRendering"),this.renderer=new r.WebGLRenderer({canvas:this.canvas,antialias:!0}),this.renderer.setPixelRatio(devicePixelRatio),this.renderer.setSize(this.canvas.clientWidth,this.canvas.clientHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=r.PCFSoftShadowMap,this.renderer.setClearColor(16777215,1),this.renderer.autoClear=!0,this.updateChildCamerasAspectRatio(),this.render()},e.prototype.render=function(){if(this.viewInitialized){var e=this.sceneComponents.first,t=this.cameraComponents.first;this.renderer.render(e.getObject(),t.camera)}},e.prototype.calculateAspectRatio=function(){return 0===this.canvas.clientHeight?0:this.canvas.clientWidth/this.canvas.clientHeight},e.prototype.onResize=function(e){this.canvas.style.width="100%",this.canvas.style.height="100%",console.log("RendererComponent.onResize: "+this.canvas.clientWidth+", "+this.canvas.clientHeight),this.updateChildCamerasAspectRatio(),this.renderer.setSize(this.canvas.clientWidth,this.canvas.clientHeight),this.render()},e.prototype.updateChildCamerasAspectRatio=function(){var t=this.calculateAspectRatio();this.cameraComponents.forEach(function(e){return e.updateAspectRatio(t)})},e.decorators=[{type:n.Component,args:[{selector:"three-webgl-renderer",template:"<canvas #canvas>\n</canvas>",styles:["canvas{width:100%;height:100%}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={canvasRef:[{type:n.ViewChild,args:["canvas"]}],sceneComponents:[{type:n.ContentChildren,args:[p]}],cameraComponents:[{type:n.ContentChildren,args:[u]}],onResize:[{type:n.HostListener,args:["window:resize",["$event"]]}]},e}(),h=function(){function e(){this.listeningControlElement=undefined,this.rotateSpeed=1,this.zoomSpeed=1.2,console.log("OrbitControlsDirective.constructor")}return e.prototype.ngOnChanges=function(e){this.controls&&(e.rotateSpeed&&(this.controls.rotateSpeed=this.rotateSpeed),e.zoomSpeed&&(this.controls.zoomSpeed=this.zoomSpeed),e.listeningControlElement&&(this.controls.dispose(),this.setUpOrbitControls()))},e.prototype.ngOnDestroy=function(){this.controls.dispose()},e.prototype.setUpOrbitControls=function(){this.controls=new r.OrbitControls(this.childCameras.first.camera,this.listeningControlElement&&this.listeningControlElement.nativeElement),this.controls.rotateSpeed=this.rotateSpeed,this.controls.zoomSpeed=this.zoomSpeed,this.controls.addEventListener("change",this.childRenderers.first.render),this.childRenderers.first.render()},e.prototype.ngAfterViewInit=function(){if(console.log("OrbitControlsDirective.ngAfterViewInit"),this.childCameras===undefined||this.childCameras.first===undefined)throw new Error("Camera is not found");if(this.childRenderers===undefined||this.childRenderers.first===undefined)throw new Error("Renderer is not found");this.setUpOrbitControls()},e.decorators=[{type:n.Directive,args:[{selector:"three-orbit-controls"}]}],e.ctorParameters=function(){return[]},e.propDecorators={childCameras:[{type:n.ContentChildren,args:[u,{descendants:!0}]}],childRenderers:[{type:n.ContentChildren,args:[d,{descendants:!0}]}],listeningControlElement:[{type:n.Input}],rotateSpeed:[{type:n.Input}],zoomSpeed:[{type:n.Input}]},e}(),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.parentInitialized=!1,e}return s(e,t),Object.defineProperty(e.prototype,"model",{get:function(){return this._model},set:function(e){var t=this;this._model=e,this.parentInitialized&&this.loadModelObject().then(function(e){t.currentLoadedModelObject&&t.removeChild(t.currentLoadedModelObject),t.currentLoadedModelObject=e,t.addChild(e),t.renderer&&t.renderer.render()})["catch"](function(e){console.error(e)})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderer",{get:function(){return this._renderer},set:function(e){this._renderer=e,this._renderer.render()},enumerable:!0,configurable:!0}),e.prototype.afterInit=function(){this.parentInitialized=!0,this.model=this.model},e.prototype.ngOnDestroy=function(){this.currentLoadedModelObject&&this.removeChild(this.currentLoadedModelObject)},e.prototype.rerender=function(){t.prototype.rerender.call(this),this.renderer&&this.renderer.render()},e.prototype.newObject3DInstance=function(){return new r.Object3D},e.propDecorators={model:[{type:n.Input}],renderer:[{type:n.Input}]},e}(l),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loader=new r.ColladaLoader,e}return s(e,t),e.prototype.loadModelObject=function(){return a(this,void 0,void 0,function(){var n=this;return c(this,function(e){return[2,new Promise(function(t,e){n.loader.load(n.model,function(e){t(e.scene)},undefined,e)})]})})},e.decorators=[{type:n.Directive,args:[{selector:"three-collada-loader",providers:[{provide:l,useExisting:n.forwardRef(function(){return e})}]}]}],e}(f),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loader=new r.OBJLoader,e.mtlLoader=new r.MTLLoader,e}return s(e,t),e.prototype.loadModelObject=function(){return a(this,void 0,void 0,function(){var r=this;return c(this,function(e){return this.material===undefined?[2,new Promise(function(t,e){r.loader.load(r.model,function(e){t(e)},undefined,e)})]:[2,new Promise(function(t,n){r.texturePath!==undefined&&r.mtlLoader.setTexturePath(r.texturePath),r.mtlLoader.load(r.material,function(e){e.preload(),r.loader.setMaterials(e),r.loader.load(r.model,function(e){t(e)},undefined,n)})})]})})},e.decorators=[{type:n.Directive,args:[{selector:"three-obj-loader",providers:[{provide:l,useExisting:n.forwardRef(function(){return e})}]}]}],e.propDecorators={material:[{type:n.Input}],texturePath:[{type:n.Input}]},e}(f),m=function(){function e(){}return e.prototype.transform=function(e){return e*(180/Math.PI)},e.decorators=[{type:n.Pipe,args:[{name:"rad2deg"}]}],e}(),g=function(){function e(){}return e.prototype.transform=function(e){return e/180*Math.PI},e.decorators=[{type:n.Pipe,args:[{name:"deg2rad"}]}],e}(),b=function(e){function t(){return console.log("PerspectiveCameraDirective.constructor"),e.call(this)||this}return s(t,e),t.prototype.afterInit=function(){console.log("PerspectiveCameraDirective.afterInit"),this.camera=new r.PerspectiveCamera(this.fov,undefined,this.near,this.far),this.camera.position.x=this.positionX,this.camera.position.y=this.positionY,this.camera.position.z=this.positionZ,this.camera.updateProjectionMatrix()},t.prototype.updateAspectRatio=function(e){console.log("PerspectiveCameraDirective.updateAspectRatio: "+e),this.camera.aspect=e,this.camera.updateProjectionMatrix()},t.decorators=[{type:n.Directive,args:[{selector:"three-perspective-camera",providers:[{provide:u,useExisting:n.forwardRef(function(){return t})}]}]}],t.ctorParameters=function(){return[]},t.propDecorators={fov:[{type:n.Input}],near:[{type:n.Input}],far:[{type:n.Input}],positionX:[{type:n.Input}],positionY:[{type:n.Input}],positionZ:[{type:n.Input}]},t}(u),w=function(t){function e(){var e=t.call(this)||this;return console.log("AxesHelperDirective.constructor"),e}return s(e,t),e.prototype.newObject3DInstance=function(){return console.log("AxesHelperDirective.newObject3DInstance"),new r.AxesHelper(this.size)},e.prototype.afterInit=function(){console.log("AxesHelperDirective.afterInit")},e.decorators=[{type:n.Directive,args:[{selector:"three-axes-helper",providers:[{provide:l,useExisting:n.forwardRef(function(){return e})}]}]}],e.ctorParameters=function(){return[]},e.propDecorators={size:[{type:n.Input}]},e}(l),C=function(t){function e(){var e=t.call(this)||this;return console.log("GridHelperDirective.constructor"),e}return s(e,t),e.prototype.newObject3DInstance=function(){return console.log("GridHelperDirective.newObject3DInstance"),new r.GridHelper(this.size,this.divisions)},e.prototype.afterInit=function(){console.log("GridHelperDirective.afterInit")},e.decorators=[{type:n.Directive,args:[{selector:"three-grid-helper",providers:[{provide:l,useExisting:n.forwardRef(function(){return e})}]}]}],e.ctorParameters=function(){return[]},e.propDecorators={size:[{type:n.Input}],divisions:[{type:n.Input}]},e}(l),I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loader=new r.ObjectLoader,e}return s(e,t),e.prototype.loadModelObject=function(){return a(this,void 0,void 0,function(){var n=this;return c(this,function(e){return[2,new Promise(function(t,e){n.loader.load(n.model,function(e){t(e)},undefined,e)})]})})},e.decorators=[{type:n.Directive,args:[{selector:"three-object-loader",providers:[{provide:l,useExisting:n.forwardRef(function(){return e})}]}]}],e}(f),D=function(t){function e(){var e=t.call(this)||this;return console.log("PointLightDirective.constructor"),e}return s(e,t),e.prototype.newObject3DInstance=function(){return console.log("PointLightDirective.newObject3DInstance"),new r.PointLight(this.color,this.intensity,this.distance)},e.prototype.afterInit=function(){console.log("PointLightDirective.afterInit")},e.decorators=[{type:n.Directive,args:[{selector:"three-point-light",providers:[{provide:l,useExisting:n.forwardRef(function(){return e})}]}]}],e.ctorParameters=function(){return[]},e.propDecorators={color:[{type:n.Input}],intensity:[{type:n.Input}],distance:[{type:n.Input}]},e}(l),R=function(){function e(){this.renderer=new r.WebGLRenderer,this.scene=null,this.camera=null,this.mesh=null,this.controls=null,this.scene=new r.Scene,this.camera=new r.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1e3),this.controls=new r.OrbitControls(this.camera)}return Object.defineProperty(e.prototype,"canvas",{get:function(){return this.canvasRef.nativeElement},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){this.configCamera(),this.configRenderer(),this.configControls(),this.createMesh(),this.animate()},e.prototype.configCamera=function(){this.camera.position.set(300,300,300)},e.prototype.configRenderer=function(){this.renderer=new r.WebGLRenderer({canvas:this.canvas,antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setClearColor(new r.Color("hsl(0, 0%, 10%)")),this.renderer.setSize(this.canvas.clientWidth,this.canvas.clientHeight),this.renderer.domElement.style.display="block",this.renderer.domElement.style.margin="auto",console.log(this.canvas.clientWidth),console.log(this.canvas.clientHeight)},e.prototype.configControls=function(){this.controls.autoRotate=!0,this.controls.enableZoom=!1,this.controls.enablePan=!1,this.controls.update()},e.prototype.createMesh=function(){var e=new r.BoxGeometry(200,200,200),t=new r.MeshBasicMaterial({color:16744272});this.mesh=new r.Mesh(e,t),this.scene.add(this.mesh)},e.prototype.animate=function(){var e=this;window.requestAnimationFrame(function(){return e.animate()}),this.controls.update(),this.renderer.render(this.scene,this.camera)},e.decorators=[{type:n.Component,args:[{selector:"three-test",template:'\x3c!-- <canvas #canvas (window:resize)="onResize($event)"></canvas> --\x3e\n<canvas #canvas></canvas>\n',styles:["canvas{width:100%;height:100%}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={canvasRef:[{type:n.ViewChild,args:["canvas"]}]},e}(),P=function(){function e(){}return e.decorators=[{type:n.NgModule,args:[{imports:[t.CommonModule],declarations:[h,v,y,m,g,b,d,p,w,C,I,D,R],exports:[h,v,y,m,g,b,d,p,w,C,I,D,R],providers:[],entryComponents:[d]}]}],e}();e.ThreeLibService=o,e.WebGLRendererComponent=d,e.OrbitControlsDirective=h,e.ColladaLoaderDirective=v,e.ObjLoaderDirective=y,e.Rad2DegPipe=m,e.Deg2RadPipe=g,e.PerspectiveCameraDirective=b,e.SceneDirective=p,e.AxesHelperDirective=w,e.GridHelperDirective=C,e.ObjectLoaderDirective=I,e.PointLightDirective=D,e.ThreeLibModule=P,e.ɵb=u,e.ɵa=l,e.ɵc=f,e.ɵd=R,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=three-lib.umd.min.js.map