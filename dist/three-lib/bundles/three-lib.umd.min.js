!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("three-full"),require("@avatsaev/three-orbitcontrols-ts"),require("three"),require("@angular/common")):"function"==typeof define&&define.amd?define("three-lib",["exports","@angular/core","three-full","@avatsaev/three-orbitcontrols-ts","three","@angular/common"],t):t(e["three-lib"]={},e.ng.core,e.THREE,e.OrbitControls,e.THREE,e.ng.common)}(this,function(e,n,r,t,o,i){"use strict";var s=function(){function e(){}return e.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=n.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function c(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function p(t,s,a,c){return new(a||(a=Promise))(function(e,n){function r(e){try{i(c.next(e))}catch(t){n(t)}}function o(e){try{i(c["throw"](e))}catch(t){n(t)}}function i(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(r,o)}i((c=c.apply(t,s||[])).next())})}function l(r,o){var i,s,a,e,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),"throw":t(1),"return":t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function n(e){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,s&&(a=2&e[0]?s["return"]:e[0]?s["throw"]||((a=s["return"])&&a.call(s),0):s.next)&&!(a=a.call(s,e[1])).done)return a;switch(s=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,s=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!(a=0<(a=c.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){c=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){c.label=e[1];break}if(6===e[0]&&c.label<a[1]){c.label=a[1],a=e;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(e);break}a[2]&&c.ops.pop(),c.trys.pop();continue}e=o.call(r,c)}catch(t){e=[6,t],s=0}finally{i=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([t,e])}}}var u=function(){function e(){}return e.prototype.rerender=function(){},e.prototype.ngOnChanges=function(t){if(this.object){var e=!1;["rotateX","rotateY","rotateZ"].some(function(e){return e in t})&&(this.applyRotation(),e=!0),["translateX","translateY","translateZ"].some(function(e){return e in t})&&(this.applyTranslation(),e=!0),e&&this.rerender()}},e.prototype.ngAfterViewInit=function(){var t=this;console.log("AbstractObject3D.ngAfterViewInit"),this.object=this.newObject3DInstance(),this.applyTranslation(),this.applyRotation(),this.childNodes!==undefined&&1<this.childNodes.length&&this.childNodes.filter(function(e){return e!==t&&e.getObject()!==undefined}).forEach(function(e){t.addChild(e.getObject())}),this.afterInit()},e.prototype.applyRotation=function(){[this.rotateX,this.rotateY,this.rotateZ].map(function(e){return e||0});this.object.rotation.set(this.rotateX||0,this.rotateY||0,this.rotateZ||0,"XYZ")},e.prototype.applyTranslation=function(){this.object.position.set(this.translateX||0,this.translateY||0,this.translateZ||0)},e.prototype.addChild=function(e){this.object.add(e)},e.prototype.removeChild=function(e){this.object.remove(e)},e.prototype.getObject=function(){return this.object},e.propDecorators={childNodes:[{type:n.ContentChildren,args:[e,{descendants:!1}]}],rotateX:[{type:n.Input}],rotateY:[{type:n.Input}],rotateZ:[{type:n.Input}],translateX:[{type:n.Input}],translateY:[{type:n.Input}],translateZ:[{type:n.Input}]},e}(),d=function(e){function t(){return console.log("SceneDirective.constructor"),e.call(this)||this}return c(t,e),t.prototype.afterInit=function(){console.log("SceneDirective.afterInit")},t.prototype.newObject3DInstance=function(){return console.log("SceneDirective.newObject3DInstance"),new r.Scene},t.decorators=[{type:n.Directive,args:[{selector:"three-scene",providers:[{provide:u,useExisting:n.forwardRef(function(){return t})}]}]}],t.ctorParameters=function(){return[]},t}(u),h=function(){function e(){console.log("AbstractCamera.constructor")}return e.prototype.ngAfterViewInit=function(){console.log("AbstractCamera.ngAfterViewInit"),this.afterInit()},e}(),f=function(){function e(){this.viewInitialized=!1,console.log("RendererComponent.constructor"),this.render=this.render.bind(this)}return e.prototype.ngAfterViewInit=function(){console.log("RendererComponent.ngAfterViewInit"),this.viewInitialized=!0,this.startRendering()},Object.defineProperty(e.prototype,"renderPane",{get:function(){return this.canvasRef},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvas",{get:function(){return this.canvasRef.nativeElement},enumerable:!0,configurable:!0}),e.prototype.startRendering=function(){console.log("RendererComponent.startRendering"),this.renderer=new r.WebGLRenderer({canvas:this.canvas,antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.canvas.clientWidth,this.canvas.clientHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=r.PCFSoftShadowMap,this.renderer.setClearColor(16777215,1),this.renderer.autoClear=!0,this.updateChildCamerasAspectRatio(),this.render()},e.prototype.render=function(){if(this.viewInitialized){var e=this.sceneComponents.first,t=this.cameraComponents.first;this.renderer.render(e.getObject(),t.camera)}},e.prototype.calculateAspectRatio=function(){return 0===this.canvas.clientHeight?0:this.canvas.clientWidth/this.canvas.clientHeight},e.prototype.onResize=function(e){this.canvas.style.width="100%",this.canvas.style.height="100%",console.log("RendererComponent.onResize: "+this.canvas.clientWidth+", "+this.canvas.clientHeight),this.updateChildCamerasAspectRatio(),this.renderer.setSize(this.canvas.clientWidth,this.canvas.clientHeight),this.render()},e.prototype.updateChildCamerasAspectRatio=function(){var t=this.calculateAspectRatio();this.cameraComponents.forEach(function(e){return e.updateAspectRatio(t)})},e.decorators=[{type:n.Component,args:[{selector:"three-webgl-renderer",template:"<canvas #canvas>\n</canvas>",styles:["canvas{width:100%;height:100%}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={canvasRef:[{type:n.ViewChild,args:["canvas"]}],sceneComponents:[{type:n.ContentChildren,args:[d]}],cameraComponents:[{type:n.ContentChildren,args:[h]}],onResize:[{type:n.HostListener,args:["window:resize",["$event"]]}]},e}(),v=function(){function e(){this.listeningControlElement=undefined,this.rotateSpeed=1,this.zoomSpeed=1.2,console.log("OrbitControlsDirective.constructor")}return e.prototype.ngOnChanges=function(e){this.controls&&(e.rotateSpeed&&(this.controls.rotateSpeed=this.rotateSpeed),e.zoomSpeed&&(this.controls.zoomSpeed=this.zoomSpeed),e.listeningControlElement&&(this.controls.dispose(),this.setUpOrbitControls()))},e.prototype.ngOnDestroy=function(){this.controls.dispose()},e.prototype.setUpOrbitControls=function(){this.controls=new t.OrbitControls(this.childCameras.first.camera,this.listeningControlElement&&this.listeningControlElement.nativeElement),this.controls.rotateSpeed=this.rotateSpeed,this.controls.zoomSpeed=this.zoomSpeed,this.controls.addEventListener("change",this.childRenderers.first.render),this.childRenderers.first.render()},e.prototype.ngAfterViewInit=function(){if(console.log("OrbitControlsDirective.ngAfterViewInit"),this.childCameras===undefined||this.childCameras.first===undefined)throw new Error("Camera is not found");if(this.childRenderers===undefined||this.childRenderers.first===undefined)throw new Error("Renderer is not found");this.setUpOrbitControls()},e.decorators=[{type:n.Directive,args:[{selector:"three-orbit-controls"}]}],e.ctorParameters=function(){return[]},e.propDecorators={childCameras:[{type:n.ContentChildren,args:[h,{descendants:!0}]}],childRenderers:[{type:n.ContentChildren,args:[f,{descendants:!0}]}],listeningControlElement:[{type:n.Input}],rotateSpeed:[{type:n.Input}],zoomSpeed:[{type:n.Input}]},e}(),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.parentInitialized=!1,e}return c(e,t),Object.defineProperty(e.prototype,"model",{get:function(){return this._model},set:function(e){var t=this;this._model=e,this.parentInitialized&&this.loadModelObject().then(function(e){t.currentLoadedModelObject&&t.removeChild(t.currentLoadedModelObject),t.currentLoadedModelObject=e,t.addChild(e),t.renderer&&t.renderer.render()})["catch"](function(e){console.error(e)})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderer",{get:function(){return this._renderer},set:function(e){this._renderer=e,this._renderer.render()},enumerable:!0,configurable:!0}),e.prototype.afterInit=function(){this.parentInitialized=!0,this.model=this.model},e.prototype.ngOnDestroy=function(){this.currentLoadedModelObject&&this.removeChild(this.currentLoadedModelObject)},e.prototype.rerender=function(){t.prototype.rerender.call(this),this.renderer&&this.renderer.render()},e.prototype.newObject3DInstance=function(){return new r.Object3D},e.propDecorators={model:[{type:n.Input}],renderer:[{type:n.Input}]},e}(u),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loader=new r.ColladaLoader,e}return c(e,t),e.prototype.loadModelObject=function(){return p(this,void 0,void 0,function(){var n=this;return l(this,function(e){return[2,new Promise(function(t,e){n.loader.load(n.model,function(e){t(e.scene)},undefined,e)})]})})},e.decorators=[{type:n.Directive,args:[{selector:"three-collada-loader",providers:[{provide:u,useExisting:n.forwardRef(function(){return e})}]}]}],e}(y),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loader=new r.OBJLoader,e.mtlLoader=new r.MTLLoader,e}return c(e,t),e.prototype.loadModelObject=function(){return p(this,void 0,void 0,function(){var r=this;return l(this,function(e){return this.material===undefined?[2,new Promise(function(t,e){r.loader.load(r.model,function(e){t(e)},undefined,e)})]:[2,new Promise(function(t,n){r.texturePath!==undefined&&r.mtlLoader.setTexturePath(r.texturePath),r.mtlLoader.load(r.material,function(e){e.preload(),r.loader.setMaterials(e),r.loader.load(r.model,function(e){t(e)},undefined,n)})})]})})},e.decorators=[{type:n.Directive,args:[{selector:"three-obj-loader",providers:[{provide:u,useExisting:n.forwardRef(function(){return e})}]}]}],e.propDecorators={material:[{type:n.Input}],texturePath:[{type:n.Input}]},e}(y),b=function(){function e(){}return e.prototype.transform=function(e){return e*(180/Math.PI)},e.decorators=[{type:n.Pipe,args:[{name:"rad2deg"}]}],e}(),w=function(){function e(){}return e.prototype.transform=function(e){return e/180*Math.PI},e.decorators=[{type:n.Pipe,args:[{name:"deg2rad"}]}],e}(),C=function(e){function t(){return console.log("PerspectiveCameraDirective.constructor"),e.call(this)||this}return c(t,e),t.prototype.afterInit=function(){console.log("PerspectiveCameraDirective.afterInit"),this.camera=new r.PerspectiveCamera(this.fov,undefined,this.near,this.far),this.camera.position.x=this.positionX,this.camera.position.y=this.positionY,this.camera.position.z=this.positionZ,this.camera.updateProjectionMatrix()},t.prototype.updateAspectRatio=function(e){console.log("PerspectiveCameraDirective.updateAspectRatio: "+e),this.camera.aspect=e,this.camera.updateProjectionMatrix()},t.decorators=[{type:n.Directive,args:[{selector:"three-perspective-camera",providers:[{provide:h,useExisting:n.forwardRef(function(){return t})}]}]}],t.ctorParameters=function(){return[]},t.propDecorators={fov:[{type:n.Input}],near:[{type:n.Input}],far:[{type:n.Input}],positionX:[{type:n.Input}],positionY:[{type:n.Input}],positionZ:[{type:n.Input}]},t}(h),I=function(t){function e(){var e=t.call(this)||this;return console.log("AxesHelperDirective.constructor"),e}return c(e,t),e.prototype.newObject3DInstance=function(){return console.log("AxesHelperDirective.newObject3DInstance"),new r.AxesHelper(this.size)},e.prototype.afterInit=function(){console.log("AxesHelperDirective.afterInit")},e.decorators=[{type:n.Directive,args:[{selector:"three-axes-helper",providers:[{provide:u,useExisting:n.forwardRef(function(){return e})}]}]}],e.ctorParameters=function(){return[]},e.propDecorators={size:[{type:n.Input}]},e}(u),D=function(t){function e(){var e=t.call(this)||this;return console.log("GridHelperDirective.constructor"),e}return c(e,t),e.prototype.newObject3DInstance=function(){return console.log("GridHelperDirective.newObject3DInstance"),new r.GridHelper(this.size,this.divisions)},e.prototype.afterInit=function(){console.log("GridHelperDirective.afterInit")},e.decorators=[{type:n.Directive,args:[{selector:"three-grid-helper",providers:[{provide:u,useExisting:n.forwardRef(function(){return e})}]}]}],e.ctorParameters=function(){return[]},e.propDecorators={size:[{type:n.Input}],divisions:[{type:n.Input}]},e}(u),R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loader=new r.ObjectLoader,e}return c(e,t),e.prototype.loadModelObject=function(){return p(this,void 0,void 0,function(){var n=this;return l(this,function(e){return[2,new Promise(function(t,e){n.loader.load(n.model,function(e){t(e)},undefined,e)})]})})},e.decorators=[{type:n.Directive,args:[{selector:"three-object-loader",providers:[{provide:u,useExisting:n.forwardRef(function(){return e})}]}]}],e}(y),P=function(t){function e(){var e=t.call(this)||this;return console.log("PointLightDirective.constructor"),e}return c(e,t),e.prototype.newObject3DInstance=function(){return console.log("PointLightDirective.newObject3DInstance"),new r.PointLight(this.color,this.intensity,this.distance)},e.prototype.afterInit=function(){console.log("PointLightDirective.afterInit")},e.decorators=[{type:n.Directive,args:[{selector:"three-point-light",providers:[{provide:u,useExisting:n.forwardRef(function(){return e})}]}]}],e.ctorParameters=function(){return[]},e.propDecorators={color:[{type:n.Input}],intensity:[{type:n.Input}],distance:[{type:n.Input}]},e}(u),j=function(){function e(e){this.elem=e,this.scene=null,this.camera=null,this.renderer=null,this.controls=null,this.mesh=null,this.light=null,this.count=1,this.scene=new o.Scene,this.camera=new o.PerspectiveCamera(45,1,1,1e3)}return e.prototype.onResize=function(e){this.resizeCanvasToDisplaySize(!0)},Object.defineProperty(e.prototype,"canvas",{get:function(){return this.canvasRef.nativeElement},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){this.configScene(),this.configCamera(),this.configRenderer(),this.configControls(),this.createLight(),this.createMesh(),this.animate()},e.prototype.configScene=function(){this.scene.background=new o.Color(14540253)},e.prototype.calculateAspectRatio=function(){return 0===this.canvas.clientHeight?0:this.canvas.clientWidth/this.canvas.clientHeight},e.prototype.updateCamera=function(){this.camera.aspect=this.calculateAspectRatio(),this.camera.updateProjectionMatrix()},e.prototype.configCamera=function(){this.updateCamera(),this.camera.position.set(-15,10,15),this.camera.lookAt(this.scene.position)},e.prototype.resizeCanvasToDisplaySize=function(e){var t=this.canvas.clientWidth,n=this.canvas.clientHeight;(e||this.canvas.width!==t||this.canvas.height!==n)&&(this.renderer.setSize(t,n,!1),this.camera.aspect=t/n,this.camera.updateProjectionMatrix())},e.prototype.configRenderer=function(){this.renderer=new o.WebGLRenderer({canvas:this.canvas,antialias:!0,alpha:!0}),this.renderer.setPixelRatio(1),this.renderer.setClearColor(0,0),this.resizeCanvasToDisplaySize(!0)},e.prototype.configControls=function(){this.controls=new t.OrbitControls(this.camera,this.canvas),this.controls.autoRotate=!1,this.controls.enableZoom=!0,this.controls.enablePan=!0,this.controls.update()},e.prototype.createLight=function(){this.light=new o.PointLight(16777215),this.light.position.set(-10,10,10),this.scene.add(this.light)},e.prototype.createMesh=function(){var e=new o.BoxGeometry(5,5,5),t=new o.MeshLambertMaterial({color:16711680});this.mesh=new o.Mesh(e,t),this.scene.add(this.mesh)},e.prototype.animate=function(){var e=this;window.requestAnimationFrame(function(){return e.animate()}),this.controls.update(),this.renderer.render(this.scene,this.camera),this.updateCamera()},e.decorators=[{type:n.Component,args:[{selector:"three-test",template:'\x3c!-- <canvas #canvas (window:resize)="onResize($event)"></canvas> --\x3e\n<canvas #canvas></canvas>\n',styles:["canvas{width:100%;height:100%}"]}]}],e.ctorParameters=function(){return[{type:n.ElementRef}]},e.propDecorators={canvasRef:[{type:n.ViewChild,args:["canvas"]}],onResize:[{type:n.HostListener,args:["window:resize",["$event"]]}]},e}(),O=function(){function e(){}return e.decorators=[{type:n.NgModule,args:[{imports:[i.CommonModule],declarations:[v,g,m,b,w,C,f,d,I,D,R,P,j],exports:[v,g,m,b,w,C,f,d,I,D,R,P,j],providers:[],entryComponents:[f]}]}],e}();e.ThreeLibService=s,e.WebGLRendererComponent=f,e.OrbitControlsDirective=v,e.ColladaLoaderDirective=g,e.ObjLoaderDirective=m,e.Rad2DegPipe=b,e.Deg2RadPipe=w,e.PerspectiveCameraDirective=C,e.SceneDirective=d,e.AxesHelperDirective=I,e.GridHelperDirective=D,e.ObjectLoaderDirective=R,e.PointLightDirective=P,e.ThreeLibModule=O,e.ɵb=h,e.ɵa=u,e.ɵc=y,e.ɵd=j,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=three-lib.umd.min.js.map