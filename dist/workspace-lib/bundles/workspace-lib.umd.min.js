!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs"),require("ngx-store"),require("genomics-lib"),require("bind-observable"),require("projects-lib"),require("@angular/common"),require("@angular/forms"),require("primeng/progressspinner"),require("primeng/button"),require("primeng/confirmdialog"),require("primeng/dropdown"),require("@3dgenomes/ngx-resizable"),require("angular-gridster2")):"function"==typeof define&&define.amd?define("workspace-lib",["exports","@angular/core","@angular/common/http","rxjs","ngx-store","genomics-lib","bind-observable","projects-lib","@angular/common","@angular/forms","primeng/progressspinner","primeng/button","primeng/confirmdialog","primeng/dropdown","@3dgenomes/ngx-resizable","angular-gridster2"],t):t(e["workspace-lib"]={},e.ng.core,e.ng.common.http,e.rxjs,e.WebStorageModule,e.GenomicsLibModule,e.BindObservable,e.ProjectsLibModule,e.ng.common,e.ng.forms,e.ProgressSpinnerModule,e.ButtonModule,e.ConfirmDialogModule,e.DropdownModule,e.NgxResizableModule,e["angular-gridster2"])}(this,function(e,t,r,o,n,i,s,a,c,p,d,l,g,u,w,f){"use strict";function m(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)s.push(o.value)}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i["return"])&&r.call(i)}finally{if(n)throw n.error}}return s}var y=function I(e,t){this.component=e,this.dataStream=t},h=function(){function e(e,t){this.httpClient=e,this.localStorageService=t,this.widgetsStreamUrl="assets/defaults/tk-default-workspace.json",this.widgetsStream=new o.BehaviorSubject([]),this.widgets=this.widgetsStream.asObservable()}return e.prototype.updateWidgets=function(e){this.widgetsStream.next(e)},e.prototype.loadWidgets=function(){var t=[];this.widgets.subscribe(function(e){return t=e}),Array.isArray(t)&&t.length||this.addWidgets("GenomicsThreejsComponent","GenomicsMatrixComponent","GenomicsInfoComponent","GenomicsTracksComponent")},e.prototype.addWidgets=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=function r(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}(this.widgetsStream.getValue());e.forEach(function(e){var t=i[e],r=new y(t,null);o.push(r)}),this.updateWidgets(o)},e.prototype.removeWidget=function(e){this.widgets.subscribe(function(e){return console.log(e)})},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:r.HttpClient},{type:n.LocalStorageService}]},e.ngInjectableDef=t.defineInjectable({factory:function(){return new e(t.inject(r.HttpClient),t.inject(n.LocalStorageService))},token:e,providedIn:"root"}),e}(),k=function j(e,t){this.component=e,this.dataStream=t},b=function(){function e(e){var t=this;this.workspaceService=e,this.classes="content cols",this.widgets=[],this.workspaceService.widgets.subscribe(function(e){return t.widgets=e})}return e.prototype.ngOnInit=function(){this.initializeWorkspace()},e.prototype.initializeWorkspace=function(){this.workspaceService.loadWidgets()},e.prototype.addWidget=function(e){this.workspaceService.addWidgets(e)},e.decorators=[{type:t.Component,args:[{selector:"workspace-layout",template:'<rsz-layout class="row" [directions]="[\'right\']" [rFlex]="true">\n\t<ng-container *ngFor="let widget of widgets; index as i;">\n\t<rsz-layout *ngIf="i===0" class="cell" [directions]="[\'bottom\']" [rFlex]="true">\n\t\t<workspace-widget [widget]="widget" [dataStream]="dataStream"></workspace-widget>\n\t</rsz-layout>\n\t<rsz-layout *ngIf="i===2" class="cell" [directions]="[\'none\']" [rFlex]="false">\n\t\t<workspace-widget [widget]="widget" [dataStream]="dataStream"></workspace-widget>\n\t</rsz-layout>\n\t</ng-container>\n</rsz-layout>\n<rsz-layout class="row" [directions]="[\'none\']" [rFlex]="false">\n\t<ng-container *ngFor="let widget of widgets; index as i;">\n\t\t<rsz-layout *ngIf="i===1" class="cell" [directions]="[\'bottom\']" [rFlex]="true">\n\t\t\t<workspace-widget [widget]="widget" [dataStream]="dataStream"></workspace-widget>\n\t\t</rsz-layout>\n\t\t<rsz-layout *ngIf="i===3" class="cell" [directions]="[\'none\']" [rFlex]="false">\n\t\t\t<workspace-widget [widget]="widget" [dataStream]="dataStream"></workspace-widget>\n\t\t</rsz-layout>\n\t</ng-container>\n</rsz-layout>\n',styles:[""]}]}],e.ctorParameters=function(){return[{type:h}]},e.propDecorators={classes:[{type:t.HostBinding,args:["class"]}],dataStream:[{type:t.Input}]},e}(),S=function(){function e(e,t){var r=this;this.componentFactoryResolver=e,this.projectsService=t,this.projectsService.currentProject.subscribe(function(e){return r.data=e})}return e.prototype.ngOnInit=function(){this.loadWorkpace()},e.prototype.setWorkspace=function(e){this.currentWorkspace=new k(b,null)},e.prototype.loadWorkpace=function(){this.setWorkspace();var e=this.componentFactoryResolver.resolveComponentFactory(this.currentWorkspace.component);this.routespace.clear(),this.routespace.createComponent(e).instance.dataStream=this.dataStream},e.decorators=[{type:t.Component,args:[{selector:"workspace-layout",template:"<ng-template #workspace></ng-template>  ",styles:[":host{display:-ms-grid;display:grid}"]}]}],e.ctorParameters=function(){return[{type:t.ComponentFactoryResolver},{type:a.ProjectsLibService}]},e.propDecorators={routespace:[{type:t.ViewChild,args:["workspace",{read:t.ViewContainerRef}]}]},function c(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;0<=a;a--)(n=e[a])&&(s=(i<3?n(s):3<i?n(t,r,s):n(t,r))||s);return 3<i&&s&&Object.defineProperty(t,r,s),s}([s.BindObservable("dataStream"),function r(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:type",a.Project)],e.prototype,"data",void 0),e}(),v=function(){function e(e){this.workspaceService=e,this.layout="fixed",this.layouts=[{label:"Fixed",value:"fixed"},{label:"Rows",value:"rows"},{label:"Columns",value:"cols"},{label:"Gridster",value:"gridster"}]}return e.prototype.ngOnInit=function(){},e.prototype.onChange=function(){console.log(this.layout)},e.decorators=[{type:t.Component,args:[{selector:"workspace-config",template:'<h2>Workspace Config</h2>\n<p-dropdown [options]="layouts" [(ngModel)]="layout" (onChange)="onChange()"></p-dropdown>\n<p>Selected Layout: {{layout || \'none\'}}</p>\n\n',styles:[""]}]}],e.ctorParameters=function(){return[{type:h}]},e}(),x=function(){function e(e){this.componentFactoryResolver=e}return e.prototype.ngOnInit=function(){this.loadWidget()},e.prototype.loadWidget=function(){var e=this.componentFactoryResolver.resolveComponentFactory(this.widget.component);this.workspace.clear(),this.workspace.createComponent(e).instance.dataStream=this.dataStream},e.decorators=[{type:t.Component,args:[{selector:"workspace-widget",template:"<ng-template #widget></ng-template>  ",styles:[":host{height:100%;width:100%}"]}]}],e.ctorParameters=function(){return[{type:t.ComponentFactoryResolver}]},e.propDecorators={widget:[{type:t.Input}],dataStream:[{type:t.Input}],workspace:[{type:t.ViewChild,args:["widget",{read:t.ViewContainerRef}]}]},e}(),W=function(){function e(e){var t=this;this.workspaceService=e,this.classes="workspace",this.widgets=[],this.workspaceService.widgets.subscribe(function(e){return t.widgets=e})}return e.prototype.ngOnInit=function(){this.initializeWorkspace()},e.prototype.initializeWorkspace=function(){this.workspaceService.loadWidgets()},e.prototype.addWidget=function(e){this.workspaceService.addWidgets(e)},e.decorators=[{type:t.Component,args:[{selector:"workspace-layout",template:'<workspace-widget *ngFor="let widget of widgets" [widget]="widget" [dataStream]="dataStream"></workspace-widget>\n',styles:[":host{display:-ms-grid;display:grid;-ms-grid-columns:360px 1fr;grid-template-columns:360px 1fr;-ms-grid-rows:360px 1fr;grid-template-rows:360px 1fr;grid-gap:10px;border:8px solid #f0f0f0}"]}]}],e.ctorParameters=function(){return[{type:h}]},e.propDecorators={classes:[{type:t.HostBinding,args:["class"]}],dataStream:[{type:t.Input}]},e}(),C=function(){function e(e){var t=this;this.workspaceService=e,this.classes="content",this.widgets=[],this.workspaceService.widgets.subscribe(function(e){return t.widgets=e})}return e.prototype.ngOnInit=function(){this.initializeWorkspace()},e.prototype.initializeWorkspace=function(){this.workspaceService.loadWidgets()},e.prototype.addWidget=function(e){this.workspaceService.addWidgets(e)},e.decorators=[{type:t.Component,args:[{selector:"workspace-layout",template:'<rsz-layout class="row" [directions]="[\'bottom\']" [rFlex]="true">\n\t<ng-container *ngFor="let widget of widgets; index as i; even as flex;">\n\t\t<rsz-layout *ngIf="i<2 && flex" class="cell" [directions]="[\'right\']" [rFlex]="flex">\n\t\t\t<workspace-widget [widget]="widget" [dataStream]="dataStream"></workspace-widget>\n\t\t</rsz-layout>\n\t\t<rsz-layout *ngIf="i<2 && !flex" class="cell" [directions]="[\'none\']" [rFlex]="flex">\n\t\t\t<workspace-widget [widget]="widget" [dataStream]="dataStream"></workspace-widget>\n\t\t</rsz-layout>\n\t</ng-container>\n</rsz-layout>\n<rsz-layout class="row" [directions]="[\'none\']" [rFlex]="false">\n\t<ng-container *ngFor="let widget of widgets; index as i; even as flex;">\n\t\t<rsz-layout *ngIf="i>1 && flex" class="cell" [directions]="[\'right\']" [rFlex]="flex">\n\t\t\t<workspace-widget [widget]="widget" [dataStream]="dataStream"></workspace-widget>\n\t\t</rsz-layout>\n\t\t<rsz-layout *ngIf="i>1 && !flex" class="cell" [directions]="[\'none\']" [rFlex]="flex">\n\t\t\t<workspace-widget [widget]="widget" [dataStream]="dataStream"></workspace-widget>\n\t\t</rsz-layout>\n\t</ng-container>\n</rsz-layout>\n',styles:[""]}]}],e.ctorParameters=function(){return[{type:h}]},e.propDecorators={classes:[{type:t.HostBinding,args:["class"]}],dataStream:[{type:t.Input}]},e}(),z=function(){function e(e){var t=this;this.workspaceService=e,this.classes="workspace",this.widgets=[],this.dashboard=[{area:"spatial",cols:3,rows:3,x:0,y:0},{area:"matrix",cols:9,rows:3,x:3,y:0},{area:"info",cols:3,rows:3,x:0,y:3},{area:"tracks",cols:9,rows:3,x:3,y:3}],this.options={pushItems:!0,minCols:6,maxCols:12,minRows:6,mobileBreakpoint:768,gridType:"fit",resizable:{enabled:!0},draggable:{enabled:!1},margin:8},this.workspaceService.widgets.subscribe(function(e){return t.widgets=e})}return e.prototype.onResize=function(e){this.options.api&&this.options.api.resize&&(console.log("resizing"),this.options.api.resize())},e.prototype.ngOnInit=function(){this.initializeWorkspace()},e.prototype.initializeWorkspace=function(){this.workspaceService.loadWidgets()},e.prototype.addWidget=function(e){this.workspaceService.addWidgets(e)},e.decorators=[{type:t.Component,args:[{selector:"workspace-layout",template:'<gridster [options]="options">\n    <gridster-item [item]="item" *ngFor="let item of dashboard; index as i">\n        <workspace-widget [widget]="widgets[i]" [dataStream]="dataStream"></workspace-widget>\n    </gridster-item>\n</gridster>\n',styles:["gridster{background:#f0f0f0}"]}]}],e.ctorParameters=function(){return[{type:h}]},e.propDecorators={classes:[{type:t.HostBinding,args:["class"]}],dataStream:[{type:t.Input}],onResize:[{type:t.HostListener,args:["window:resize",["$event"]]}]},e}(),F=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[c.CommonModule,p.FormsModule,d.ProgressSpinnerModule,l.ButtonModule,g.ConfirmDialogModule,u.DropdownModule,w.NgxResizableModule,f.GridsterModule,i.GenomicsLibModule,a.ProjectsLibModule],declarations:[v,x,S,W,C,b,z],exports:[],providers:[],entryComponents:[W,C,b,z]}]}],e}();e.WorkspaceService=h,e.WorkspaceComponent=S,e.WorkspaceConfigComponent=v,e.WidgetSpawnerComponent=x,e.WorkspaceFixedComponent=W,e.WorkspaceRowsComponent=C,e.WorkspaceColsComponent=b,e.WorkspaceGridsterComponent=z,e.WorkspaceLibModule=F,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=workspace-lib.umd.min.js.map